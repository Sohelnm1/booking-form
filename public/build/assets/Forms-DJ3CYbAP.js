import{r as g,j as e,H as z,a as x}from"./app-BT0PBD5v.js";import{A as V}from"./AdminLayout-Dc03Pn8T.js";import{F as i}from"./index-DKZ5kWbZ.js";import{C as D,T as H,B as o}from"./Logo-CBsbfG2i.js";import{F as U}from"./Table-B7Pdspem.js";import{R as F}from"./PlusOutlined-CMQuLy0S.js";import{M as $}from"./index-BmtCO0jd.js";import{I as n}from"./index-DSRvDQzQ.js";import{S as I}from"./index-DBEzLASz.js";import{S as y}from"./index-DyZ0RITu.js";import{R as f}from"./DeleteOutlined-BMTGLGi2.js";import{S as k}from"./index-BrRLvGPM.js";import{T as J}from"./index-BHGmy-0o.js";import{T as m}from"./index-Du1npkmC.js";import{R as P}from"./EditOutlined-BEGT5G2M.js";import{P as K}from"./index-CKd28lBC.js";import{s as C}from"./index-CCEwWO5O.js";/* empty css            */import"./index-CeLPprD2.js";import"./PurePanel-D4KtRPLf.js";import"./move-8rmViMFg.js";import"./useBreakpoint-_zB_dkAU.js";import"./CalendarOutlined-4pR6q61x.js";import"./ClockCircleOutlined-x1u_407Q.js";import"./FileTextOutlined-CTErf0sg.js";import"./useForm-BuUIJ0Zj.js";import"./row-BmBoW_gX.js";import"./CheckCircleFilled-t1GImBJH.js";import"./ExclamationCircleFilled-uB9MuAY_.js";import"./pickAttrs-CVI85bE7.js";import"./addEventListener-GUaYHLgK.js";import"./index-Bzdxy8Q6.js";import"./index-D06CY-Zo.js";import"./index-ByS1Z0ke.js";import"./index-6ufNqcJI.js";import"./Input-CvWDqBh-.js";import"./InfoCircleFilled-C2zuEgtx.js";import"./EyeOutlined-DLP9J_fo.js";const{Title:Q,Text:Y}=H,{TextArea:G}=n;function Le({auth:W,forms:j,services:v,fieldTypes:b}){const[w,p]=g.useState(!1),[s,c]=g.useState(null),[a]=i.useForm(),h=j.find(r=>r.name==="Default Booking Form")||j[0],q=()=>{c(null),a.resetFields(),a.setFieldsValue({form_id:h?.id,type:"text",is_required:!1,is_primary:!1,sort_order:0}),p(!0)},S=r=>{const l=r.target.value.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");a.setFieldsValue({name:l})},A=r=>{if(r.is_primary){C.error("Primary fields (Name, Phone, Email) cannot be edited as they are required for all bookings.");return}c(r);let t=[];r.options&&Array.isArray(r.options)&&(t=r.options.map((l,d)=>({key:d,label:l.label||l,value:l.value||l}))),a.setFieldsValue({form_id:r.form_id,label:r.label,name:r.name,type:r.type,placeholder:r.placeholder,help_text:r.help_text,is_required:r.is_required,is_primary:r.is_primary,sort_order:r.sort_order,options:t,validation_rules:r.validation_rules||[],services:r.services?.map(l=>l.id)||[]}),p(!0)},T=r=>{S(r)},E=()=>{a.validateFields().then(r=>{let t=[];r.options&&Array.isArray(r.options)&&(t=r.options.map(d=>({label:d.label,value:d.value})));const l={form_id:r.form_id,label:r.label,name:r.name,type:r.type,placeholder:r.placeholder||"",help_text:r.help_text||"",is_required:r.is_required||!1,is_primary:r.is_primary||!1,sort_order:r.sort_order||0,options:t,validation_rules:r.validation_rules||[],services:r.services||[]};s?x.put(route("admin.form-fields.update",s.id),l):x.post(route("admin.form-fields.store"),l),p(!1)})},O=()=>{p(!1),c(null),a.resetFields()},N=r=>{if(h?.fields?.find(l=>l.id===r)?.is_primary){C.error("Primary fields (Name, Phone, Email) cannot be deleted as they are required for all bookings.");return}x.post(route("admin.form-fields.delete",r))},L=[{title:"Label",dataIndex:"label",key:"label"},{title:"Type",dataIndex:"type",key:"type",render:r=>e.jsx(m,{color:"blue",children:b[r]||r})},{title:"Required",dataIndex:"is_required",key:"is_required",render:r=>e.jsx(m,{color:r?"red":"default",children:r?"Required":"Optional"})},{title:"Primary",dataIndex:"is_primary",key:"is_primary",render:r=>e.jsx(m,{color:r?"green":"default",children:r?"Primary":"Custom"})},{title:"Services",dataIndex:"services",key:"services",render:r=>!r||r.length===0?e.jsx(m,{color:"green",size:"small",children:"All services"}):e.jsxs("div",{children:[r.slice(0,2).map((t,l)=>e.jsx(m,{color:"purple",size:"small",children:t.name},l)),r.length>2&&e.jsxs(m,{size:"small",children:["+",r.length-2," more"]})]})},{title:"Actions",key:"actions",render:(r,t)=>t.is_primary?e.jsxs(y,{children:[e.jsx(o,{type:"text",icon:e.jsx(P,{}),disabled:!0,title:"Primary fields cannot be edited"}),e.jsx(o,{type:"text",danger:!0,icon:e.jsx(f,{}),disabled:!0,title:"Primary fields cannot be deleted"})]}):e.jsxs(y,{children:[e.jsx(o,{type:"text",icon:e.jsx(P,{}),onClick:()=>A(t),title:"Edit Field"}),e.jsx(K,{title:"Are you sure you want to delete this field?",onConfirm:()=>N(t.id),okText:"Yes",cancelText:"No",children:e.jsx(o,{type:"text",danger:!0,icon:e.jsx(f,{}),title:"Delete Field"})})]})}];return e.jsxs(V,{children:[e.jsx(z,{title:"Booking Form Fields"}),e.jsxs("div",{children:[e.jsxs(D,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Q,{level:3,style:{margin:0},children:"Booking Form Fields"}),e.jsx(o,{type:"primary",icon:e.jsx(F,{}),onClick:q,children:"Add Field"})]}),children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(Y,{type:"secondary",children:"Manage the fields for the booking form. Primary fields (Name, Phone, Email) are shown for all services. Custom fields can be assigned to specific services."})}),e.jsx(U,{columns:L,dataSource:h?.fields||[],rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0}})]}),e.jsx($,{title:s?"Edit Field":"Add Field",open:w,onOk:E,onCancel:O,width:600,okText:s?"Update":"Create",cancelText:"Cancel",children:e.jsxs(i,{form:a,layout:"vertical",children:[e.jsx(i.Item,{name:"form_id",hidden:!0,children:e.jsx(n,{})}),e.jsx(i.Item,{name:"label",label:"Field Label",rules:[{required:!0,message:"Please enter field label"}],children:e.jsx(n,{placeholder:"Enter field label",onChange:T})}),e.jsx(i.Item,{name:"name",label:s?"Field Name":"Field Name (Auto-generated)",rules:[{required:!0,message:"Please enter field name"}],children:e.jsx(n,{placeholder:s?"Field name":"Field name will be auto-generated",disabled:!s})}),e.jsx(i.Item,{name:"type",label:"Field Type",rules:[{required:!0,message:"Please select field type"}],children:e.jsx(I,{placeholder:"Select field type",options:Object.entries(b).map(([r,t])=>({label:t,value:r}))})}),e.jsx(i.Item,{name:"placeholder",label:"Placeholder",children:e.jsx(n,{placeholder:"Enter placeholder text"})}),e.jsx(i.Item,{name:"help_text",label:"Help Text",children:e.jsx(G,{rows:2,placeholder:"Enter help text"})}),e.jsx(i.Item,{noStyle:!0,shouldUpdate:(r,t)=>r.type!==t.type,children:({getFieldValue:r})=>{const t=r("type");return["select","radio","checkbox"].includes(t)?e.jsx(i.Item,{name:"options",label:"Field Options",rules:[{required:!0,message:"Please add at least one option"}],children:e.jsx(i.List,{name:"options",children:(d,{add:R,remove:M})=>e.jsxs(e.Fragment,{children:[d.map(({key:B,name:u,..._})=>e.jsxs(y,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(i.Item,{..._,name:[u,"label"],rules:[{required:!0,message:"Please enter option label"}],children:e.jsx(n,{placeholder:"Option label",style:{width:200}})}),e.jsx(i.Item,{..._,name:[u,"value"],rules:[{required:!0,message:"Please enter option value"}],children:e.jsx(n,{placeholder:"Option value",style:{width:150}})}),e.jsx(o,{type:"text",danger:!0,onClick:()=>M(u),icon:e.jsx(f,{})})]},B)),e.jsx(i.Item,{children:e.jsx(o,{type:"dashed",onClick:()=>R(),block:!0,icon:e.jsx(F,{}),children:"Add Option"})})]})})}):null}}),e.jsx(i.Item,{name:"is_required",label:"Required",valuePropName:"checked",children:e.jsx(k,{})}),e.jsx(i.Item,{name:"is_primary",label:"Primary Field (Phone, Name, Email)",valuePropName:"checked",children:e.jsx(k,{})}),e.jsx(i.Item,{name:"sort_order",label:"Sort Order",children:e.jsx(J,{min:0,placeholder:"Enter sort order",style:{width:"100%"}})}),e.jsx(i.Item,{noStyle:!0,shouldUpdate:(r,t)=>r.is_primary!==t.is_primary,children:({getFieldValue:r})=>r("is_primary")?null:e.jsx(i.Item,{name:"services",label:"Available for Services",children:e.jsx(I,{mode:"multiple",placeholder:"Select specific services (leave empty to show for ALL services)",allowClear:!0,style:{width:"100%"},children:v.map(l=>e.jsx(Option,{value:l.id,children:l.name},l.id))})})})]})})]})]})}export{Le as default};
