import{r as d,j as e,H as M,a as p}from"./app-COrRMy_8.js";import{A as O}from"./AdminLayout-DtG8XRHW.js";import{F as o}from"./index-oIe2zq1S.js";import{C as z,T as L,B as h,S as N}from"./Logo-Bs0OXiUK.js";import{R as P}from"./PlusOutlined-DRO3cU1t.js";import{F as q}from"./Table-Cs3WVQDA.js";import{M as F}from"./index-BM4WhBCw.js";import{R as y,C as m}from"./row-2EK2ePnC.js";import{I as _}from"./index-ClLaq-E5.js";import{T as b}from"./index-CKFo0MZF.js";import{S as H}from"./index-DHeq8Spa.js";import{T as I}from"./index-k7XLbcbO.js";import{R as B}from"./EyeOutlined-XdyoFoIQ.js";import{R as J}from"./EditOutlined-C5d_ygHo.js";import{R as K}from"./DeleteOutlined-CiY_GiBR.js";/* empty css            */import"./index-Bdr3srbw.js";import"./GiftOutlined-BCygQf0d.js";import"./index-CtgHcSP3.js";import"./move-DPP1eEbz.js";import"./CalendarOutlined-n1YreI-4.js";import"./CalendarOutlined-DKq2sctu.js";import"./FileTextOutlined-DJVNZews.js";import"./UserOutlined-DJCvsGOC.js";import"./ClockCircleOutlined-DQt5SU3t.js";import"./ClockCircleOutlined-CELcQ7Uv.js";import"./useForm-CNVIeXPg.js";import"./CheckCircleFilled-BJlrdiZ6.js";import"./InfoCircleFilled-BB6q9uKZ.js";import"./addEventListener-DDbiou6l.js";import"./index-BwJhBVks.js";import"./index-IZ_cn_ZK.js";import"./DownOutlined-DgDnE_l1.js";import"./Input-fdsm20KY.js";import"./index-DeFamdpe.js";import"./Pagination-CEcvn_Vg.js";import"./index-BKDzPPvy.js";import"./extendsObject-78o_rR5W.js";import"./useClosable-B9wp-Inn.js";import"./EyeOutlined-DK-GF0I0.js";import"./EyeOutlined-Bmd706kk.js";const{Title:Q,Text:U}=L;function Me({auth:k,durations:D,errors:l}){const[x,a]=d.useState(!1),[r,f]=d.useState(null),[S,n]=d.useState(!1),[v,j]=d.useState(null),[i]=o.useForm(),T=D||[];d.useEffect(()=>{l&&Object.keys(l).length>0?(console.log("Validation errors received:",l),Object.keys(l).forEach(t=>{i.setFields([{name:t,errors:[l[t]]}])}),a(!0)):i.setFields([])},[l,i]),d.useEffect(()=>{if(x)if(r){const t={name:r.name,hours:r.hours||0,minutes:r.minutes||0,label:r.label||r.Label,is_active:r.is_active,sort_order:r.sort_order||0};i.setFields([]),i.setFieldsValue(t),console.log("Form values set in useEffect:",t),setTimeout(()=>{const s=i.getFieldsValue();console.log("Form values after setting:",s)},100)}else i.setFieldsValue({hours:0,minutes:0,is_active:!0,sort_order:0})},[x,r,i]);const w=[{title:"Name",dataIndex:"name",key:"name",render:(t,s)=>e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:t}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:s.label})]})})},{title:"Duration",dataIndex:"minutes",key:"duration",render:(t,s)=>{const c=s.hours||0,g=s.minutes||0;let u="";return c>0&&g>0?u=`${c}h ${g}m`:c>0?u=`${c}h`:u=`${g}m`,e.jsx(I,{color:"blue",children:u})}},{title:"Status",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(I,{color:t?"green":"red",children:t?"Active":"Inactive"})},{title:"Sort Order",dataIndex:"sort_order",key:"sort_order",render:t=>t||0},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(N,{children:[e.jsx(h,{type:"text",icon:e.jsx(B,{}),size:"small",onClick:()=>V(s)}),e.jsx(h,{type:"text",icon:e.jsx(J,{}),size:"small",onClick:()=>E(s)}),e.jsx(h,{type:"text",icon:e.jsx(K,{}),size:"small",danger:!0,loading:v===s.id,disabled:v===s.id,onClick:()=>R(s)})]})}],C=()=>{f(null),i.resetFields(),i.setFields([]),i.setFieldsValue({hours:0,minutes:0,is_active:!0,sort_order:0}),a(!0)},E=t=>{f(t),i.setFields([]),i.resetFields();const s={name:t.name,hours:t.hours||0,minutes:t.minutes||0,label:t.label||t.Label,is_active:t.is_active,sort_order:t.sort_order||0};i.setFieldsValue(s),console.log("Form values set:",s),a(!0)},V=t=>{p.visit(route("admin.durations.show",t.id))},R=t=>{F.confirm({title:"Delete Duration",content:`Are you sure you want to delete "${t.name}"?`,okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>{j(t.id),p.post(route("admin.durations.delete",t.id),{},{onSuccess:()=>{j(null)},onError:()=>{j(null)}})}})},$=()=>{i.validateFields().then(t=>{n(!0),console.log("Form values after validation:",t),console.log("Editing duration:",r);const s={name:t.name,hours:t.hours,minutes:t.minutes,label:t.label,is_active:t.is_active?1:0,sort_order:t.sort_order||0};console.log("Submit data:",s),r?p.put(route("admin.durations.update",r.id),s,{onSuccess:()=>{a(!1),n(!1)},onError:()=>{n(!1)}}):p.post(route("admin.durations.store"),s,{onSuccess:()=>{a(!1),n(!1)},onError:()=>{n(!1)}})}).catch(t=>{console.error("Form validation failed:",t),n(!1)})},A=()=>{a(!1),f(null),i.resetFields(),i.setFields([])};return e.jsxs(O,{auth:k,children:[e.jsx(M,{title:"Durations - Admin Dashboard"}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(z,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{children:[e.jsx(Q,{level:2,style:{margin:0},children:"Durations"}),e.jsx(U,{type:"secondary",children:"Manage service durations for your booking system"})]}),e.jsx(h,{type:"primary",icon:e.jsx(P,{}),onClick:C,children:"Add Duration"})]}),e.jsx(q,{columns:w,dataSource:T,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} of ${t} durations`}})]}),e.jsx(F,{title:r?"Edit Duration":"Add Duration",open:x,onOk:$,onCancel:A,confirmLoading:S,width:600,okText:r?"Update":"Add",cancelText:"Cancel",children:e.jsxs(o,{form:i,layout:"vertical",style:{marginTop:"16px"},children:[e.jsxs(y,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"name",label:"Name*",rules:[{required:!0,message:"Please enter duration name"}],children:e.jsx(_,{placeholder:"e.g., 1 hour"})})}),e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"hours",label:"Hours*",rules:[{required:!0,message:"Please enter hours"},{type:"number",min:0,message:"Hours must be at least 0"}],children:e.jsx(b,{style:{width:"100%"},placeholder:"1",min:0})})})]}),e.jsxs(y,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"minutes",label:"Minutes*",rules:[{required:!0,message:"Please enter minutes"},{type:"number",min:0,max:59,message:"Minutes must be between 0 and 59"}],children:e.jsx(b,{style:{width:"100%"},placeholder:"30",min:0,max:59})})}),e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"sort_order",label:"Sort Order",children:e.jsx(b,{style:{width:"100%"},placeholder:"0",min:0})})})]}),e.jsx(o.Item,{name:"label",label:"Display Label*",rules:[{required:!0,message:"Please enter display label"}],children:e.jsx(_,{placeholder:"e.g., 1 hour"})}),e.jsx(y,{gutter:16,children:e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:e.jsx(H,{})})})})]})})]})]})}export{Me as default};
