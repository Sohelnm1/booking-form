import{r as p,j as e,H as V,a as j}from"./app-CjLSFTvF.js";import{A as O,R as N}from"./AdminLayout-CaACskhm.js";import{F as n}from"./index-BhQBVMnT.js";import{T as _,B as h,C as q,a as E}from"./Logo-DLy9Pi-u.js";import{F as G}from"./Table-7REDeCqW.js";import{M as S}from"./index-BFDovZzk.js";import{R as v,C as A}from"./row-CQ454HWN.js";import{I as F}from"./index-D0ij-sgg.js";import{T as Y}from"./index-D1-7wZL6.js";import{S as b}from"./index-Dc7Stc7a.js";import{S as z}from"./index-ErLwKW1B.js";import{U as $,R as H}from"./InboxOutlined-9AE-aW88.js";import{s as d}from"./index-BdNhniXG.js";import{I as J}from"./index-XsTFZI-z.js";import{R as K}from"./ClockCircleOutlined-B5klXXHM.js";import{T as y}from"./index-YgNiGMGF.js";import{S as W}from"./index-Cz--6uym.js";import{R as X}from"./EyeOutlined-C1FdwiFg.js";import{R as Z}from"./EditOutlined-B1M0cp84.js";import{P as ee}from"./index-v6NME6t4.js";import{R as te}from"./DeleteOutlined-CW1zqXNb.js";/* empty css            */import"./index-CgCFGhN9.js";import"./index-DczFaLwX.js";import"./PurePanel-Ctdvl-zP.js";import"./move-BHpooOi0.js";import"./LogoutOutlined-Di16fjZE.js";import"./CalendarOutlined-C51-_ebW.js";import"./DollarOutlined-CnvFJIap.js";import"./UserOutlined-BTlIJHQK.js";import"./FileTextOutlined-CosqdZ2W.js";import"./GiftOutlined-CqMUofQ6.js";import"./SettingOutlined-CjjuPnIM.js";import"./useForm-DYbDyyqO.js";import"./CheckCircleFilled-Dt1Auu-O.js";import"./InfoCircleFilled-D_PNQDwx.js";import"./pickAttrs-D4RZEvRE.js";import"./addEventListener-Dkb8_L8w.js";import"./index-KNdCQ6Gc.js";import"./index-CdVV1a5r.js";import"./index-BV1LEswr.js";import"./index-_UDQvjMi.js";import"./Input-DRyzWO36.js";import"./useClosable-C1CguS7l.js";import"./EyeOutlined-FpwRxIr8.js";import"./EyeOutlined-Bmd706kk.js";import"./DownloadOutlined-DTidZHln.js";import"./progress-_SmLRBSL.js";const{Title:ie,Text:c}=_,{TextArea:ae}=F,{Option:D}=b;function Ze({auth:T,extras:I,services:C,durations:R,errors:re}){const[f,m]=p.useState(!1);console.log("Admin Extras component - Extras data:",I);const[r,u]=p.useState(null),[s,x]=p.useState(!1),[M,g]=p.useState(!1),[l]=n.useForm();p.useEffect(()=>{if(f)if(r){const t={name:r.name||"",description:r.description||"",price:parseFloat(r.price)||0,duration_id:r.duration_id||null,is_active:r.is_active!==void 0?r.is_active:!0,services:r.services?.map(i=>i.id)||[]};setTimeout(()=>{l.setFieldsValue(t)},100)}else setTimeout(()=>{l.setFieldsValue({is_active:!0,duration_id:null,description:"",services:[]})},100)},[f,r,l]);const B=()=>{u(null),x(!1),m(!0)},k=t=>{u(t),x(!1),m(!0)},Q=t=>{u(t),x(!0),m(!0)},L=t=>{S.confirm({title:"Delete Extra",content:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk(){d.loading({content:"Deleting extra...",key:"deleteExtra"}),j.post(route("admin.extras.delete",t.id),{onSuccess:()=>{d.success({content:"Extra deleted successfully",key:"deleteExtra",duration:3})},onError:()=>{d.error({content:"Failed to delete extra",key:"deleteExtra",duration:5})}})}})},P=()=>{l.validateFields().then(t=>{g(!0);const i=new FormData;Object.keys(t).forEach(a=>{if(a==="image"&&t[a]?.fileList?.[0]?.originFileObj)i.append("image",t[a].fileList[0].originFileObj);else if(a==="price"){const o=parseFloat(t[a])||0;i.append(a,o)}else if(a==="duration_id"){const o=t[a]||null;i.append(a,o)}else a==="is_active"?i.append(a,t[a]?"1":"0"):a==="services"?t[a]&&t[a].length>0&&t[a].forEach(o=>{i.append("services[]",o)}):i.append(a,t[a]||"")}),r?(i.append("_method","PUT"),j.post(route("admin.extras.update",r.id),i,{onSuccess:()=>{d.success("Extra updated successfully"),m(!1),l.resetFields()},onError:a=>{a&&Object.keys(a).forEach(o=>{l.setFields([{name:o,errors:[a[o]]}])}),d.error("Failed to update extra")},onFinish:()=>{g(!1)}})):j.post(route("admin.extras.store"),i,{onSuccess:()=>{d.success("Extra created successfully"),m(!1),l.resetFields()},onError:a=>{a&&Object.keys(a).forEach(o=>{l.setFields([{name:o,errors:[a[o]]}])}),d.error("Failed to create extra")},onFinish:()=>{g(!1)}})}).catch(t=>{console.error("Form validation failed:",t),d.error("Please check the form and try again")})},w=()=>{m(!1),x(!1),l.resetFields()},U=[{title:"Image",dataIndex:"image",key:"image",render:(t,i)=>e.jsx(J,{width:40,height:40,src:t||`https://placehold.co/40x40/1890ff/ffffff?text=${i.name?.charAt(0)?.toUpperCase()||"E"}`,alt:i.name,style:{borderRadius:4},fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3Ik1RnG4W+FgYxN"})},{title:"Name",dataIndex:"name",key:"name",render:t=>e.jsx(c,{strong:!0,children:t})},{title:"Description",dataIndex:"description",key:"description",render:t=>e.jsx(c,{type:"secondary",style:{fontSize:"12px"},children:t||"No description"})},{title:"Price",dataIndex:"price",key:"price",render:t=>e.jsxs(c,{strong:!0,style:{color:"#52c41a"},children:["₹",t]})},{title:"Duration",dataIndex:"duration",key:"duration",render:(t,i)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(K,{style:{color:"#1890ff"}}),e.jsx(c,{children:i.durationRelation?i.durationRelation.label:"No additional time"})]})},{title:"Available For",dataIndex:"services",key:"services",render:t=>e.jsxs("div",{children:[t&&t.length>0?t.slice(0,2).map(i=>e.jsx(y,{color:"blue",style:{marginBottom:4},children:i.name},i.id)):e.jsx(y,{color:"orange",children:"All Services"}),t&&t.length>2&&e.jsxs(c,{type:"secondary",style:{fontSize:"11px"},children:["+",t.length-2," more"]})]})},{title:"Status",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(y,{color:t?"green":"red",children:t?"Active":"Inactive"})},{title:"Actions",key:"actions",render:(t,i)=>e.jsxs(W,{children:[e.jsx(E,{title:"View Extra",children:e.jsx(h,{icon:e.jsx(X,{}),size:"small",onClick:()=>Q(i)})}),e.jsx(E,{title:"Edit Extra",children:e.jsx(h,{type:"primary",icon:e.jsx(Z,{}),size:"small",onClick:()=>k(i)})}),e.jsx(E,{title:"Delete Extra",children:e.jsx(ee,{title:"Delete this extra?",description:"This action cannot be undone.",onConfirm:()=>L(i),okText:"Yes",cancelText:"No",children:e.jsx(h,{danger:!0,icon:e.jsx(te,{}),size:"small"})})})]})}];return e.jsxs(O,{auth:T,children:[e.jsx(V,{title:"Extras Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx(ie,{level:2,style:{marginBottom:4},children:"Extras Management"}),e.jsx(c,{type:"secondary",children:"Manage additional services and add-ons"})]}),e.jsx(h,{type:"primary",icon:e.jsx(N,{}),onClick:B,children:"Add Extra"})]}),e.jsx(q,{children:e.jsx(G,{columns:U,dataSource:I,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,i)=>`${i[0]}-${i[1]} of ${t} extras`}})}),e.jsx(S,{title:s?`View Extra: ${r?.name}`:r?"Edit Extra":"Add Extra",open:f,onOk:s?w:P,onCancel:w,confirmLoading:M,width:600,okText:s?"Close":"Save",cancelText:"Cancel",children:e.jsxs(n,{form:l,layout:"vertical",children:[e.jsxs(v,{gutter:16,children:[e.jsx(A,{span:12,children:e.jsx(n.Item,{name:"name",label:"Extra name*",rules:s?[]:[{required:!0,message:"Please enter extra name",whitespace:!0}],children:e.jsx(F,{placeholder:"Enter name",disabled:s})})}),e.jsx(A,{span:12,children:e.jsx(n.Item,{name:"price",label:"Price*",rules:s?[]:[{required:!0,message:"Please enter price"},{type:"number",min:0,message:"Price must be a positive number"}],children:e.jsx(Y,{style:{width:"100%"},placeholder:"0.00",min:0,step:.01,disabled:s,formatter:t=>`₹ ${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/₹\s?|(,*)/g,"")})})})]}),e.jsx(n.Item,{name:"description",label:"Description",children:e.jsx(ae,{rows:3,placeholder:"Describe this extra service...",disabled:s})}),e.jsxs(v,{gutter:16,children:[e.jsx(A,{span:12,children:e.jsx(n.Item,{name:"duration_id",label:"Additional Duration",children:e.jsx(b,{placeholder:"Select duration (optional)",allowClear:!0,style:{width:"100%"},disabled:s,children:R?.map(t=>e.jsx(D,{value:t.id,children:t.label},t.id))})})}),e.jsx(A,{span:12,children:e.jsx(n.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:e.jsx(z,{disabled:s})})})]}),e.jsx(n.Item,{name:"services",label:"Available for Services",children:e.jsx(b,{mode:"multiple",placeholder:"Select services (leave empty for all services)",allowClear:!0,style:{width:"100%"},disabled:s,children:C.map(t=>e.jsx(D,{value:t.id,children:t.name},t.id))})}),e.jsx(c,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:"Select specific services where this extra will be available. Leave empty to make it available for all services."}),e.jsx(n.Item,{name:"image",label:"Extra image",children:e.jsxs($.Dragger,{name:"file",multiple:!1,beforeUpload:()=>!1,showUploadList:!0,accept:"image/*",maxCount:1,fileList:[],disabled:s,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(H,{})}),e.jsx("p",{className:"ant-upload-text",children:s?"Image preview":"Drag and drop or choose from files"})]})})]})})]})]})}export{Ze as default};
