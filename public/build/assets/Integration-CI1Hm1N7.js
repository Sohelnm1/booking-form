import{r as p,j as e,H as F}from"./app-CADLw3G9.js";import{A as z,c as h}from"./AdminLayout-Bkcva9sz.js";import{F as t}from"./index-er7eshNq.js";import{T as E,C as O,B as y}from"./Logo-CLAK33tc.js";import{A as q}from"./index-CfCHoYee.js";import{R as M,C as N}from"./row-Dom2nqZh.js";import{S as g}from"./index-nwNNYHB9.js";import{T as B}from"./index-CKLq3zDx.js";import{R as $}from"./EditOutlined-aUhqXkCX.js";import{S as f}from"./index-gi2fN0ny.js";import{M as K}from"./index-C6Y6ZG1D.js";import{I as n}from"./index-SwRbmmP5.js";import{S as c}from"./index-8xFw_M6G.js";import{R as L}from"./SaveOutlined-CL1cpH_Z.js";import{R as D}from"./CloseCircleOutlined-Om6IOY1l.js";import{R as G}from"./CheckCircleOutlined-BmTk6eY4.js";import{s as a}from"./index-2mpHb7UY.js";/* empty css            */import"./index-C06X103F.js";import"./index-La3HCdEx.js";import"./PurePanel-DvLIh7gb.js";import"./move-JM2Y3ogW.js";import"./LogoutOutlined-D2_QBXct.js";import"./CalendarOutlined-Cm65HkJR.js";import"./DollarOutlined-dEwdo4p7.js";import"./UserOutlined-JTobUxAg.js";import"./PlusOutlined-CiRxDKim.js";import"./ClockCircleOutlined-BiPqo-PL.js";import"./SettingOutlined-BGwVwhiu.js";import"./FileTextOutlined-BXH5MtbD.js";import"./GiftOutlined-DD_DTpKe.js";import"./useForm-2v7yEcOp.js";import"./CheckCircleFilled-CHwNSVBx.js";import"./InfoCircleFilled-DJey1gcQ.js";import"./pickAttrs-9MlZ-O9_.js";import"./useClosable-CSbyRlS0.js";import"./extendsObject-78o_rR5W.js";import"./Input-DEZKARtK.js";import"./EyeOutlined-DLLudd9l.js";import"./EyeOutlined-Bmd706kk.js";import"./index-DDNcFxHa.js";import"./DownOutlined-iF-x33Tt.js";const{Title:U,Text:o,Paragraph:V}=E,{TextArea:Oe}=n;function qe({auth:_,integrations:I=[]}){const[w,u]=p.useState(!1),[d,S]=p.useState(null),[x,m]=p.useState(!1),[l]=t.useForm(),k=r=>{switch(r){case"active":return"green";case"inactive":return"red";case"pending":return"orange";default:return"default"}},P=r=>{switch(r){case"active":return e.jsx(G,{style:{color:"#52c41a"}});case"inactive":return e.jsx(D,{style:{color:"#ff4d4f"}});case"pending":return e.jsx(h,{style:{color:"#faad14"}});default:return e.jsx(h,{})}},b=r=>{S(r);const s={integration_id:r.id,name:r.name,description:r.description,is_enabled:r.is_enabled};r.settings&&Object.keys(r.settings).forEach(i=>{s[i]=r.settings[i]}),l.setFieldsValue(s),u(!0)},v=async()=>{try{m(!0);const r=await l.validateFields(),s={},i=r.integration_id;switch(i){case"razorpay":s.razorpay_key=r.razorpay_key||"",s.razorpay_secret=r.razorpay_secret||"",s.currency=r.currency||"INR";break;case"sms":s.twilio_sid=r.twilio_sid||"",s.twilio_token=r.twilio_token||"",s.twilio_phone=r.twilio_phone||"";break;case"email":s.sendgrid_key=r.sendgrid_key||"",s.sendgrid_from_email=r.sendgrid_from_email||"",s.sendgrid_from_name=r.sendgrid_from_name||"";break}const j=await fetch(route("admin.integration.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({integration_id:i,settings:s})}),R=await j.json();j.ok?(a.success("Integration settings updated successfully"),u(!1),l.resetFields(),window.location.reload()):a.error(R.error||"Failed to update integration settings")}catch(r){console.error("Error updating integration:",r),a.error("Failed to update integration settings")}finally{m(!1)}},T=()=>{u(!1),l.resetFields()},C=r=>{a.success(`${r.name} ${r.is_enabled?"disabled":"enabled"} successfully`)},A=async r=>{try{m(!0);const s=await fetch(route("admin.integration.test"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({integration_id:r.id})}),i=await s.json();s.ok?a.success(i.success||"Connection test successful"):a.error(i.error||"Connection test failed")}catch(s){console.error("Error testing connection:",s),a.error("Failed to test connection")}finally{m(!1)}};return e.jsxs(z,{auth:_,children:[e.jsx(F,{title:"Integration Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(U,{level:2,style:{marginBottom:8},children:"Integration Management"}),e.jsx(o,{type:"secondary",children:"Manage third-party integrations and API connections"})]}),e.jsx(q,{message:"Integration Status",description:"All integrations are working properly. Last health check: 2 minutes ago",type:"success",showIcon:!0,style:{marginBottom:24}}),e.jsx(M,{gutter:[24,24],children:I.map(r=>e.jsx(N,{xs:24,md:12,lg:8,children:e.jsxs(O,{title:e.jsxs(g,{children:[P(r.status),r.name]}),extra:e.jsx(f,{checked:r.is_enabled,onChange:()=>C(r),size:"small"}),actions:[e.jsx(y,{type:"text",icon:e.jsx($,{}),onClick:()=>b(r),children:"Configure"}),e.jsx(y,{type:"text",icon:e.jsx(h,{}),onClick:()=>A(r),loading:x,children:"Test"})],children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(V,{type:"secondary",children:r.description})}),e.jsxs(g,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Status: "}),e.jsx(B,{color:k(r.status),children:r.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"API Key: "}),e.jsx(o,{code:!0,children:r.api_key})]}),r.id==="razorpay"&&r.settings?.currency&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Currency: "}),e.jsx(o,{code:!0,children:r.settings.currency})]}),r.id==="sms"&&r.settings?.twilio_phone&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Phone: "}),e.jsx(o,{code:!0,children:r.settings.twilio_phone})]}),r.id==="email"&&r.settings?.sendgrid_from_email&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"From Email: "}),e.jsx(o,{code:!0,style:{fontSize:"12px"},children:r.settings.sendgrid_from_email})]}),r.last_sync&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Last Sync: "}),e.jsx(o,{type:"secondary",children:r.last_sync})]})]})]})},r.id))}),e.jsx(K,{title:`Configure ${d?.name}`,open:w,onOk:v,onCancel:T,width:600,okText:"Save Changes",okIcon:e.jsx(L,{}),confirmLoading:x,children:e.jsxs(t,{form:l,layout:"vertical",children:[e.jsx(t.Item,{name:"integration_id",hidden:!0,children:e.jsx(n,{})}),d?.id==="razorpay"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"razorpay_key",label:"Razorpay API Key",rules:[{required:!0,message:"Please enter Razorpay API key"}],children:e.jsx(n.Password,{placeholder:"rzp_test_..."})}),e.jsx(t.Item,{name:"razorpay_secret",label:"Razorpay API Secret",rules:[{required:!0,message:"Please enter Razorpay API secret"}],children:e.jsx(n.Password,{placeholder:"Enter API secret"})}),e.jsx(t.Item,{name:"currency",label:"Currency",rules:[{required:!0,message:"Please select currency"}],children:e.jsxs(c,{placeholder:"Select currency",children:[e.jsx(c.Option,{value:"INR",children:"Indian Rupee (₹)"}),e.jsx(c.Option,{value:"USD",children:"US Dollar ($)"}),e.jsx(c.Option,{value:"EUR",children:"Euro (€)"}),e.jsx(c.Option,{value:"GBP",children:"British Pound (£)"})]})})]}),d?.id==="sms"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"twilio_sid",label:"Twilio Account SID",rules:[{required:!0,message:"Please enter Twilio Account SID"}],children:e.jsx(n,{placeholder:"AC..."})}),e.jsx(t.Item,{name:"twilio_token",label:"Twilio Auth Token",rules:[{required:!0,message:"Please enter Twilio Auth Token"}],children:e.jsx(n.Password,{placeholder:"Enter auth token"})}),e.jsx(t.Item,{name:"twilio_phone",label:"Twilio Phone Number",rules:[{required:!0,message:"Please enter Twilio phone number"}],children:e.jsx(n,{placeholder:"+1234567890"})})]}),d?.id==="email"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"sendgrid_key",label:"SendGrid API Key",rules:[{required:!0,message:"Please enter SendGrid API key"}],children:e.jsx(n.Password,{placeholder:"SG..."})}),e.jsx(t.Item,{name:"sendgrid_from_email",label:"From Email",rules:[{required:!0,message:"Please enter from email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(n,{placeholder:"noreply@yourdomain.com"})}),e.jsx(t.Item,{name:"sendgrid_from_name",label:"From Name",rules:[{required:!0,message:"Please enter from name"}],children:e.jsx(n,{placeholder:"Your Business Name"})})]}),e.jsx(t.Item,{name:"is_enabled",label:"Enable Integration",valuePropName:"checked",children:e.jsx(f,{})})]})})]})]})}export{qe as default};
