import{r as u,j as e,H as Q}from"./app-CqYo-92z.js";import{A as G}from"./AdminLayout-P5w8j_D8.js";import{d as b}from"./dayjs.min-eFFeorG4.js";import{R as $,C as c}from"./row-Dfw-mlxx.js";import{C as p,T as W,S as v,B as o}from"./Logo-pMTbWeYE.js";import{S as g}from"./index-wvSqGDI1.js";import{R as Z}from"./FileTextOutlined-BbzbzJpZ.js";import{R as z}from"./CheckCircleOutlined-D6Z0_JYP.js";import{R as ee}from"./ClockCircleOutlined-RgM7uVa5.js";import{R as te}from"./DollarOutlined-BaCaRyFl.js";import{I as se}from"./index-C9Txx89L.js";import{R as ae}from"./SearchOutlined-C_UFcspN.js";import{S as B}from"./index-CG51l83V.js";import{D as ne}from"./index-C3d5uHHc.js";import{F as ie}from"./Table-9UY9zLr4.js";import{M as re}from"./index-DTLtFOjG.js";import{D as n}from"./index-gEzbhKSO.js";import{B as S}from"./index-DB3OmUkH.js";import{D as I}from"./index-CsLE78b-.js";import{R as oe}from"./ExclamationCircleOutlined-Ce54OVZP.js";import{R as le}from"./MailOutlined-s23cIV-9.js";import{a as M,R as ce}from"./PrinterOutlined-DdJnW7Pk.js";import{s as l}from"./index-BcGTn8CZ.js";import{R as de}from"./EyeOutlined-KoDwJvJ3.js";import{R as me}from"./SendOutlined-gx4lEDVg.js";/* empty css            */import"./UserOutlined-CKL0tGZH.js";import"./FireOutlined-B1JFdZXh.js";import"./index-C-hzZnml.js";import"./move-C8LSlEq6.js";import"./PlusOutlined-p3TthVOg.js";import"./Input-bwUpPmQG.js";import"./EyeOutlined-6jIcXCQA.js";import"./EyeOutlined-Bmd706kk.js";import"./index-f3k4wLKy.js";import"./DownOutlined-CIlxRIT-.js";import"./addEventListener-C1IMU38P.js";import"./index-CeOGyxOa.js";import"./Pagination-CaRhxtC5.js";import"./useForm-BDyu4SJx.js";import"./index-DMTREKJq.js";import"./extendsObject-78o_rR5W.js";import"./CheckCircleFilled-DkQIjyv5.js";import"./InfoCircleFilled-Bq1WM-3L.js";import"./useClosable-BZS11_vL.js";import"./DownloadOutlined-DTidZHln.js";const{Title:ue,Text:r}=W,{Option:x}=B,{Search:pe}=se,{RangePicker:xe}=ne;function ot({auth:E,invoices:k,stats:h}){const[a,_]=u.useState(null),[L,D]=u.useState(!1),[d,Y]=u.useState(""),[w,N]=u.useState("all"),[j,O]=u.useState(null),[f,m]=u.useState(!1),K=t=>{_(t),D(!0)},R=()=>{D(!1),_(null)},T=t=>{window.open(`/admin/invoices/${t}/download`,"_blank")},F=async t=>{try{m(!0);const i=await(await fetch(`/admin/invoices/${t}/send-email`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();i.success?l.success(i.message):l.error(i.message||"Failed to send email")}catch{l.error("Failed to send email")}finally{m(!1)}},U=async t=>{try{m(!0);const i=await(await fetch(`/admin/invoices/${t}/mark-paid`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();i.success?(l.success(i.message),window.location.reload()):l.error(i.message||"Failed to mark as paid")}catch{l.error("Failed to mark as paid")}finally{m(!1)}},V=async t=>{try{m(!0);const i=await(await fetch(`/admin/invoices/${t}/mark-cancelled`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();i.success?(l.success(i.message),window.location.reload()):l.error(i.message||"Failed to mark as cancelled")}catch{l.error("Failed to mark as cancelled")}finally{m(!1)}},P=t=>{switch(t){case"paid":return"success";case"pending":return"warning";case"cancelled":return"error";case"draft":return"default";default:return"default"}},A=t=>{switch(t){case"paid":return"success";case"pending":return"warning";case"failed":return"error";case"refunded":return"default";default:return"default"}},y=t=>b(t).format("MMM DD, YYYY h:mm A"),q=t=>b(t).format("MMM DD, YYYY"),C=t=>`₹${parseFloat(t).toFixed(2)}`,X=k.data.filter(t=>{const s=d===""||t.invoice_number.toLowerCase().includes(d.toLowerCase())||t.customer?.name.toLowerCase().includes(d.toLowerCase())||t.customer?.email.toLowerCase().includes(d.toLowerCase())||t.booking?.service?.name.toLowerCase().includes(d.toLowerCase()),i=w==="all"||t.status===w,J=!j||b(t.issued_date).isBetween(j[0],j[1],"day","[]");return s&&i&&J}),H=[{title:"Invoice #",key:"invoice_number",render:(t,s)=>e.jsxs("div",{children:[e.jsx(r,{strong:!0,children:s.invoice_number}),e.jsx("br",{}),e.jsx(r,{type:"secondary",style:{fontSize:"12px"},children:q(s.issued_date)})]})},{title:"Customer",key:"customer",render:(t,s)=>e.jsxs("div",{children:[e.jsx(r,{strong:!0,children:s.customer?.name}),e.jsx("br",{}),e.jsx(r,{type:"secondary",style:{fontSize:"12px"},children:s.customer?.email})]})},{title:"Service",key:"service",render:(t,s)=>e.jsxs("div",{children:[e.jsx(r,{children:s.booking?.service?.name}),e.jsx("br",{}),e.jsxs(r,{type:"secondary",style:{fontSize:"12px"},children:["Booking #",s.booking?.id]})]})},{title:"Amount",key:"total_amount",render:(t,s)=>e.jsxs("div",{children:[e.jsx(r,{strong:!0,style:{fontSize:"16px",color:"#1890ff"},children:C(s.total_amount)}),s.discount_amount>0&&e.jsx("div",{children:e.jsxs(r,{type:"secondary",style:{fontSize:"12px"},children:["Discount: ",C(s.discount_amount)]})})]})},{title:"Status",key:"status",render:(t,s)=>e.jsxs(v,{direction:"vertical",size:"small",children:[e.jsx(S,{status:P(s.status),text:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsx(S,{status:A(s.payment_status),text:s.payment_status.charAt(0).toUpperCase()+s.payment_status.slice(1)})]})},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(v,{direction:"vertical",size:"small",children:[e.jsx(o,{type:"primary",icon:e.jsx(de,{}),size:"small",onClick:()=>K(s),style:{width:"100%"},children:"View"}),e.jsx(o,{type:"default",icon:e.jsx(M,{}),size:"small",onClick:()=>T(s.id),style:{width:"100%"},children:"Download"}),s.status==="pending"&&e.jsx(o,{type:"default",icon:e.jsx(me,{}),size:"small",onClick:()=>F(s.id),loading:f,style:{width:"100%"},children:"Send Email"})]})}];return e.jsxs(G,{auth:E,children:[e.jsx(Q,{title:"Invoices"}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs($,{gutter:[16,16],style:{marginBottom:24},children:[e.jsx(c,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(g,{title:"Total Invoices",value:h.total_invoices,prefix:e.jsx(Z,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(c,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(g,{title:"Paid Invoices",value:h.paid_invoices,prefix:e.jsx(z,{}),valueStyle:{color:"#52c41a"}})})}),e.jsx(c,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(g,{title:"Pending Invoices",value:h.pending_invoices,prefix:e.jsx(ee,{}),valueStyle:{color:"#faad14"}})})}),e.jsx(c,{xs:24,sm:12,md:6,children:e.jsx(p,{children:e.jsx(g,{title:"Total Revenue",value:h.total_revenue,prefix:e.jsx(te,{}),valueStyle:{color:"#52c41a"},formatter:t=>`₹${parseFloat(t).toFixed(2)}`})})})]}),e.jsxs(p,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsx(ue,{level:2,style:{margin:0},children:"Invoices"}),e.jsx(v,{children:e.jsxs(r,{type:"secondary",children:["Total: ",k.total," invoices"]})})]}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs($,{gutter:16,children:[e.jsx(c,{span:8,children:e.jsx(pe,{placeholder:"Search by invoice #, customer, or service",allowClear:!0,value:d,onChange:t=>Y(t.target.value),prefix:e.jsx(ae,{})})}),e.jsx(c,{span:4,children:e.jsxs(B,{placeholder:"Status",value:w,onChange:N,style:{width:"100%"},children:[e.jsx(x,{value:"all",children:"All Status"}),e.jsx(x,{value:"paid",children:"Paid"}),e.jsx(x,{value:"pending",children:"Pending"}),e.jsx(x,{value:"cancelled",children:"Cancelled"}),e.jsx(x,{value:"draft",children:"Draft"})]})}),e.jsx(c,{span:6,children:e.jsx(xe,{placeholder:["From Date","To Date"],value:j,onChange:O,style:{width:"100%"},allowClear:!0})})]})}),e.jsx(ie,{columns:H,dataSource:X,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} of ${t} invoices`}})]}),e.jsx(re,{title:"Invoice Details",open:L,onCancel:R,footer:[e.jsx(o,{icon:e.jsx(M,{}),onClick:()=>T(a?.id),children:"Download PDF"},"download"),e.jsx(o,{icon:e.jsx(ce,{}),onClick:()=>window.print(),children:"Print"},"print"),e.jsx(o,{onClick:R,children:"Close"},"close")],width:800,children:a&&e.jsxs("div",{children:[e.jsxs(n,{title:"Invoice Information",bordered:!0,size:"small",children:[e.jsx(n.Item,{label:"Invoice Number",children:a.invoice_number}),e.jsx(n.Item,{label:"Status",children:e.jsx(S,{status:P(a.status),text:a.status.charAt(0).toUpperCase()+a.status.slice(1)})}),e.jsx(n.Item,{label:"Issued Date",children:y(a.issued_date)}),e.jsx(n.Item,{label:"Due Date",children:y(a.due_date)}),e.jsx(n.Item,{label:"Total Amount",span:2,children:e.jsx(r,{strong:!0,style:{fontSize:"16px"},children:C(a.total_amount)})})]}),e.jsx(I,{}),e.jsxs(n,{title:"Customer Information",bordered:!0,size:"small",children:[e.jsx(n.Item,{label:"Name",children:a.customer?.name}),e.jsx(n.Item,{label:"Email",children:a.customer?.email}),e.jsx(n.Item,{label:"Phone",children:a.customer?.phone_number})]}),e.jsx(I,{}),a.booking&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{title:"Booking Information",bordered:!0,size:"small",children:[e.jsx(n.Item,{label:"Booking ID",children:a.booking.id}),e.jsx(n.Item,{label:"Service",children:a.booking.service?.name}),e.jsx(n.Item,{label:"Appointment",children:y(a.booking.appointment_time)}),e.jsx(n.Item,{label:"Employee",children:a.booking.employee?.name||"Auto-assigned"})]}),e.jsx(I,{})]}),e.jsxs(n,{title:"Payment Information",bordered:!0,size:"small",children:[e.jsx(n.Item,{label:"Payment Status",children:e.jsx(S,{status:A(a.payment_status),text:a.payment_status.charAt(0).toUpperCase()+a.payment_status.slice(1)})}),e.jsx(n.Item,{label:"Payment Method",children:a.payment_method||"Not specified"}),e.jsx(n.Item,{label:"Transaction ID",children:a.transaction_id||"Not available"}),a.payment_date&&e.jsx(n.Item,{label:"Payment Date",children:y(a.payment_date)})]}),e.jsx(I,{}),e.jsx("div",{style:{textAlign:"center"},children:e.jsxs(v,{children:[a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{type:"primary",icon:e.jsx(z,{}),onClick:()=>U(a.id),loading:f,children:"Mark as Paid"}),e.jsx(o,{danger:!0,icon:e.jsx(oe,{}),onClick:()=>V(a.id),loading:f,children:"Mark as Cancelled"})]}),e.jsx(o,{icon:e.jsx(le,{}),onClick:()=>F(a.id),loading:f,children:"Send Email"})]})})]})})]})]})}export{ot as default};
