import{r as m,j as e,H as q,a as f}from"./app-CjLSFTvF.js";import{A as z,R as G}from"./AdminLayout-CaACskhm.js";import{F as c}from"./index-BhQBVMnT.js";import{T as H,B as h,C as Y}from"./Logo-DLy9Pi-u.js";import{F as _}from"./Table-7REDeCqW.js";import{M as T}from"./index-BFDovZzk.js";import{R as b,C as g}from"./row-CQ454HWN.js";import{I}from"./index-D0ij-sgg.js";import{T as F}from"./index-YgNiGMGF.js";import{S as R}from"./index-Dc7Stc7a.js";import{T as N}from"./index-D1-7wZL6.js";import{U as J,R as K}from"./InboxOutlined-9AE-aW88.js";import{S as W}from"./index-ErLwKW1B.js";import{I as X}from"./index-XsTFZI-z.js";import{S as Z}from"./index-Cz--6uym.js";import{R as ee}from"./EyeOutlined-C1FdwiFg.js";import{R as ie}from"./EditOutlined-B1M0cp84.js";import{R as oe}from"./DeleteOutlined-CW1zqXNb.js";import{s as d}from"./index-BdNhniXG.js";/* empty css            */import"./index-CgCFGhN9.js";import"./index-DczFaLwX.js";import"./PurePanel-Ctdvl-zP.js";import"./move-BHpooOi0.js";import"./LogoutOutlined-Di16fjZE.js";import"./CalendarOutlined-C51-_ebW.js";import"./DollarOutlined-CnvFJIap.js";import"./UserOutlined-BTlIJHQK.js";import"./ClockCircleOutlined-B5klXXHM.js";import"./FileTextOutlined-CosqdZ2W.js";import"./GiftOutlined-CqMUofQ6.js";import"./SettingOutlined-CjjuPnIM.js";import"./useForm-DYbDyyqO.js";import"./CheckCircleFilled-Dt1Auu-O.js";import"./InfoCircleFilled-D_PNQDwx.js";import"./pickAttrs-D4RZEvRE.js";import"./addEventListener-Dkb8_L8w.js";import"./index-KNdCQ6Gc.js";import"./index-CdVV1a5r.js";import"./index-BV1LEswr.js";import"./index-_UDQvjMi.js";import"./Input-DRyzWO36.js";import"./useClosable-C1CguS7l.js";import"./EyeOutlined-FpwRxIr8.js";import"./EyeOutlined-Bmd706kk.js";import"./DownloadOutlined-DTidZHln.js";import"./progress-_SmLRBSL.js";const{Title:se,Text:x}=H,{TextArea:te}=I,{Option:re}=R;function Ze({auth:B,services:M,durations:Q,errors:u,editService:A}){const[j,p]=m.useState(!1),[l,D]=m.useState(null),[r]=c.useForm(),[O,v]=m.useState(!1),[E,S]=m.useState(null),y=M||[],w=Q||[];m.useEffect(()=>{u&&Object.keys(u).length>0&&(Object.keys(u).forEach(i=>{r.setFields([{name:i,errors:[u[i]]}])}),p(!0))},[u,r]),m.useEffect(()=>{if(j)if(l){const i={name:l.name,description:l.description||"",price:parseFloat(l.price)||0,duration:parseInt(l.duration)||60,color:l.color||"#1890ff",is_active:l.is_active!==void 0?l.is_active:!0};setTimeout(()=>{r.setFieldsValue(i),console.log("Form values set via useEffect for editing:",i)},100)}else setTimeout(()=>{r.setFieldsValue({is_active:!0,color:"#1890ff",duration:60,description:""}),console.log("Default form values set via useEffect for adding")},100)},[j,l,r]),m.useEffect(()=>{if(A){const i=y.find(s=>s.id==A);i&&C(i)}},[A,y]);const P=[{title:"Image",dataIndex:"image",key:"image",render:(i,s)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(X,{width:40,height:40,src:i||`https://placehold.co/40x40/${s.color?.replace("#","")||"1890ff"}/ffffff?text=${s.name?.charAt(0)?.toUpperCase()||"S"}`,alt:s.name,style:{borderRadius:4},fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3Ik1RnG4W+FgYxN"}),e.jsx("div",{children:e.jsx("div",{style:{fontWeight:"bold"},children:s.name})})]})},{title:"Price",dataIndex:"price",key:"price",render:i=>`â‚¹${i}`},{title:"Duration",dataIndex:"duration",key:"duration",render:i=>{const s=w.find(t=>t.value===i);return s?s.label:`${i} min`}},{title:"Employees",dataIndex:"employees",key:"employees",render:()=>e.jsx("div",{style:{opacity:.5},children:e.jsx(F,{color:"orange",size:"small",children:"Coming Soon"})})},{title:"Status",dataIndex:"is_active",key:"is_active",render:i=>e.jsx(F,{color:i?"green":"red",children:i?"Active":"Inactive"})},{title:"Actions",key:"actions",render:(i,s)=>e.jsxs(Z,{children:[e.jsx(h,{type:"text",icon:e.jsx(ee,{}),size:"small",onClick:()=>k(s)}),e.jsx(h,{type:"text",icon:e.jsx(ie,{}),size:"small",onClick:()=>C(s)}),e.jsx(h,{type:"text",icon:e.jsx(oe,{}),size:"small",danger:!0,loading:E===s.id,disabled:E===s.id,onClick:()=>V(s)})]})}],U=()=>{D(null),r.resetFields(),r.setFields([]),p(!0)},C=i=>{D(i),r.setFields([]),r.resetFields(),console.log("Service data for editing:",i),p(!0)},k=i=>{f.visit(route("admin.services.show",i.id))},V=i=>{T.confirm({title:"Delete Service",content:e.jsxs("div",{children:[e.jsxs("p",{children:["Are you sure you want to delete"," ",e.jsxs("strong",{children:['"',i.name,'"']}),"?"]}),e.jsxs("p",{style:{color:"#ff4d4f",fontSize:"14px",marginTop:8},children:[e.jsx("strong",{children:"Warning:"})," This action cannot be undone and will permanently remove:"]}),e.jsxs("ul",{style:{color:"#666",fontSize:"14px",marginTop:4},children:[e.jsx("li",{children:"The service and all its data"}),e.jsx("li",{children:"Any associated bookings (if they exist)"}),e.jsx("li",{children:"Service images and files"})]})]}),okText:"Delete Service",okType:"danger",cancelText:"Cancel",width:500,onOk(){S(i.id),d.loading({content:"Deleting service...",key:"deleteService"}),console.log("Attempting to delete service:",i.id),console.log("Delete route:",route("admin.services.delete",i.id)),f.post(route("admin.services.delete",i.id),{onSuccess:()=>{console.log("Service deleted successfully"),d.success({content:`Service "${i.name}" deleted successfully`,key:"deleteService",duration:3}),S(null),f.visit(route("admin.services"),{replace:!0,preserveScroll:!1})},onError:s=>{console.error("Delete service errors:",s),d.error({content:"Failed to delete service. Please try again.",key:"deleteService",duration:5}),S(null)},onFinish:()=>{console.log("Delete request finished")}})}})},L=()=>{const i=r.getFieldsValue();console.log("Current form values before validation:",i);const s=r.getFieldValue("description");console.log("Description field value:",s),r.validateFields().then(t=>{v(!0),console.log("Form validation passed, values:",t);const a=new FormData;console.log("Form values:",t),Object.keys(t).forEach(o=>{if(console.log(`Processing field ${o}:`,t[o]),o!=="employees")if(o==="image"&&t[o]?.fileList?.[0]?.originFileObj)a.append("image",t[o].fileList[0].originFileObj);else if(o==="color")a.append("color",t[o]||"#1890ff");else if(o==="price"){const n=parseFloat(t[o])||0;a.append(o,n),console.log("Price value:",n)}else if(o==="duration"){const n=parseInt(t[o])||0;a.append(o,n),console.log("Duration value:",n)}else o==="is_active"?(a.append(o,t[o]?"1":"0"),console.log("is_active value:",t[o]?"1":"0")):o==="description"?(a.append(o,t[o]||""),console.log("Description value:",t[o]||"")):(a.append(o,t[o]||""),console.log(`${o} value:`,t[o]||""))}),console.log("=== FormData being sent to backend ===");for(let[o,n]of a.entries())console.log(`${o}:`,n);console.log("=== End FormData ==="),l?(a.append("_method","PUT"),f.post(route("admin.services.update",l.id),a,{onSuccess:()=>{d.success("Service updated successfully"),p(!1),r.resetFields()},onError:o=>{console.error("Update service errors:",o),o&&Object.keys(o).forEach(n=>{r.setFields([{name:n,errors:[o[n]]}])}),d.error("Failed to update service")},onFinish:()=>{v(!1)}})):f.post(route("admin.services.store"),a,{onSuccess:()=>{d.success("Service created successfully"),p(!1),r.resetFields()},onError:o=>{console.error("Create service errors:",o),o&&Object.keys(o).forEach(n=>{r.setFields([{name:n,errors:[o[n]]}])}),d.error("Failed to create service")},onFinish:()=>{v(!1)}})}).catch(t=>{console.error("Form validation failed:",t),d.error("Please check the form and try again")})},$=()=>{p(!1),r.resetFields()};return e.jsxs(z,{auth:B,children:[e.jsx(q,{title:"Services Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx(se,{level:2,style:{marginBottom:8},children:"Services"}),e.jsx(x,{type:"secondary",children:"Create and manage your services for customer bookings"})]}),e.jsx(h,{type:"primary",icon:e.jsx(G,{}),size:"large",onClick:U,children:"Create Service"})]}),e.jsx(Y,{children:e.jsx(_,{columns:P,dataSource:y,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(i,s)=>`${s[0]}-${s[1]} of ${i} services`}})}),e.jsx(T,{title:l?"Edit Service":"Create Service",open:j,onOk:L,onCancel:$,width:800,okText:l?"Update":"Add Service",confirmLoading:O,children:e.jsxs(c,{form:r,layout:"vertical",children:[e.jsxs(b,{gutter:16,children:[e.jsx(g,{span:12,children:e.jsx(c.Item,{name:"name",label:"Service name*",rules:[{required:!0,message:"Please enter service name",whitespace:!0}],children:e.jsx(I,{placeholder:"Enter name"})})}),e.jsx(g,{span:12,children:e.jsx(c.Item,{name:"color",label:"Color",children:e.jsx(I,{type:"color",style:{width:"100%",height:"40px"}})})})]}),e.jsx(b,{gutter:16,children:e.jsx(g,{span:12,children:e.jsx(c.Item,{label:"Employees",children:e.jsx("div",{style:{padding:"8px 12px",border:"1px solid #d9d9d9",borderRadius:"6px",backgroundColor:"#f5f5f5",color:"#999",cursor:"not-allowed"},children:e.jsxs(x,{type:"secondary",children:[e.jsx(F,{color:"orange",children:"Coming Soon"})," ","Employee assignment will be available soon"]})})})})}),e.jsx(c.Item,{name:"description",label:"Description",children:e.jsx(te,{rows:4,placeholder:"Insert text here ...",style:{minHeight:100}})}),e.jsx(x,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:"Descriptions appear on your booking page."}),e.jsxs(b,{gutter:16,children:[e.jsxs(g,{span:12,children:[e.jsx(c.Item,{name:"duration",label:"Duration*",rules:[{required:!0,message:"Please select duration"}],children:e.jsx(R,{placeholder:"Select duration",children:w.map(i=>e.jsx(re,{value:i.value,children:i.label},i.value))})}),e.jsxs(x,{type:"secondary",style:{fontSize:"12px",marginTop:4},children:["Manage available durations in the"," ",e.jsx("a",{href:route("admin.durations"),style:{color:"#1890ff"},children:"Durations"})," ","section."]})]}),e.jsx(g,{span:12,children:e.jsx(c.Item,{name:"price",label:"Price*",rules:[{required:!0,message:"Please enter price"},{type:"number",min:0,message:"Price must be a positive number"}],children:e.jsx(N,{style:{width:"100%"},placeholder:"0.00",min:0,step:.01,formatter:i=>`â‚¹ ${i}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:i=>i.replace(/â‚¹\s?|(,*)/g,"")})})})]}),e.jsx(c.Item,{name:"image",label:"Service image",children:e.jsxs(J.Dragger,{name:"file",multiple:!1,beforeUpload:()=>!1,showUploadList:!0,accept:"image/*",maxCount:1,fileList:[],children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(K,{})}),e.jsx("p",{className:"ant-upload-text",children:"Drag and drop or choose from files"})]})}),e.jsx(c.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:e.jsx(W,{})})]})})]})]})}export{Ze as default};
