import{r as x,j as e,H as z,a as h}from"./app-CtEd8btx.js";import{A as N}from"./AdminLayout-BEvcnGED.js";import{F as l}from"./index-aDyUgOzz.js";import{T as G,B as f,C as H,S as Y,a as E}from"./Logo-CDnTpOJ2.js";import{R as $}from"./PlusOutlined-CeknAaeW.js";import{F as J}from"./Table-Cm5CCh6T.js";import{M as _}from"./index-BTOKf7cx.js";import{R as I,C as p}from"./row-CVSIS8QX.js";import{I as w}from"./index-1w_Q1RV3.js";import{T as A}from"./index-DeHzBb--.js";import{S as v}from"./index-5b81ZYwK.js";import{S as K}from"./index-HUoB79NY.js";import{U as W,R as X}from"./InboxOutlined-Co1gJbSv.js";import{s as d}from"./index-nLhxi_fe.js";import{I as Z}from"./index-CxctMhVN.js";import{R as ee}from"./ClockCircleOutlined-2gudfEud.js";import{T as S}from"./index-CFlffEWB.js";import{R as te}from"./EyeOutlined-Bus_tmcI.js";import{R as re}from"./EditOutlined-x1kfgWtO.js";import{P as ae}from"./index-DP_7q0Sn.js";import{R as ie}from"./DeleteOutlined-BTHOYX42.js";/* empty css            */import"./index-Bh9DPq6e.js";import"./FireOutlined-NKiv-rEg.js";import"./index-nxhcDVax.js";import"./move-BiJmt5SU.js";import"./CalendarOutlined-BdCkm89t.js";import"./DollarOutlined-DUfht7U5.js";import"./UserOutlined-C3KekljF.js";import"./FileTextOutlined-BLQwQrUj.js";import"./GiftOutlined-Ce7eZHfK.js";import"./useForm-BBAlVzQt.js";import"./CheckCircleFilled-Ccn4KK4E.js";import"./InfoCircleFilled-D9zg5ZWO.js";import"./addEventListener-B7LN8YTG.js";import"./DownOutlined-CIB-8ZZZ.js";import"./index-CbhzR6cM.js";import"./Pagination-LG675jey.js";import"./index-CpGRbCUp.js";import"./extendsObject-78o_rR5W.js";import"./index-B-YKnWi6.js";import"./Input-C2tQw5js.js";import"./useClosable-CiHGdOKG.js";import"./EyeOutlined-x45iK2et.js";import"./EyeOutlined-Bmd706kk.js";import"./DownloadOutlined-DTidZHln.js";import"./progress-a71eiBSe.js";const{Title:D,Text:c}=G,{TextArea:F}=w,{Option:C}=v;function Ze({auth:R,extras:g,services:B,durations:M,errors:se}){const[j,m]=x.useState(!1);console.log("Admin Extras component - Extras data:",g),g.forEach((t,r)=>{console.log(`Admin Extra ${r+1}:`,{id:t.id,name:t.name,duration_id:t.duration_id,durationRelation:t.durationRelation,hasDurationRelation:!!t.durationRelation,durationLabel:t.durationRelation?.label})});const[i,y]=x.useState(null),[s,u]=x.useState(!1),[L,b]=x.useState(!1),[n]=l.useForm();x.useEffect(()=>{if(j)if(i){const t={name:i.name||"",description:i.description||"",disclaimer_title:i.disclaimer_title||"",disclaimer_content:i.disclaimer_content||"",price:parseFloat(i.price)||0,duration_id:i.duration_id||null,max_quantity:i.max_quantity||5,sort_order:i.sort_order||0,is_active:i.is_active!==void 0?i.is_active:!0,services:i.services?.map(r=>r.id)||[]};setTimeout(()=>{n.setFieldsValue(t)},100)}else setTimeout(()=>{n.setFieldsValue({is_active:!0,duration_id:null,max_quantity:5,sort_order:0,description:"",disclaimer_title:"",disclaimer_content:"",services:[]})},100)},[j,i,n]);const Q=()=>{y(null),u(!1),m(!0)},q=t=>{y(t),u(!1),m(!0)},V=t=>{y(t),u(!0),m(!0)},k=(t,r)=>{if(r===null||r<0){d.error("Sort order must be a positive number");return}h.put(route("admin.extras.update-sort-order",t),{sort_order:r},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{d.success("Sort order updated successfully")},onError:a=>{d.error(a.error||"Failed to update sort order")}})},O=t=>{_.confirm({title:"Delete Extra",content:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk(){d.loading({content:"Deleting extra...",key:"deleteExtra"}),h.post(route("admin.extras.delete",t.id),{onSuccess:()=>{d.success({content:"Extra deleted successfully",key:"deleteExtra",duration:3})},onError:()=>{d.error({content:"Failed to delete extra",key:"deleteExtra",duration:5})}})}})},P=()=>{n.validateFields().then(t=>{b(!0);const r=new FormData;Object.keys(t).forEach(a=>{if(a==="image"&&t[a]?.fileList?.[0]?.originFileObj)r.append("image",t[a].fileList[0].originFileObj);else if(a==="price"){const o=parseFloat(t[a])||0;r.append(a,o)}else if(a==="duration_id"){const o=t[a]||null;r.append(a,o)}else if(a==="is_active")r.append(a,t[a]?"1":"0");else if(a==="services")t[a]&&t[a].length>0&&t[a].forEach(o=>{r.append("services[]",o)});else if(a==="sort_order"){const o=t[a]!==null&&t[a]!==void 0?t[a]:0;r.append(a,o)}else r.append(a,t[a]||"")}),i?(r.append("_method","PUT"),h.post(route("admin.extras.update",i.id),r,{onSuccess:()=>{d.success("Extra updated successfully"),m(!1),n.resetFields()},onError:a=>{a&&Object.keys(a).forEach(o=>{n.setFields([{name:o,errors:[a[o]]}])}),d.error("Failed to update extra")},onFinish:()=>{b(!1)}})):h.post(route("admin.extras.store"),r,{onSuccess:()=>{d.success("Extra created successfully"),m(!1),n.resetFields()},onError:a=>{a&&Object.keys(a).forEach(o=>{n.setFields([{name:o,errors:[a[o]]}])}),d.error("Failed to create extra")},onFinish:()=>{b(!1)}})}).catch(t=>{console.error("Form validation failed:",t),d.error("Please check the form and try again")})},T=()=>{m(!1),u(!1),n.resetFields()},U=[{title:"Image",dataIndex:"image",key:"image",render:(t,r)=>e.jsx(Z,{width:40,height:40,src:t||`https://placehold.co/40x40/1890ff/ffffff?text=${r.name?.charAt(0)?.toUpperCase()||"E"}`,alt:r.name,style:{borderRadius:4},fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3Ik1RnG4W+FgYxN"})},{title:"Name",dataIndex:"name",key:"name",render:t=>e.jsx(c,{strong:!0,children:t})},{title:"Price",dataIndex:"price",key:"price",render:t=>e.jsxs(c,{strong:!0,style:{color:"#52c41a"},children:["₹",t]})},{title:"Duration",dataIndex:"duration",key:"duration",render:(t,r)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(ee,{style:{color:"#1890ff"}}),e.jsx(c,{children:r.durationRelation?r.durationRelation.label:"No additional time"})]})},{title:"Available For",dataIndex:"services",key:"services",render:t=>e.jsxs("div",{children:[t&&t.length>0?t.slice(0,2).map(r=>e.jsx(S,{color:"blue",style:{marginBottom:4},children:r.name},r.id)):e.jsx(S,{color:"orange",children:"All Services"}),t&&t.length>2&&e.jsxs(c,{type:"secondary",style:{fontSize:"11px"},children:["+",t.length-2," more"]})]})},{title:"Sort Order",dataIndex:"sort_order",key:"sort_order",render:(t,r)=>e.jsx(A,{min:0,max:999,value:t,onChange:a=>k(r.id,a),style:{width:80},size:"small"})},{title:"Status",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(S,{color:t?"green":"red",children:t?"Active":"Inactive"})},{title:"Actions",key:"actions",render:(t,r)=>e.jsxs(Y,{children:[e.jsx(E,{title:"View Extra",children:e.jsx(f,{icon:e.jsx(te,{}),size:"small",onClick:()=>V(r)})}),e.jsx(E,{title:"Edit Extra",children:e.jsx(f,{type:"primary",icon:e.jsx(re,{}),size:"small",onClick:()=>q(r)})}),e.jsx(E,{title:"Delete Extra",children:e.jsx(ae,{title:"Delete this extra?",description:"This action cannot be undone.",onConfirm:()=>O(r),okText:"Yes",cancelText:"No",children:e.jsx(f,{danger:!0,icon:e.jsx(ie,{}),size:"small"})})})]})}];return e.jsxs(N,{auth:R,children:[e.jsx(z,{title:"Extras Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx(D,{level:2,style:{marginBottom:4},children:"Extras Management"}),e.jsx(c,{type:"secondary",children:"Manage additional services and add-ons"})]}),e.jsx(f,{type:"primary",icon:e.jsx($,{}),onClick:Q,children:"Add Extra"})]}),e.jsx(H,{children:e.jsx(J,{columns:U,dataSource:g,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,r)=>`${r[0]}-${r[1]} of ${t} extras`}})}),e.jsx(_,{title:s?`View Extra: ${i?.name}`:i?"Edit Extra":"Add Extra",open:j,onOk:s?T:P,onCancel:T,confirmLoading:L,width:600,okText:s?"Close":"Save",cancelText:"Cancel",children:e.jsxs(l,{form:n,layout:"vertical",children:[e.jsxs(I,{gutter:16,children:[e.jsx(p,{span:12,children:e.jsx(l.Item,{name:"name",label:"Extra name*",rules:s?[]:[{required:!0,message:"Please enter extra name",whitespace:!0}],children:e.jsx(w,{placeholder:"Enter name",disabled:s})})}),e.jsx(p,{span:12,children:e.jsx(l.Item,{name:"price",label:"Price*",rules:s?[]:[{required:!0,message:"Please enter price"},{type:"number",min:0,message:"Price must be a positive number"}],children:e.jsx(A,{style:{width:"100%"},placeholder:"0.00",min:0,step:.01,disabled:s,formatter:t=>`₹ ${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/₹\s?|(,*)/g,"")})})})]}),e.jsx(l.Item,{name:"description",label:"Description",children:e.jsx(F,{rows:3,placeholder:"Describe this extra service...",disabled:s})}),e.jsxs("div",{style:{marginTop:24,marginBottom:16},children:[e.jsx(D,{level:4,style:{marginBottom:16},children:"Extra Details Modal"}),e.jsx(c,{type:"secondary",style:{fontSize:14,marginBottom:16,display:"block"},children:"Customize the disclaimer section that appears in the extra details modal."})]}),e.jsx(l.Item,{name:"disclaimer_title",label:"Disclaimer Title",children:e.jsx(w,{placeholder:"e.g., What's Included, Important Notice, etc.",maxLength:255,disabled:s})}),e.jsx(c,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:`This title will appear in the extra details modal. Leave empty to use default "What's Included".`}),e.jsx(l.Item,{name:"disclaimer_content",label:"Disclaimer Content",children:e.jsx(F,{rows:4,placeholder:"Enter disclaimer content that will appear in the extra details modal...",style:{minHeight:100},disabled:s})}),e.jsx(c,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:"This content will appear in the extra details modal. Supports HTML formatting. Leave empty to use default content."}),e.jsxs(I,{gutter:16,children:[e.jsx(p,{span:12,children:e.jsx(l.Item,{name:"duration_id",label:"Additional Duration",children:e.jsx(v,{placeholder:"Select duration (optional)",allowClear:!0,style:{width:"100%"},disabled:s,children:M?.map(t=>e.jsx(C,{value:t.id,children:t.label},t.id))})})}),e.jsx(p,{span:12,children:e.jsx(l.Item,{name:"max_quantity",label:"Max Quantity",rules:[{required:!0,message:"Please enter maximum quantity"},{type:"number",min:1,max:20,message:"Value must be between 1 and 20"}],children:e.jsx(A,{min:1,max:20,style:{width:"100%"},placeholder:"Enter max quantity",disabled:s})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(p,{span:12,children:e.jsx(l.Item,{name:"sort_order",label:"Sort Order",rules:[{type:"number",min:0,message:"Sort order must be a positive number"}],children:e.jsx(A,{min:0,max:999,style:{width:"100%"},placeholder:"0",disabled:s,onChange:t=>{const r=t??0;n.setFieldsValue({sort_order:r})}})})}),e.jsx(p,{span:12,children:e.jsx(l.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:e.jsx(K,{disabled:s})})})]}),e.jsx(l.Item,{name:"services",label:"Available for Services",children:e.jsx(v,{mode:"multiple",placeholder:"Select services (leave empty for all services)",allowClear:!0,style:{width:"100%"},disabled:s,children:B.map(t=>e.jsx(C,{value:t.id,children:t.name},t.id))})}),e.jsx(c,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:"Select specific services where this extra will be available. Leave empty to make it available for all services."}),e.jsx(l.Item,{name:"image",label:"Extra image",children:e.jsxs(W.Dragger,{name:"file",multiple:!1,beforeUpload:()=>!1,showUploadList:!0,accept:"image/*",maxCount:1,fileList:[],disabled:s,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(X,{})}),e.jsx("p",{className:"ant-upload-text",children:s?"Image preview":"Drag and drop or choose from files"})]})})]})})]})]})}export{Ze as default};
