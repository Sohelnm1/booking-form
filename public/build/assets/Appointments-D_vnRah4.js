import{r as b,g as Z,j as e,H as q}from"./app-CJqx2nlw.js";import{A as G}from"./AdminLayout-4UMouIZI.js";import{d as O}from"./dayjs.min-ByW_Pquc.js";import{I as J,C as k,T as Q,B as L}from"./Logo-BxrHS6GJ.js";import{S as g}from"./index-as06zxLB.js";import{R as W,C as P}from"./row-BB7zYcZo.js";import{I as X}from"./index-B2sDrt4R.js";import{R as ee}from"./SearchOutlined-DEefFG1X.js";import{S as K}from"./index-BEVLC0fB.js";import{D as te}from"./index-B5VhipnB.js";import{F as se}from"./Table-BTQPa3Mr.js";import{M as re}from"./index-Be8JAZRx.js";import{D as l}from"./index-BsWEY6ir.js";import{D as Y}from"./index-DLM9gAB5.js";import{B as w}from"./index-o9MwV1wX.js";import{R as ne}from"./CheckCircleOutlined-BNgPEE5D.js";import{R as ie,a as ae}from"./PrinterOutlined-C-E5AyQf.js";import{R as le}from"./UserOutlined-LBaZxvD8.js";import{R as oe}from"./MailOutlined-Vhgo8UzK.js";import{R as ce}from"./PhoneOutlined-CJIyHHPe.js";import{R as ue}from"./CalendarOutlined-B_C58u2P.js";import{R as me}from"./ClockCircleOutlined-BkYPCbn9.js";import{T as de}from"./index-CV9a0vwC.js";import{R as he}from"./EyeOutlined-CmYqSlXx.js";/* empty css            */import"./index-Bd_PfEaH.js";import"./index-DWAqtCPW.js";import"./PurePanel-Db2cDM3B.js";import"./pickAttrs-Oxm3QeZq.js";import"./move-B1raSf7m.js";import"./LogoutOutlined-DaqdC0QT.js";import"./FileTextOutlined-LpUW-RpF.js";import"./GiftOutlined-Cqb3iW8w.js";import"./SettingOutlined-DadYMtaq.js";import"./index-BSbgTexK.js";import"./Input-CO2vg1SB.js";import"./EyeOutlined-Bp5OE_RV.js";import"./EyeOutlined-Bmd706kk.js";import"./index-CKTeyKnI.js";import"./addEventListener-HUtlaoVL.js";import"./index-Cn4Gi7e7.js";import"./index-CRPSkqIR.js";import"./useForm-BiSx87GW.js";import"./index-DiKTrVqn.js";import"./CheckCircleFilled-As6OzaIf.js";import"./InfoCircleFilled-C2YIh8OJ.js";import"./DownloadOutlined-DTidZHln.js";var fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"};function H(){return H=Object.assign?Object.assign.bind():function(S){for(var D=1;D<arguments.length;D++){var t=arguments[D];for(var y in t)Object.prototype.hasOwnProperty.call(t,y)&&(S[y]=t[y])}return S},H.apply(this,arguments)}const pe=(S,D)=>b.createElement(J,H({},S,{ref:D,icon:fe})),xe=b.forwardRef(pe);var B={exports:{}},je=B.exports,N;function ve(){return N||(N=1,function(S,D){(function(t,y){S.exports=y()})(je,function(){var t="minute",y=/[+-]\d\d(?::?\d\d)?/g,A=/([+-]|\d\d)/g;return function(M,m,$){var o=m.prototype;$.utc=function(s){var i={date:s,utc:!0,args:arguments};return new m(i)},o.utc=function(s){var i=$(this.toDate(),{locale:this.$L,utc:!0});return s?i.add(this.utcOffset(),t):i},o.local=function(){return $(this.toDate(),{locale:this.$L,utc:!1})};var I=o.parse;o.parse=function(s){s.utc&&(this.$u=!0),this.$utils().u(s.$offset)||(this.$offset=s.$offset),I.call(this,s)};var z=o.init;o.init=function(){if(this.$u){var s=this.$d;this.$y=s.getUTCFullYear(),this.$M=s.getUTCMonth(),this.$D=s.getUTCDate(),this.$W=s.getUTCDay(),this.$H=s.getUTCHours(),this.$m=s.getUTCMinutes(),this.$s=s.getUTCSeconds(),this.$ms=s.getUTCMilliseconds()}else z.call(this)};var R=o.utcOffset;o.utcOffset=function(s,i){var f=this.$utils().u;if(f(s))return this.$u?0:f(this.$offset)?R.call(this):this.$offset;if(typeof s=="string"&&(s=function(v){v===void 0&&(v="");var C=v.match(y);if(!C)return null;var _=(""+C[0]).match(A)||["-",0,0],r=_[0],n=60*+_[1]+ +_[2];return n===0?0:r==="+"?n:-n}(s),s===null))return this;var p=Math.abs(s)<=16?60*s:s,d=this;if(i)return d.$offset=p,d.$u=s===0,d;if(s!==0){var x=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(d=this.local().add(p+x,t)).$offset=p,d.$x.$localOffset=x}else d=this.utc();return d};var c=o.format;o.format=function(s){var i=s||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return c.call(this,i)},o.valueOf=function(){var s=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*s},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var h=o.toDate;o.toDate=function(s){return s==="s"&&this.$offset?$(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var a=o.diff;o.diff=function(s,i,f){if(s&&this.$u===s.$u)return a.call(this,s,i,f);var p=this.local(),d=$(s).local();return a.call(p,d,i,f)}}})}(B)),B.exports}var ye=ve();const ge=Z(ye);var U={exports:{}},_e=U.exports,V;function $e(){return V||(V=1,function(S,D){(function(t,y){S.exports=y()})(_e,function(){var t={year:0,month:1,day:2,hour:3,minute:4,second:5},y={};return function(A,M,m){var $,o=function(c,h,a){a===void 0&&(a={});var s=new Date(c),i=function(f,p){p===void 0&&(p={});var d=p.timeZoneName||"short",x=f+"|"+d,v=y[x];return v||(v=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:f,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:d}),y[x]=v),v}(h,a);return i.formatToParts(s)},I=function(c,h){for(var a=o(c,h),s=[],i=0;i<a.length;i+=1){var f=a[i],p=f.type,d=f.value,x=t[p];x>=0&&(s[x]=parseInt(d,10))}var v=s[3],C=v===24?0:v,_=s[0]+"-"+s[1]+"-"+s[2]+" "+C+":"+s[4]+":"+s[5]+":000",r=+c;return(m.utc(_).valueOf()-(r-=r%1e3))/6e4},z=M.prototype;z.tz=function(c,h){c===void 0&&(c=$);var a,s=this.utcOffset(),i=this.toDate(),f=i.toLocaleString("en-US",{timeZone:c}),p=Math.round((i-new Date(f))/1e3/60),d=15*-Math.round(i.getTimezoneOffset()/15)-p;if(!Number(d))a=this.utcOffset(0,h);else if(a=m(f,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(d,!0),h){var x=a.utcOffset();a=a.add(s-x,"minute")}return a.$x.$timezone=c,a},z.offsetName=function(c){var h=this.$x.$timezone||m.tz.guess(),a=o(this.valueOf(),h,{timeZoneName:c}).find(function(s){return s.type.toLowerCase()==="timezonename"});return a&&a.value};var R=z.startOf;z.startOf=function(c,h){if(!this.$x||!this.$x.$timezone)return R.call(this,c,h);var a=m(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return R.call(a,c,h).tz(this.$x.$timezone,!0)},m.tz=function(c,h,a){var s=a&&h,i=a||h||$,f=I(+m(),i);if(typeof c!="string")return m(c).tz(i);var p=function(C,_,r){var n=C-60*_*1e3,j=I(n,r);if(_===j)return[n,_];var F=I(n-=60*(j-_)*1e3,r);return j===F?[n,j]:[C-60*Math.min(j,F)*1e3,Math.max(j,F)]}(m.utc(c,s).valueOf(),f,i),d=p[0],x=p[1],v=m(d).utcOffset(x);return v.$x.$timezone=i,v},m.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},m.tz.setDefault=function(c){$=c}}})}(U)),U.exports}var Se=$e();const ze=Z(Se);O.extend(ge);O.extend(ze);const{Title:E,Text:u}=Q,{Option:T}=K,{Search:Ce}=X;function yt({auth:S,bookings:D}){const[t,y]=b.useState(null),[A,M]=b.useState(!1),[m,$]=b.useState(""),[o,I]=b.useState("all"),[z,R]=b.useState(null),c=r=>{y(r),M(!0)},h=()=>{M(!1),y(null)},a=r=>{window.open(`/admin/appointments/${r}/pdf`,"_blank")},s=()=>{window.open("/admin/appointments/export-excel","_blank")},i=r=>{switch(r){case"confirmed":return"success";case"pending":return"warning";case"completed":return"processing";case"cancelled":return"error";case"no_show":return"default";default:return"default"}},f=r=>{switch(r){case"paid":return"success";case"pending":return"warning";case"failed":return"error";case"refunded":return"default";default:return"default"}},p=r=>O(r).tz("Asia/Kolkata").format("h:mm A"),d=r=>O(r).tz("Asia/Kolkata").format("MMM DD, YYYY"),x=r=>O(r).tz("Asia/Kolkata").format("MMM DD, YYYY h:mm A"),v=r=>{const n=r.form_field;if(!n)return e.jsxs("div",{style:{marginBottom:8},children:[e.jsxs(u,{strong:!0,style:{fontSize:"12px",color:"#666"},children:["Unknown Field (ID: ",r.form_field_id,"):"]}),e.jsx("br",{}),e.jsx(u,{children:r.response_value||"Not provided"})]},r.id);const j=r.formatted_value||r.response_value;return e.jsxs("div",{style:{marginBottom:8},children:[e.jsxs(u,{strong:!0,style:{fontSize:"12px",color:"#666"},children:[n.label,":"]}),e.jsx("br",{}),e.jsx(u,{children:j||"Not provided"})]},r.id)},C=D.filter(r=>{const n=m===""||r.customer.name.toLowerCase().includes(m.toLowerCase())||r.customer.email.toLowerCase().includes(m.toLowerCase())||r.service.name.toLowerCase().includes(m.toLowerCase())||r.employee.name.toLowerCase().includes(m.toLowerCase()),j=o==="all"||r.status===o,F=!z||O(r.appointment_time).tz("Asia/Kolkata").isSame(z,"day");return n&&j&&F}),_=[{title:"Customer",key:"customer",render:(r,n)=>e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsxs(g,{children:[e.jsx(le,{}),e.jsx(u,{strong:!0,children:n.customer.name})]}),e.jsxs(g,{children:[e.jsx(oe,{}),e.jsx(u,{copyable:!0,style:{fontSize:"12px"},children:n.customer.email})]}),e.jsxs(g,{children:[e.jsx(ce,{}),e.jsx(u,{copyable:!0,style:{fontSize:"12px"},children:n.customer.phone_number})]})]})},{title:"Service & Employee",key:"service",render:(r,n)=>e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsxs("div",{children:[e.jsx(u,{strong:!0,children:n.service.name}),e.jsx("br",{}),e.jsxs(u,{type:"secondary",style:{fontSize:"12px"},children:[n.service.duration," min • ₹",n.service.price]})]}),e.jsx("div",{children:e.jsxs(u,{type:"secondary",style:{fontSize:"12px"},children:["Assigned to: ",n.employee.name,e.jsx(w,{status:n.employee.is_active?"success":"error",text:n.employee.is_active?"Active":"Inactive",style:{marginLeft:4,fontSize:"10px"}})]})})]})},{title:"Appointment",key:"appointment",render:(r,n)=>e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsxs(g,{children:[e.jsx(ue,{}),e.jsx(u,{children:d(n.appointment_time)})]}),e.jsxs(g,{children:[e.jsx(me,{}),e.jsx(u,{children:p(n.appointment_time)})]}),e.jsxs(u,{type:"secondary",style:{fontSize:"12px"},children:["Duration: ",n.duration," min"]})]})},{title:"Extras",key:"extras",render:(r,n)=>e.jsx("div",{children:n.extras&&n.extras.length>0?n.extras.map(j=>e.jsxs(de,{color:"blue",style:{marginBottom:4},children:[j.name," (₹",j.pivot.price,")"]},j.id)):e.jsx(u,{type:"secondary",style:{fontSize:"12px"},children:"No extras"})})},{title:"Total & Status",key:"total",render:(r,n)=>e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsxs(g,{children:[e.jsx(u,{strong:!0,style:{color:"#1890ff"},children:"₹"}),e.jsxs(u,{strong:!0,children:["₹",n.total_amount]})]}),e.jsx(g,{children:e.jsx(w,{status:i(n.status),text:n.status_text||n.status})}),e.jsx(g,{children:e.jsx(w,{status:f(n.payment_status),text:n.payment_status_text||n.payment_status})}),n.reschedule_attempts>0&&e.jsx(g,{children:e.jsxs(u,{type:"secondary",style:{fontSize:"12px"},children:["Rescheduled: ",n.reschedule_attempts," ","time(s)"]})})]})},{title:"Actions",key:"actions",render:(r,n)=>e.jsxs(g,{direction:"vertical",size:"small",children:[e.jsx(L,{type:"primary",icon:e.jsx(he,{}),size:"small",onClick:()=>c(n),style:{width:"100%"},children:"View Details"}),e.jsx(L,{type:"default",icon:e.jsx(ae,{}),size:"small",onClick:()=>a(n.id),style:{width:"100%"},children:"Download PDF"})]})}];return e.jsxs(G,{auth:S,children:[e.jsx(q,{title:"Appointments"}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(k,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsx(E,{level:2,style:{margin:0},children:"Appointments"}),e.jsxs(g,{children:[e.jsx(L,{type:"primary",icon:e.jsx(xe,{}),onClick:s,style:{marginRight:8},children:"Export to Excel"}),e.jsxs(u,{type:"secondary",children:["Total: ",C.length," bookings"]})]})]}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(W,{gutter:16,children:[e.jsx(P,{span:8,children:e.jsx(Ce,{placeholder:"Search by customer, service, or employee",allowClear:!0,value:m,onChange:r=>$(r.target.value),prefix:e.jsx(ee,{})})}),e.jsx(P,{span:4,children:e.jsxs(K,{placeholder:"Status",value:o,onChange:I,style:{width:"100%"},children:[e.jsx(T,{value:"all",children:"All Status"}),e.jsx(T,{value:"pending",children:"Pending"}),e.jsx(T,{value:"confirmed",children:"Confirmed"}),e.jsx(T,{value:"completed",children:"Completed"}),e.jsx(T,{value:"cancelled",children:"Cancelled"}),e.jsx(T,{value:"no_show",children:"No Show"})]})}),e.jsx(P,{span:4,children:e.jsx(te,{placeholder:"Filter by date",value:z,onChange:R,style:{width:"100%"},allowClear:!0})})]})}),e.jsx(se,{columns:_,dataSource:C,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(r,n)=>`${n[0]}-${n[1]} of ${r} appointments`}})]}),e.jsx(re,{title:"Booking Details",open:A,onCancel:h,footer:[e.jsx(L,{icon:e.jsx(ie,{}),onClick:()=>a(t.id),children:"Print PDF"},"print"),e.jsx(L,{onClick:h,children:"Close"},"close")],width:800,children:t&&e.jsxs("div",{children:[e.jsxs(l,{title:"Customer Information",bordered:!0,size:"small",children:[e.jsx(l.Item,{label:"Name",span:2,children:t.customer.name}),e.jsx(l.Item,{label:"Email",span:2,children:t.customer.email}),e.jsx(l.Item,{label:"Phone",span:2,children:t.customer.phone_number})]}),e.jsx(Y,{}),e.jsxs(l,{title:"Booking Information",bordered:!0,size:"small",children:[e.jsx(l.Item,{label:"Service",children:t.service.name}),e.jsxs(l.Item,{label:"Employee",children:[t.employee.name,e.jsx(w,{status:t.employee.is_active?"success":"error",text:t.employee.is_active?"Active":"Inactive",style:{marginLeft:8}})]}),e.jsx(l.Item,{label:"Date & Time",children:x(t.appointment_time)}),e.jsxs(l.Item,{label:"Duration",children:[t.duration," minutes"]}),e.jsx(l.Item,{label:"Status",children:e.jsx(w,{status:i(t.status),text:t.status_text||t.status})}),e.jsx(l.Item,{label:"Payment Status",children:e.jsx(w,{status:f(t.payment_status),text:t.payment_status_text||t.payment_status})}),e.jsx(l.Item,{label:"Total Amount",span:2,children:e.jsxs(u,{strong:!0,style:{fontSize:"16px"},children:["₹",t.total_amount]})}),t.reschedule_attempts>0&&e.jsxs(l.Item,{label:"Reschedule Attempts",children:[t.reschedule_attempts," ","time(s)"]}),t.rescheduled_at&&e.jsx(l.Item,{label:"Last Rescheduled",children:x(t.rescheduled_at)})]}),e.jsx(Y,{}),t.extras&&t.extras.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(l,{title:"Selected Extras",bordered:!0,size:"small",children:t.extras.map(r=>e.jsxs(l.Item,{label:r.name,children:["₹",r.pivot.price]},r.id))}),e.jsx(Y,{})]}),(()=>{const r=t.form_responses;if(r&&r.length>0){const n=r.filter(j=>j.form_field&&!j.form_field.is_primary);return n.length>0?e.jsxs("div",{children:[e.jsx(E,{level:4,children:"Custom Field Responses"}),e.jsx(k,{size:"small",children:n.map(v)})]}):e.jsxs("div",{children:[e.jsx(E,{level:4,children:"Custom Field Responses"}),e.jsx(k,{size:"small",children:e.jsx(u,{type:"secondary",children:"No custom field responses found."})})]})}else return e.jsxs("div",{children:[e.jsx(E,{level:4,children:"Custom Field Responses"}),e.jsx(k,{size:"small",children:e.jsx(u,{type:"secondary",children:"No form responses found."})})]})})(),t.consent_given&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsxs(l,{title:"Consent Information",bordered:!0,size:"small",children:[e.jsxs(l.Item,{label:"Consent Given",children:[e.jsx(ne,{style:{color:"green"}})," ","Yes"]}),e.jsx(l.Item,{label:"Consent Date",children:t.consent_given_at?x(t.consent_given_at):"Not recorded"})]})]}),(t.reschedule_attempts>0||t.reschedule_payment_amount>0)&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsxs(l,{title:"Reschedule Information",bordered:!0,size:"small",children:[t.reschedule_attempts>0&&e.jsxs(l.Item,{label:"Reschedule Attempts",children:[t.reschedule_attempts," ","time(s)"]}),t.rescheduled_at&&e.jsx(l.Item,{label:"Last Rescheduled",children:x(t.rescheduled_at)}),t.reschedule_payment_amount>0&&e.jsx(l.Item,{label:"Reschedule Fee Paid",children:e.jsxs(u,{strong:!0,style:{color:"#52c41a"},children:["₹",t.reschedule_payment_amount]})}),t.reschedule_payment_id&&e.jsx(l.Item,{label:"Payment ID",children:e.jsx(u,{code:!0,children:t.reschedule_payment_id})}),t.reschedule_payment_date&&e.jsx(l.Item,{label:"Payment Date",children:x(t.reschedule_payment_date)}),t.reschedule_payment_status&&e.jsx(l.Item,{label:"Payment Status",children:e.jsx(w,{status:t.reschedule_payment_status==="paid"?"success":t.reschedule_payment_status==="pending"?"warning":t.reschedule_payment_status==="failed"?"error":"default",text:t.reschedule_payment_status.charAt(0).toUpperCase()+t.reschedule_payment_status.slice(1).replace("_"," ")})})]})]})]})})]})]})}export{yt as default};
