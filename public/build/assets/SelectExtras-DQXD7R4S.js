import{r as j,j as t,H as J,a as $}from"./app-CADLw3G9.js";import{B as U}from"./BookingHeader-eDzihycA.js";import{I as G,a9 as K,T as X,C as S,B as h}from"./Logo-CLAK33tc.js";import{P as Z}from"./progress-SnWWg880.js";import{R as z,C as y}from"./row-Dom2nqZh.js";import{T as C}from"./index-CKLq3zDx.js";import{S as B}from"./index-nwNNYHB9.js";import{A}from"./index-CfCHoYee.js";import{C as P}from"./index-DnbYL6Tl.js";import{R as tt}from"./InfoCircleOutlined-Xhcdt5Mo.js";import{R as et}from"./PlusOutlined-CiRxDKim.js";import{s as _}from"./index-2mpHb7UY.js";import{D as W}from"./index-B12X-zrZ.js";import{R as nt}from"./ArrowLeftOutlined-Br1CB3En.js";import{R as it}from"./ArrowRightOutlined-BJ7EAVJj.js";import{M as ot}from"./index-C6Y6ZG1D.js";/* empty css            */import"./CustomerLoginModal-D-DurPKh.js";import"./PhoneOutlined-gkVsPP0b.js";import"./LockOutlined-COLUNfIz.js";import"./index-SwRbmmP5.js";import"./Input-DEZKARtK.js";import"./pickAttrs-9MlZ-O9_.js";import"./EyeOutlined-DLLudd9l.js";import"./EyeOutlined-Bmd706kk.js";import"./index-C06X103F.js";import"./LogoutOutlined-D2_QBXct.js";import"./BookOutlined-0oTi6rVr.js";import"./CalendarOutlined-Cm65HkJR.js";import"./CheckCircleFilled-CHwNSVBx.js";import"./useClosable-CSbyRlS0.js";import"./extendsObject-78o_rR5W.js";import"./InfoCircleFilled-DJey1gcQ.js";import"./PurePanel-DvLIh7gb.js";var st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"};function k(){return k=Object.assign?Object.assign.bind():function(r){for(var c=1;c<arguments.length;c++){var f=arguments[c];for(var s in f)Object.prototype.hasOwnProperty.call(f,s)&&(r[s]=f[s])}return r},k.apply(this,arguments)}const rt=(r,c)=>j.createElement(G,k({},r,{ref:c,icon:st})),lt=j.forwardRef(rt),{Title:g,Text:l}=X;function Nt({service:r,extras:c,bookingSettings:f,selectedPricingTier:s,selectedDuration:at,selectedPrice:dt,auth:F}){const[a,E]=j.useState([]),[u,b]=j.useState({}),[Q,w]=j.useState(!1),[m,D]=j.useState(null),p=f?.max_extras_per_booking||10,T=f?.enable_extra_quantities!==!1;console.log("SelectExtras component - Extras data:",c),console.log("SelectExtras component - Selected extras:",a),console.log("SelectExtras component - Booking settings:",f),c.forEach((e,n)=>{console.log(`Extra ${n+1}:`,{id:e.id,name:e.name,duration_id:e.duration_id,durationRelation:e.durationRelation,hasDurationRelation:!!e.durationRelation,durationLabel:e.durationRelation?.label})});const I=e=>{E(n=>n.find(i=>i.id===e.id)?(b(i=>{const d={...i};return delete d[e.id],d}),n.filter(i=>i.id!==e.id)):n.length>=p?(_.warning(`You can only select up to ${p} different extras.`),n):(b(i=>({...i,[e.id]:1})),[...n,e]))},M=(e,n)=>{if(n<1)E(o=>o.filter(i=>i.id!==e)),b(o=>{const i={...o};return delete i[e],i});else{const i=a.find(d=>d.id===e)?.max_quantity||5;if(n>i){_.warning(`You can only add up to ${i} of this extra.`);return}b(d=>({...d,[e]:n}))}},H=()=>{$.visit(route("booking.select-service"))},O=()=>{const e=a.map(i=>i.id),n=a.map(i=>({id:i.id,quantity:u[i.id]||1})),o=encodeURIComponent(JSON.stringify(n));$.visit(route("booking.select-datetime"),{data:{service_id:r.id,pricing_tier_id:s?.id,selected_duration:s?.duration_minutes||r.duration,selected_price:s?.price||r.price,extras:e,extra_quantities_json:o}})},x=e=>`₹${parseFloat(e).toFixed(2)}`,q=()=>{const e=parseFloat(s?s.price:r.price),n=a.reduce((o,i)=>{const d=u[i.id]||1;return o+parseFloat(i.price)*d},0);return e+n},L=()=>{const e=s?s.duration_minutes:r.duration,n=a.reduce((o,i)=>{const d=u[i.id]||1;if(i.durationRelation){const V=i.durationRelation.hours*60+i.durationRelation.minutes;return o+V*d}return o+(i.total_duration||0)*d},0);return e+n},v=e=>{if(e<60)return`${e} min`;{const n=Math.floor(e/60),o=e%60;return o>0?`${n}h ${o}m`:`${n}h`}},N=(e,n=60)=>{if(!e||e.length<=n)return e;const o=document.createElement("div");o.innerHTML=e;const i=o.textContent||o.innerText||"";return i.length<=n?e:i.substring(0,n).trim()+"..."},Y=(e,n)=>{n.stopPropagation(),D(e),w(!0)},R=()=>{w(!1),D(null)};return t.jsxs("div",{children:[t.jsx(J,{title:"Select Extras - Book Appointment"}),t.jsx(U,{auth:F}),t.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:"24px"},children:[t.jsx("div",{className:"mobile-top-spacing"}),t.jsxs("div",{style:{textAlign:"center",marginBottom:48},children:[t.jsx(K,{variant:"primary",color:"color",background:"white",size:"large"}),t.jsx(g,{level:2,style:{marginTop:24,marginBottom:8},children:"Add Extras (Optional)"}),t.jsx(l,{type:"secondary",style:{fontSize:16},children:"Enhance your experience with additional services"})]}),t.jsxs("div",{style:{marginBottom:32},children:[t.jsx(Z,{percent:40,showInfo:!1,strokeColor:"#1890ff",trailColor:"#f0f0f0"}),t.jsx("div",{style:{textAlign:"center",marginTop:8},children:t.jsx(l,{type:"secondary",children:"Step 2 of 5"})})]}),t.jsxs(z,{gutter:[32,32],children:[t.jsxs(y,{xs:24,lg:16,children:[t.jsxs(S,{style:{marginBottom:24},children:[t.jsx(g,{level:4,style:{marginBottom:16},children:"Selected Service"}),t.jsxs(z,{align:"middle",gutter:16,children:[t.jsx(y,{children:t.jsx("div",{style:{width:60,height:60,backgroundColor:r.color||"#f0f0f0",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:24,fontWeight:"bold"},children:r.name.charAt(0)})}),t.jsxs(y,{flex:"1",children:[t.jsxs(g,{level:5,style:{margin:0},children:[r.name,s&&t.jsx(C,{color:"blue",style:{marginLeft:8,fontSize:10},children:s.name})]}),t.jsxs(B,{size:"large",children:[t.jsx(l,{type:"secondary",children:v(s?s.duration_minutes:r.duration)}),t.jsx(l,{strong:!0,children:x(s?s.price:r.price)})]})]})]})]}),t.jsxs(S,{children:[t.jsx(g,{level:4,style:{marginBottom:16},children:"Available Extras"}),c.length===0?t.jsx(A,{message:"No extras available",description:"There are currently no additional services available for this booking.",type:"info",showIcon:!0}):a.length>=p?t.jsx(A,{message:"Maximum extras reached",description:`You have selected the maximum number of extras (${p}). Please remove some extras to add others.`,type:"warning",showIcon:!0}):t.jsx(z,{gutter:[16,16],children:c.map(e=>{const n=a.find(o=>o.id===e.id);return t.jsx(y,{xs:24,sm:12,children:t.jsx(S,{hoverable:!0,style:{cursor:a.length>=p&&!n?"not-allowed":"pointer",border:n?"2px solid #1890ff":"1px solid #f0f0f0",opacity:a.length>=p&&!n?.6:1,transition:"all 0.3s ease"},onClick:()=>{if(a.length>=p&&!n){_.warning(`You can only select up to ${p} different extras.`);return}I(e)},styles:{body:{padding:16}},children:t.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[t.jsx(P,{checked:n,style:{marginRight:12}}),t.jsxs("div",{style:{flex:1},children:[t.jsx(g,{level:5,style:{margin:0,marginBottom:4},children:e.name}),e.description&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:12,color:"#666"},dangerouslySetInnerHTML:{__html:N(e.description,60)}}),e.description.length>60&&t.jsx(h,{type:"link",size:"small",icon:t.jsx(tt,{}),onClick:o=>Y(e,o),style:{padding:0,height:"auto",fontSize:"10px",color:"#1890ff",marginTop:2},children:"Read More"})]}),t.jsx("div",{style:{marginTop:8},children:t.jsxs(B,{size:"small",children:[e.durationRelation&&t.jsx(C,{size:"small",children:e.durationRelation.label}),t.jsx(C,{size:"small",color:"green",children:x(e.price)})]})})]}),n&&T&&t.jsx("div",{style:{marginLeft:12},children:t.jsxs(B,{children:[t.jsx(h,{size:"small",icon:t.jsx(lt,{}),onClick:o=>{o.stopPropagation();const i=u[e.id]||1;M(e.id,i-1)}}),t.jsx(l,{strong:!0,style:{minWidth:20,textAlign:"center"},children:u[e.id]||1}),t.jsx(h,{size:"small",icon:t.jsx(et,{}),onClick:o=>{o.stopPropagation();const i=u[e.id]||1;M(e.id,i+1)}})]})})]})})},e.id)})})]})]}),t.jsx(y,{xs:24,lg:8,children:t.jsxs(S,{style:{position:"sticky",top:24},children:[t.jsx(g,{level:4,style:{marginBottom:16},children:"Booking Summary"}),t.jsxs("div",{style:{marginBottom:16},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[t.jsxs(l,{strong:!0,children:[r.name,s&&t.jsx(C,{color:"blue",style:{marginLeft:8,fontSize:10},children:s.name})]}),t.jsx(l,{children:x(s?s.price:r.price)})]}),t.jsx(l,{type:"secondary",style:{fontSize:12},children:v(s?s.duration_minutes:r.duration)})]}),a.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(W,{style:{margin:"12px 0"}}),a.map(e=>{const n=u[e.id]||1,o=parseFloat(e.price)*n;return t.jsxs("div",{style:{marginBottom:8},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs(l,{children:["+ ",e.name,n>1&&t.jsxs(l,{type:"secondary",style:{fontSize:12},children:[" ","× ",n]})]}),t.jsx(l,{children:x(o)})]}),t.jsxs(l,{type:"secondary",style:{fontSize:12},children:[e.duration_relation?e.duration_relation.label:"No additional time",n>1&&t.jsxs(l,{type:"secondary",style:{fontSize:12},children:[" ","× ",n]})]})]},e.id)})]}),t.jsx(W,{style:{margin:"16px 0"}}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[t.jsx(l,{strong:!0,children:"Total Price"}),t.jsx(l,{strong:!0,style:{fontSize:16},children:x(q())})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx(l,{type:"secondary",children:"Total Duration"}),t.jsx(l,{type:"secondary",children:v(L())})]}),t.jsxs("div",{style:{marginTop:24},children:[t.jsx(h,{block:!0,style:{marginBottom:12},icon:t.jsx(nt,{}),onClick:H,children:"Back to Services"}),t.jsx(h,{type:"primary",block:!0,size:"large",icon:t.jsx(it,{}),onClick:O,children:"Continue to Date & Time"})]})]})})]})]}),t.jsx(ot,{title:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx("div",{style:{width:40,height:40,borderRadius:"8px",background:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:18,fontWeight:"bold"},children:m?.name?.charAt(0)}),t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#1f1f1f"},children:m?.name}),t.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:2},children:"Extra Service Details"})]})]}),open:Q,onCancel:R,footer:[t.jsx(h,{onClick:R,children:"Close"},"close"),t.jsx(h,{type:"primary",onClick:()=>{I(m),R()},children:"Add This Extra"},"select")],width:500,centered:!0,children:m&&t.jsxs("div",{style:{padding:"16px 0"},children:[m.description&&t.jsxs("div",{style:{marginBottom:20},children:[t.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#1f1f1f",marginBottom:8},children:"Description"}),t.jsx("div",{style:{fontSize:"14px",lineHeight:1.5,color:"#666"},dangerouslySetInnerHTML:{__html:m.description}})]}),t.jsxs("div",{style:{marginBottom:20},children:[t.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#1f1f1f",marginBottom:12},children:"Service Information"}),t.jsxs(z,{gutter:16,children:[t.jsx(y,{span:12,children:t.jsxs("div",{style:{padding:"12px",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #e8e8e8"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[t.jsx(ClockCircleOutlined,{style:{color:"#1890ff",fontSize:14}}),t.jsx("span",{style:{fontSize:"11px",color:"#999"},children:"Duration"})]}),t.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#1f1f1f"},children:m.duration_relation?m.duration_relation.label:"No additional time"})]})}),t.jsx(y,{span:12,children:t.jsxs("div",{style:{padding:"12px",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #e8e8e8"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[t.jsx("span",{style:{color:"#52c41a",fontSize:14,fontWeight:"bold"},children:"₹"}),t.jsx("span",{style:{fontSize:"11px",color:"#999"},children:"Regular"})]}),t.jsx("div",{style:{fontSize:"14px",fontWeight:600,color:"#1f1f1f"},children:x(m.price)})]})})]})]}),t.jsxs("div",{style:{padding:"12px",background:"#f0f8ff",borderRadius:"6px",border:"1px solid #bae7ff"},children:[t.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#1890ff",marginBottom:4},children:"Quantity Limit"}),t.jsxs("div",{style:{fontSize:"12px",lineHeight:1.4,color:"#666"},children:["You can add up to"," ",m.max_quantity||5," of this extra service to your booking."]})]})]})})]})}export{Nt as default};
