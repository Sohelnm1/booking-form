import{r as m,j as e,H,a as g}from"./app-CJqx2nlw.js";import{A as Y,R as _}from"./AdminLayout-4UMouIZI.js";import{F as c}from"./index-BkNtq0EW.js";import{T as N,B as h,C as J}from"./Logo-BxrHS6GJ.js";import{F as K}from"./Table-BTQPa3Mr.js";import{M as R}from"./index-Be8JAZRx.js";import{R as I,C as u}from"./row-BB7zYcZo.js";import{I as D}from"./index-B2sDrt4R.js";import{S as F}from"./index-BEVLC0fB.js";import{T as x}from"./index-CV9a0vwC.js";import{T as W}from"./index-CQbaq4it.js";import{U as X,R as Z}from"./InboxOutlined-B5xzLGNq.js";import{S as ee}from"./index-BNuMtJjR.js";import{I as te}from"./index-Gm9PXX7v.js";import{S as ie}from"./index-as06zxLB.js";import{R as se}from"./EyeOutlined-CmYqSlXx.js";import{R as oe}from"./EditOutlined-s3Thlk9X.js";import{R as re}from"./DeleteOutlined-DKnWcR_p.js";import{s as d}from"./index-C302MrZq.js";/* empty css            */import"./index-Bd_PfEaH.js";import"./index-DWAqtCPW.js";import"./PurePanel-Db2cDM3B.js";import"./pickAttrs-Oxm3QeZq.js";import"./move-B1raSf7m.js";import"./LogoutOutlined-DaqdC0QT.js";import"./CalendarOutlined-B_C58u2P.js";import"./UserOutlined-LBaZxvD8.js";import"./ClockCircleOutlined-BkYPCbn9.js";import"./FileTextOutlined-LpUW-RpF.js";import"./GiftOutlined-Cqb3iW8w.js";import"./SettingOutlined-DadYMtaq.js";import"./useForm-BiSx87GW.js";import"./CheckCircleFilled-As6OzaIf.js";import"./InfoCircleFilled-C2YIh8OJ.js";import"./addEventListener-HUtlaoVL.js";import"./index-Cn4Gi7e7.js";import"./index-CRPSkqIR.js";import"./index-DiKTrVqn.js";import"./index-CKTeyKnI.js";import"./Input-CO2vg1SB.js";import"./index-BSbgTexK.js";import"./EyeOutlined-Bp5OE_RV.js";import"./EyeOutlined-Bmd706kk.js";import"./DownloadOutlined-DTidZHln.js";import"./progress-Dt23xBl_.js";const{Title:le,Text:A}=N,{TextArea:ae}=D,{Option:B}=F;function et({auth:M,services:Q,categories:P,durations:k,errors:f,editService:j}){const[v,p]=m.useState(!1),[l,E]=m.useState(null),[r]=c.useForm(),[O,y]=m.useState(!1),[w,S]=m.useState(null),b=Q||[],U=P||[],C=k||[];m.useEffect(()=>{f&&Object.keys(f).length>0&&(Object.keys(f).forEach(t=>{r.setFields([{name:t,errors:[f[t]]}])}),p(!0))},[f,r]),m.useEffect(()=>{if(v)if(l){const t={name:l.name,description:l.description||"",price:parseFloat(l.price)||0,duration:parseInt(l.duration)||60,category:l.category||"Default",color:l.color||"#1890ff",is_active:l.is_active!==void 0?l.is_active:!0};setTimeout(()=>{r.setFieldsValue(t),console.log("Form values set via useEffect for editing:",t)},100)}else setTimeout(()=>{r.setFieldsValue({is_active:!0,color:"#1890ff",category:"Default",duration:60,description:""}),console.log("Default form values set via useEffect for adding")},100)},[v,l,r]),m.useEffect(()=>{if(j){const t=b.find(s=>s.id==j);t&&T(t)}},[j,b]);const V=[{title:"Image",dataIndex:"image",key:"image",render:(t,s)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(te,{width:40,height:40,src:t||`https://placehold.co/40x40/${s.color?.replace("#","")||"1890ff"}/ffffff?text=${s.name?.charAt(0)?.toUpperCase()||"S"}`,alt:s.name,style:{borderRadius:4},fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3Ik1RnG4W+FgYxN"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:s.name}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:s.category})]})]})},{title:"Category",dataIndex:"category",key:"category",render:t=>e.jsx(x,{color:"blue",children:t})},{title:"Price",dataIndex:"price",key:"price",render:t=>`â‚¹${t}`},{title:"Duration",dataIndex:"duration",key:"duration",render:t=>{const s=C.find(o=>o.value===t);return s?s.label:`${t} min`}},{title:"Employees",dataIndex:"employees",key:"employees",render:()=>e.jsx("div",{style:{opacity:.5},children:e.jsx(x,{color:"orange",size:"small",children:"Coming Soon"})})},{title:"Status",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(x,{color:t?"green":"red",children:t?"Active":"Inactive"})},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(ie,{children:[e.jsx(h,{type:"text",icon:e.jsx(se,{}),size:"small",onClick:()=>q(s)}),e.jsx(h,{type:"text",icon:e.jsx(oe,{}),size:"small",onClick:()=>T(s)}),e.jsx(h,{type:"text",icon:e.jsx(re,{}),size:"small",danger:!0,loading:w===s.id,disabled:w===s.id,onClick:()=>z(s)})]})}],L=()=>{E(null),r.resetFields(),r.setFields([]),p(!0)},T=t=>{E(t),r.setFields([]),r.resetFields(),console.log("Service data for editing:",t),p(!0)},q=t=>{g.visit(route("admin.services.show",t.id))},z=t=>{R.confirm({title:"Delete Service",content:e.jsxs("div",{children:[e.jsxs("p",{children:["Are you sure you want to delete"," ",e.jsxs("strong",{children:['"',t.name,'"']}),"?"]}),e.jsxs("p",{style:{color:"#ff4d4f",fontSize:"14px",marginTop:8},children:[e.jsx("strong",{children:"Warning:"})," This action cannot be undone and will permanently remove:"]}),e.jsxs("ul",{style:{color:"#666",fontSize:"14px",marginTop:4},children:[e.jsx("li",{children:"The service and all its data"}),e.jsx("li",{children:"Any associated bookings (if they exist)"}),e.jsx("li",{children:"Service images and files"})]})]}),okText:"Delete Service",okType:"danger",cancelText:"Cancel",width:500,onOk(){S(t.id),d.loading({content:"Deleting service...",key:"deleteService"}),console.log("Attempting to delete service:",t.id),console.log("Delete route:",route("admin.services.delete",t.id)),g.post(route("admin.services.delete",t.id),{onSuccess:()=>{console.log("Service deleted successfully"),d.success({content:`Service "${t.name}" deleted successfully`,key:"deleteService",duration:3}),S(null),g.visit(route("admin.services"),{replace:!0,preserveScroll:!1})},onError:s=>{console.error("Delete service errors:",s),d.error({content:"Failed to delete service. Please try again.",key:"deleteService",duration:5}),S(null)},onFinish:()=>{console.log("Delete request finished")}})}})},$=()=>{const t=r.getFieldsValue();console.log("Current form values before validation:",t);const s=r.getFieldValue("description");console.log("Description field value:",s),r.validateFields().then(o=>{y(!0),console.log("Form validation passed, values:",o);const n=new FormData;console.log("Form values:",o),Object.keys(o).forEach(i=>{if(console.log(`Processing field ${i}:`,o[i]),i!=="employees")if(i==="image"&&o[i]?.fileList?.[0]?.originFileObj)n.append("image",o[i].fileList[0].originFileObj);else if(i==="color")n.append("color",o[i]||"#1890ff");else if(i==="price"){const a=parseFloat(o[i])||0;n.append(i,a),console.log("Price value:",a)}else if(i==="duration"){const a=parseInt(o[i])||0;n.append(i,a),console.log("Duration value:",a)}else i==="is_active"?(n.append(i,o[i]?"1":"0"),console.log("is_active value:",o[i]?"1":"0")):i==="description"?(n.append(i,o[i]||""),console.log("Description value:",o[i]||"")):(n.append(i,o[i]||""),console.log(`${i} value:`,o[i]||""))}),console.log("=== FormData being sent to backend ===");for(let[i,a]of n.entries())console.log(`${i}:`,a);console.log("=== End FormData ==="),l?(n.append("_method","PUT"),g.post(route("admin.services.update",l.id),n,{onSuccess:()=>{d.success("Service updated successfully"),p(!1),r.resetFields()},onError:i=>{console.error("Update service errors:",i),i&&Object.keys(i).forEach(a=>{r.setFields([{name:a,errors:[i[a]]}])}),d.error("Failed to update service")},onFinish:()=>{y(!1)}})):g.post(route("admin.services.store"),n,{onSuccess:()=>{d.success("Service created successfully"),p(!1),r.resetFields()},onError:i=>{console.error("Create service errors:",i),i&&Object.keys(i).forEach(a=>{r.setFields([{name:a,errors:[i[a]]}])}),d.error("Failed to create service")},onFinish:()=>{y(!1)}})}).catch(o=>{console.error("Form validation failed:",o),d.error("Please check the form and try again")})},G=()=>{p(!1),r.resetFields()};return e.jsxs(Y,{auth:M,children:[e.jsx(H,{title:"Services Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx(le,{level:2,style:{marginBottom:8},children:"Services"}),e.jsx(A,{type:"secondary",children:"Create and manage your services for customer bookings"})]}),e.jsx(h,{type:"primary",icon:e.jsx(_,{}),size:"large",onClick:L,children:"Create Service"})]}),e.jsx(J,{children:e.jsx(K,{columns:V,dataSource:b,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} of ${t} services`}})}),e.jsx(R,{title:l?"Edit Service":"Create Service",open:v,onOk:$,onCancel:G,width:800,okText:l?"Update":"Add Service",confirmLoading:O,children:e.jsxs(c,{form:r,layout:"vertical",children:[e.jsxs(I,{gutter:16,children:[e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"name",label:"Service name*",rules:[{required:!0,message:"Please enter service name",whitespace:!0}],children:e.jsx(D,{placeholder:"Enter name"})})}),e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"color",label:"Color",children:e.jsx(D,{type:"color",style:{width:"100%",height:"40px"}})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"category",label:"Category*",rules:[{required:!0,message:"Please select category"}],children:e.jsx(F,{placeholder:"Select category",children:U.map((t,s)=>e.jsx(B,{value:t,children:t},s))})})}),e.jsx(u,{span:12,children:e.jsx(c.Item,{label:"Employees",children:e.jsx("div",{style:{padding:"8px 12px",border:"1px solid #d9d9d9",borderRadius:"6px",backgroundColor:"#f5f5f5",color:"#999",cursor:"not-allowed"},children:e.jsxs(A,{type:"secondary",children:[e.jsx(x,{color:"orange",children:"Coming Soon"})," ","Employee assignment will be available soon"]})})})})]}),e.jsx(c.Item,{name:"description",label:"Description",children:e.jsx(ae,{rows:4,placeholder:"Insert text here ...",style:{minHeight:100}})}),e.jsx(A,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:"Descriptions appear on your booking page."}),e.jsxs(I,{gutter:16,children:[e.jsxs(u,{span:12,children:[e.jsx(c.Item,{name:"duration",label:"Duration*",rules:[{required:!0,message:"Please select duration"}],children:e.jsx(F,{placeholder:"Select duration",children:C.map(t=>e.jsx(B,{value:t.value,children:t.label},t.value))})}),e.jsxs(A,{type:"secondary",style:{fontSize:"12px",marginTop:4},children:["If you need a different duration that isn't among the displayed ones, please visit our"," ",e.jsx("a",{href:"#",style:{color:"#1890ff"},children:"General Settings"})," ","and change Default Time Slot Step."]})]}),e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"price",label:"Price*",rules:[{required:!0,message:"Please enter price"},{type:"number",min:0,message:"Price must be a positive number"}],children:e.jsx(W,{style:{width:"100%"},placeholder:"0.00",min:0,step:.01,formatter:t=>`â‚¹ ${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/â‚¹\s?|(,*)/g,"")})})})]}),e.jsx(c.Item,{name:"image",label:"Service image",children:e.jsxs(X.Dragger,{name:"file",multiple:!1,beforeUpload:()=>!1,showUploadList:!0,accept:"image/*",maxCount:1,fileList:[],children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(Z,{})}),e.jsx("p",{className:"ant-upload-text",children:"Drag and drop or choose from files"})]})}),e.jsx(c.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:e.jsx(ee,{})})]})})]})]})}export{et as default};
