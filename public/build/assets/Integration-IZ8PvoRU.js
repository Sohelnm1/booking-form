import{r as h,j as e,H as O}from"./app-CTnpJe6s.js";import{A as F,c as g}from"./AdminLayout-CQY0PddB.js";import{F as t}from"./index-D_7Mj0Ta.js";import{I as E,T as M,C as q,B as I}from"./Logo-Biljuc-Y.js";import{A as B}from"./index-DLJhyXqo.js";import{R as N,C as V}from"./row-DcqefiXp.js";import{S as w}from"./CalendarOutlined-BM3-G7F1.js";import{T as $}from"./index-AXm3g50X.js";import{R as L}from"./EditOutlined-Bx_mX-hc.js";import{S as v}from"./index-Cypur1WL.js";import{M as H}from"./index-D4ViXHP2.js";import{I as a}from"./index-DMq3Xvyi.js";import{S as p}from"./index-ChBeB8qW.js";import{R as K}from"./CloseCircleOutlined-Cxr6gFfg.js";import{R as D}from"./CheckCircleOutlined-B0hAjlLK.js";import{s as c}from"./index-CtW8XKZp.js";/* empty css            */import"./index-Ca_16It4.js";import"./PurePanel-DoOMq_kn.js";import"./move-M8L2ISRZ.js";import"./LogoutOutlined-DMJJUOr0.js";import"./UserOutlined-D2rDMwbZ.js";import"./ClockCircleOutlined-CGmtAK_w.js";import"./FileTextOutlined-B0sPJ-VI.js";import"./GiftOutlined-BtTa7HJg.js";import"./SettingOutlined-099kgk59.js";import"./useForm-66eOu3XW.js";import"./CheckCircleFilled-D9BfS9XO.js";import"./InfoCircleFilled-Da70DYLE.js";import"./pickAttrs-BUARLshW.js";import"./useClosable-C0XzdfFj.js";import"./Input-DfhxBwA6.js";import"./EyeOutlined-BLbdxot3.js";import"./index-B4prJx6-.js";var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};function y(){return y=Object.assign?Object.assign.bind():function(d){for(var i=1;i<arguments.length;i++){var m=arguments[i];for(var l in m)Object.prototype.hasOwnProperty.call(m,l)&&(d[l]=m[l])}return d},y.apply(this,arguments)}const U=(d,i)=>h.createElement(E,y({},d,{ref:i,icon:G})),J=h.forwardRef(U),{Title:X,Text:n,Paragraph:Y}=M,{TextArea:Re}=a;function ze({auth:d,integrations:i=[]}){const[m,l]=h.useState(!1),[x,S]=h.useState(null),[f,j]=h.useState(!1),[u]=t.useForm(),b=s=>{switch(s){case"active":return"green";case"inactive":return"red";case"pending":return"orange";default:return"default"}},P=s=>{switch(s){case"active":return e.jsx(D,{style:{color:"#52c41a"}});case"inactive":return e.jsx(K,{style:{color:"#ff4d4f"}});case"pending":return e.jsx(g,{style:{color:"#faad14"}});default:return e.jsx(g,{})}},k=s=>{S(s);const r={integration_id:s.id,name:s.name,description:s.description,is_enabled:s.is_enabled};s.settings&&Object.keys(s.settings).forEach(o=>{r[o]=s.settings[o]}),u.setFieldsValue(r),l(!0)},T=async()=>{try{j(!0);const s=await u.validateFields(),r={},o=s.integration_id;switch(o){case"razorpay":r.razorpay_key=s.razorpay_key||"",r.razorpay_secret=s.razorpay_secret||"",r.currency=s.currency||"INR";break;case"sms":r.twilio_sid=s.twilio_sid||"",r.twilio_token=s.twilio_token||"",r.twilio_phone=s.twilio_phone||"";break;case"email":r.sendgrid_key=s.sendgrid_key||"",r.sendgrid_from_email=s.sendgrid_from_email||"",r.sendgrid_from_name=s.sendgrid_from_name||"";break}const _=await fetch(route("admin.integration.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({integration_id:o,settings:r})}),z=await _.json();_.ok?(c.success("Integration settings updated successfully"),l(!1),u.resetFields(),window.location.reload()):c.error(z.error||"Failed to update integration settings")}catch(s){console.error("Error updating integration:",s),c.error("Failed to update integration settings")}finally{j(!1)}},C=()=>{l(!1),u.resetFields()},A=s=>{c.success(`${s.name} ${s.is_enabled?"disabled":"enabled"} successfully`)},R=async s=>{try{j(!0);const r=await fetch(route("admin.integration.test"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({integration_id:s.id})}),o=await r.json();r.ok?c.success(o.success||"Connection test successful"):c.error(o.error||"Connection test failed")}catch(r){console.error("Error testing connection:",r),c.error("Failed to test connection")}finally{j(!1)}};return e.jsxs(F,{auth:d,children:[e.jsx(O,{title:"Integration Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(X,{level:2,style:{marginBottom:8},children:"Integration Management"}),e.jsx(n,{type:"secondary",children:"Manage third-party integrations and API connections"})]}),e.jsx(B,{message:"Integration Status",description:"All integrations are working properly. Last health check: 2 minutes ago",type:"success",showIcon:!0,style:{marginBottom:24}}),e.jsx(N,{gutter:[24,24],children:i.map(s=>e.jsx(V,{xs:24,md:12,lg:8,children:e.jsxs(q,{title:e.jsxs(w,{children:[P(s.status),s.name]}),extra:e.jsx(v,{checked:s.is_enabled,onChange:()=>A(s),size:"small"}),actions:[e.jsx(I,{type:"text",icon:e.jsx(L,{}),onClick:()=>k(s),children:"Configure"}),e.jsx(I,{type:"text",icon:e.jsx(g,{}),onClick:()=>R(s),loading:f,children:"Test"})],children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(Y,{type:"secondary",children:s.description})}),e.jsxs(w,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(n,{strong:!0,children:"Status: "}),e.jsx($,{color:b(s.status),children:s.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(n,{strong:!0,children:"API Key: "}),e.jsx(n,{code:!0,children:s.api_key})]}),s.id==="razorpay"&&s.settings?.currency&&e.jsxs("div",{children:[e.jsx(n,{strong:!0,children:"Currency: "}),e.jsx(n,{code:!0,children:s.settings.currency})]}),s.id==="sms"&&s.settings?.twilio_phone&&e.jsxs("div",{children:[e.jsx(n,{strong:!0,children:"Phone: "}),e.jsx(n,{code:!0,children:s.settings.twilio_phone})]}),s.id==="email"&&s.settings?.sendgrid_from_email&&e.jsxs("div",{children:[e.jsx(n,{strong:!0,children:"From Email: "}),e.jsx(n,{code:!0,style:{fontSize:"12px"},children:s.settings.sendgrid_from_email})]}),s.last_sync&&e.jsxs("div",{children:[e.jsx(n,{strong:!0,children:"Last Sync: "}),e.jsx(n,{type:"secondary",children:s.last_sync})]})]})]})},s.id))}),e.jsx(H,{title:`Configure ${x?.name}`,open:m,onOk:T,onCancel:C,width:600,okText:"Save Changes",okIcon:e.jsx(J,{}),confirmLoading:f,children:e.jsxs(t,{form:u,layout:"vertical",children:[e.jsx(t.Item,{name:"integration_id",hidden:!0,children:e.jsx(a,{})}),x?.id==="razorpay"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"razorpay_key",label:"Razorpay API Key",rules:[{required:!0,message:"Please enter Razorpay API key"}],children:e.jsx(a.Password,{placeholder:"rzp_test_..."})}),e.jsx(t.Item,{name:"razorpay_secret",label:"Razorpay API Secret",rules:[{required:!0,message:"Please enter Razorpay API secret"}],children:e.jsx(a.Password,{placeholder:"Enter API secret"})}),e.jsx(t.Item,{name:"currency",label:"Currency",rules:[{required:!0,message:"Please select currency"}],children:e.jsxs(p,{placeholder:"Select currency",children:[e.jsx(p.Option,{value:"INR",children:"Indian Rupee (₹)"}),e.jsx(p.Option,{value:"USD",children:"US Dollar ($)"}),e.jsx(p.Option,{value:"EUR",children:"Euro (€)"}),e.jsx(p.Option,{value:"GBP",children:"British Pound (£)"})]})})]}),x?.id==="sms"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"twilio_sid",label:"Twilio Account SID",rules:[{required:!0,message:"Please enter Twilio Account SID"}],children:e.jsx(a,{placeholder:"AC..."})}),e.jsx(t.Item,{name:"twilio_token",label:"Twilio Auth Token",rules:[{required:!0,message:"Please enter Twilio Auth Token"}],children:e.jsx(a.Password,{placeholder:"Enter auth token"})}),e.jsx(t.Item,{name:"twilio_phone",label:"Twilio Phone Number",rules:[{required:!0,message:"Please enter Twilio phone number"}],children:e.jsx(a,{placeholder:"+1234567890"})})]}),x?.id==="email"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"sendgrid_key",label:"SendGrid API Key",rules:[{required:!0,message:"Please enter SendGrid API key"}],children:e.jsx(a.Password,{placeholder:"SG..."})}),e.jsx(t.Item,{name:"sendgrid_from_email",label:"From Email",rules:[{required:!0,message:"Please enter from email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(a,{placeholder:"noreply@yourdomain.com"})}),e.jsx(t.Item,{name:"sendgrid_from_name",label:"From Name",rules:[{required:!0,message:"Please enter from name"}],children:e.jsx(a,{placeholder:"Your Business Name"})})]}),e.jsx(t.Item,{name:"is_enabled",label:"Enable Integration",valuePropName:"checked",children:e.jsx(v,{})})]})})]})]})}export{ze as default};
