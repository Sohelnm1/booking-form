import{r as g,j as e,H as U,a as $}from"./app-DEDll9AR.js";import{d as p}from"./dayjs.min-oV3UgmnJ.js";import{A as V}from"./AppLayout-BW54P4GE.js";import{aq as X,T as Z,R as H,a as k,C as D,B as u}from"./Logo-B-N0zWbR.js";import{P as ee}from"./progress-BAMSSaSx.js";import{R as te}from"./CalendarOutlined-D-mS0-JV.js";import{R as se}from"./ClockCircleOutlined-CXxhKNjU.js";import{S as re}from"./index-bm3QRPu0.js";import{E as P}from"./index-bloQYPn8.js";import{R as ne}from"./CheckOutlined-BZkwwdRW.js";import{D as B}from"./index-DBRdJP7-.js";import{R as oe}from"./ArrowLeftOutlined-BAMREewH.js";import{R as ae}from"./ArrowRightOutlined-BWb0wWij.js";/* empty css            */import"./CheckCircleFilled-z0b-rEXZ.js";const{Title:b,Text:n}=Z;function Ce({service:i,selectedExtras:x,scheduleSettings:ie}){const[o,E]=g.useState(null),[l,M]=g.useState(null),[w,R]=g.useState([]),[F,Y]=g.useState(!1),[h,A]=g.useState(p()),L=i.duration+x.reduce((t,s)=>t+(s.duration||0),0),W=()=>{const t=x.map(s=>s.id);$.visit(route("booking.select-extras"),{data:{service_id:i.id,extras:t}})},_=()=>{if(o&&l){const t=x.map(s=>s.id);$.visit(route("booking.consent"),{data:{service_id:i.id,extras:t,date:o.format("YYYY-MM-DD"),time:l.format("HH:mm")}})}},N=async t=>{Y(!0);try{const r=await(await fetch(`${route("booking.available-slots")}?date=${t.format("YYYY-MM-DD")}&service_id=${i.id}`)).json();console.log("Available slots response:",r),R(r.slots||[])}catch(s){console.error("Error fetching slots:",s),R([{start:"09:00",end:"09:30",available:!0},{start:"09:30",end:"10:00",available:!0},{start:"10:00",end:"10:30",available:!0},{start:"10:30",end:"11:00",available:!0},{start:"11:00",end:"11:30",available:!0},{start:"11:30",end:"12:00",available:!0},{start:"14:00",end:"14:30",available:!0},{start:"14:30",end:"15:00",available:!0},{start:"15:00",end:"15:30",available:!0},{start:"15:30",end:"16:00",available:!0},{start:"16:00",end:"16:30",available:!0},{start:"16:30",end:"17:00",available:!0}])}finally{Y(!1)}},O=t=>{E(t),M(null),N(t)},q=t=>{M(t)},v=t=>`₹${parseFloat(t).toFixed(2)}`,I=t=>{if(t<60)return`${t} min`;{const s=Math.floor(t/60),r=t%60;return r>0?`${s}h ${r}m`:`${s}h`}},z=t=>p(t,"HH:mm").format("h:mm A"),G=t=>{const s=t.year(),r=t.month(),a=p(new Date(s,r,1)),c=p(new Date(s,r+1,0)),y=a.startOf("week"),j=c.endOf("week"),d=[];let m=y;for(;m.isBefore(j)||m.isSame(j,"day");)d.push(m),m=m.add(1,"day");return d},J=()=>{A(h.subtract(1,"month"))},K=()=>{A(h.add(1,"month"))},Q=t=>{const s=p();return t.isAfter(s.subtract(1,"day"))&&t.isBefore(s.add(31,"day"))};return e.jsxs(V,{children:[e.jsx(U,{title:"Select Date & Time - Book Appointment"}),e.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:"24px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:48},children:[e.jsx(X,{variant:"primary",color:"color",background:"white",size:"large"}),e.jsx(b,{level:2,style:{marginTop:24,marginBottom:8},children:"Choose Date & Time"}),e.jsx(n,{type:"secondary",style:{fontSize:16},children:"Select your preferred appointment date and time"})]}),e.jsxs("div",{style:{marginBottom:32},children:[e.jsx(ee,{percent:60,showInfo:!1,strokeColor:"#1890ff",trailColor:"#f0f0f0"}),e.jsx("div",{style:{textAlign:"center",marginTop:8},children:e.jsx(n,{type:"secondary",children:"Step 3 of 5"})})]}),e.jsxs(H,{gutter:[32,32],children:[e.jsxs(k,{xs:24,lg:16,children:[e.jsxs(D,{style:{marginBottom:24},children:[e.jsxs(b,{level:4,style:{marginBottom:16},children:[e.jsx(te,{style:{marginRight:8}}),"Select Date"]}),e.jsxs("div",{style:{border:"1px solid #f0f0f0",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",background:"white"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f0f0f0",background:"#fafafa",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(u,{size:"small",onClick:J,style:{border:"none",boxShadow:"none"},children:"‹"}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"600",minWidth:"120px",textAlign:"center"},children:h.format("MMMM YYYY")}),e.jsx(u,{size:"small",onClick:K,style:{border:"none",boxShadow:"none"},children:"›"})]}),e.jsxs("div",{style:{padding:"16px"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px",marginBottom:"8px"},children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(t=>e.jsx("div",{style:{textAlign:"center",fontWeight:"600",color:"#666",padding:"8px 4px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:t},t))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px"},children:G(h).map((t,s)=>{const r=p(),a=t.isBefore(r,"day"),c=t.isSame(r,"day"),y=o&&o.isSame(t,"day"),j=t.month()===h.month(),d=Q(t),m={height:"48px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",cursor:d&&!a?"pointer":"default",transition:"all 0.2s ease",fontSize:"14px",fontWeight:"500",opacity:j?1:.3};let S="transparent",f="#333",C="1px solid transparent";return a?f="#999":y?(S="#e6f7ff",f="#1890ff",C="2px solid #1890ff"):c&&!o?(S="#1890ff",f="white",C="none"):d?f="#333":f="#999",e.jsx("div",{style:{...m,backgroundColor:S,color:f,border:C},onMouseEnter:T=>{d&&!a&&!y&&(T.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:T=>{d&&!a&&!y&&(T.currentTarget.style.backgroundColor="transparent")},onClick:()=>{d&&!a&&O(t)},children:t.date()},s)})})]})]})]}),o&&e.jsxs(D,{children:[e.jsxs(b,{level:4,style:{marginBottom:16},children:[e.jsx(se,{style:{marginRight:8}}),"Available Time Slots"]}),F?e.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[e.jsx(re,{size:"large"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(n,{type:"secondary",children:"Loading available slots..."})})]}):w.length===0?e.jsx(P,{description:"No available slots for this date",image:P.PRESENTED_IMAGE_SIMPLE}):e.jsx(H,{gutter:[12,12],children:w.map((t,s)=>{const r=typeof t=="object"?t.start:t,a=p(r,"HH:mm"),c=l&&l.format("HH:mm")===r;return e.jsx(k,{xs:12,sm:8,md:6,children:e.jsx(u,{size:"large",style:{width:"100%",height:48,border:c?"2px solid #1890ff":"1px solid #d9d9d9",backgroundColor:c?"#e6f7ff":"white"},onClick:()=>q(a),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[c&&e.jsx(ne,{style:{marginRight:8,color:"#1890ff"}}),z(r)]})})},s)})})]})]}),e.jsx(k,{xs:24,lg:8,children:e.jsxs(D,{style:{position:"sticky",top:24},children:[e.jsx(b,{level:4,style:{marginBottom:16},children:"Booking Summary"}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(n,{strong:!0,children:i.name}),e.jsx(n,{children:v(i.price)})]}),e.jsx(n,{type:"secondary",style:{fontSize:12},children:I(i.duration)})]}),x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(B,{style:{margin:"12px 0"}}),x.map(t=>e.jsx("div",{style:{marginBottom:8},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(n,{children:["+ ",t.name]}),e.jsx(n,{children:v(t.price)})]})},t.id))]}),e.jsx(B,{style:{margin:"16px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(n,{strong:!0,children:"Total Price"}),e.jsx(n,{strong:!0,style:{fontSize:16},children:v(parseFloat(i.price)+x.reduce((t,s)=>t+parseFloat(s.price),0))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(n,{type:"secondary",children:"Total Duration"}),e.jsx(n,{type:"secondary",children:I(L)})]}),(o||l)&&e.jsxs(e.Fragment,{children:[e.jsx(B,{style:{margin:"16px 0"}}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(n,{type:"secondary",children:"Selected Date"}),e.jsx("div",{children:e.jsx(n,{strong:!0,children:o?o.format("dddd, MMMM D, YYYY"):"Not selected"})})]}),e.jsxs("div",{children:[e.jsx(n,{type:"secondary",children:"Selected Time"}),e.jsx("div",{children:e.jsx(n,{strong:!0,children:l?z(l):"Not selected"})})]})]}),e.jsxs("div",{style:{marginTop:24},children:[e.jsx(u,{block:!0,style:{marginBottom:12},icon:e.jsx(oe,{}),onClick:W,children:"Back to Extras"}),e.jsx(u,{type:"primary",block:!0,size:"large",icon:e.jsx(ae,{}),onClick:_,disabled:!o||!l,children:"Continue to Consent"})]})]})})]})]})]})}export{Ce as default};
