import{r as R,j as e,a as O,H as we}from"./app-Dc3E6YUy.js";import{C as g,T as de,B as _,a9 as Se,aa as Re}from"./Logo-DIQwnbFb.js";import{d as x}from"./dayjs.min-CQ5yEmMz.js";import{F as Te}from"./index-BUxGZeJ5.js";import{s as v}from"./index-DplzFmUW.js";import{M as Ce}from"./index-BCUHYXpE.js";import{R as Be}from"./InfoCircleOutlined-B00QmKoc.js";import{R as L,C as h}from"./row-BqfE-STe.js";import{S as se}from"./index-2HCXdEo0.js";import{T as P}from"./index-jtJX4whC.js";import{A as re}from"./index-Bjn7WmCu.js";import{R as me}from"./CalendarOutlined-Bj7enq6S.js";import{R as Ie}from"./ClockCircleOutlined-D4kMoH8T.js";import{E as ne}from"./index-B9shY4rF.js";import{R as Me}from"./CheckOutlined-CBngiieA.js";import{C as De}from"./CancelModal-Dkt_Qkw1.js";import{L as he}from"./index-BBcNZ_eN.js";import{S as V}from"./index-Dbb0M_WJ.js";import{A as Pe,R as Ae}from"./LogoutOutlined-t541zWvm.js";import{R as Ye}from"./ArrowLeftOutlined-CR3CBH9q.js";import{R as ze,a as Fe}from"./PrinterOutlined-ujvCnlza.js";import{D as $e}from"./index-Cx2EURi-.js";import{R as ie}from"./ExclamationCircleOutlined-3T-V8dWD.js";import{R as le}from"./CloseCircleOutlined-B0_oXYFE.js";import{R as ce}from"./CheckCircleOutlined-BSjIb59p.js";import{R as Ee}from"./BookOutlined-BbL6ZE9L.js";/* empty css            */import"./useForm-taQvzu2c.js";import"./CheckCircleFilled-D7RMkPYG.js";import"./InfoCircleFilled-y1gPlI4k.js";import"./pickAttrs-Do-YelpT.js";import"./useClosable-DFJx6fP2.js";import"./extendsObject-78o_rR5W.js";import"./PurePanel-XOMY9fLy.js";import"./index-CjnswWD_.js";import"./Input-BfvUZntP.js";import"./EyeOutlined-pclkUY3n.js";import"./EyeOutlined-Bmd706kk.js";import"./DownloadOutlined-DTidZHln.js";const{Title:ae,Text:j}=de;function Le({visible:A,onCancel:t,onSuccess:q,booking:r,scheduleSettings:Y=[]}){const[z]=Te.useForm(),[S,F]=R.useState(null),[I,$]=R.useState(null),[U,M]=R.useState([]),[G,T]=R.useState(!1),[K,C]=R.useState(!1),[E,W]=R.useState(x()),[o,X]=R.useState(null);console.log("RescheduleModal component - Schedule settings:",{scheduleSettings:Y,scheduleSettingsLength:Y?.length,firstSchedule:Y?.[0]});const c=(r.pricingTier?.duration_minutes||r.service.duration)+(r.extras?r.extras.reduce((s,i)=>{if(i.durationRelation){const l=i.durationRelation.hours*60+i.durationRelation.minutes;return s+l}return s+(i.total_duration||0)},0):0);R.useEffect(()=>{if(A&&r){p();const s=x(r.appointment_time);F(s),W(s),f(s)}},[A,r]);const p=async()=>{if(r){C(!0);try{const i=await(await fetch(route("customer.bookings.policy",r.id))).json();i.success?X(i.data.policy):console.error("Failed to fetch policy info:",i.message)}catch(s){console.error("Error fetching policy info:",s)}finally{C(!1)}}},f=async s=>{if(!(!s||!r)){T(!0);try{const i=new URLSearchParams({date:s.format("YYYY-MM-DD"),service_id:r.service_id,exclude_booking_id:r.id});r.pricingTier&&(i.append("pricing_tier_id",r.pricingTier.id),i.append("selected_duration",r.pricingTier.duration_minutes),i.append("selected_price",r.pricingTier.price)),r.extras&&r.extras.length>0&&r.extras.forEach(d=>{i.append("extras[]",d.id)}),r.gender_preference&&i.append("gender_preference",r.gender_preference),console.log("Reschedule modal - Request params:",i.toString()),console.log("Reschedule modal - Gender preference:",r.gender_preference),console.log("Reschedule modal - Gender preference being sent:",r.gender_preference||"not set"),console.log("Reschedule modal - Booking data:",{bookingId:r.id,serviceId:r.service_id,pricingTier:r.pricingTier,pricingTierId:r.pricingTier?.id,pricingTierDuration:r.pricingTier?.duration_minutes,serviceDuration:r.service.duration,totalDuration:c,extras:r.extras});const a=await(await fetch(`${route("booking.available-slots")}?${i.toString()}`)).json();if(console.log("Reschedule modal - API response:",a),a.slots){console.log("Reschedule modal - Available slots:",a.slots);const d=x(r.appointment_time),u=a.slots.filter(w=>!x(S).hour(parseInt(w.start.split(":")[0])).minute(parseInt(w.start.split(":")[1])).isSame(d,"minute"));console.log("Reschedule modal - Filtered slots (excluding current):",u),M(u||[])}else M([]),v.error(a.message||a.error||"Failed to fetch available slots")}catch(i){console.error("Error fetching available slots:",i),M([]),v.error("Failed to fetch available slots")}finally{T(!1)}}},D=s=>{F(s),$(null),f(s)},J=s=>{$(s)},ue=async()=>{if(!S||!I){v.error("Please select both date and time");return}const s=x(S).hour(I.hour()).minute(I.minute()).second(0);T(!0);try{const l=await(await fetch(route("customer.bookings.reschedule",r.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({new_appointment_time:s.format("YYYY-MM-DD HH:mm:ss")})})).json();if(l.success)l.requires_payment?await pe(l.data):(v.success("Booking rescheduled successfully!"),q(l.data),z.resetFields(),F(null),$(null),M([]));else{const a=l.reason||l.message||"Failed to reschedule booking";v.error(a),console.error("Reschedule failed:",{message:l.message,reason:l.reason,details:l.details})}}catch(i){console.error("Error rescheduling booking:",i),v.error("Failed to reschedule booking")}finally{T(!1)}},pe=async s=>{try{window.Razorpay||await xe();const i={key:s.key_id,amount:s.amount,currency:s.currency,name:"Booking Reschedule Fee",description:`Reschedule fee for booking #${r.id}`,order_id:s.order_id,handler:async function(a){try{const u=await(await fetch(route("customer.reschedule.payment-success"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({razorpay_payment_id:a.razorpay_payment_id,razorpay_order_id:a.razorpay_order_id,razorpay_signature:a.razorpay_signature})})).json();u.success?(v.success("Booking rescheduled successfully!"),q(u.data),z.resetFields(),F(null),$(null),M([])):v.error(u.message||"Payment verification failed")}catch(d){console.error("Payment success handling failed:",d),v.error("Failed to verify payment")}},prefill:{name:r.customer?.name||"Customer",email:r.customer?.email||"",contact:r.customer?.phone_number||""},theme:{color:"#1890ff"},modal:{ondismiss:function(){fe()}}};new window.Razorpay(i).open()}catch(i){console.error("Payment setup failed:",i),v.error("Failed to setup payment")}},fe=async()=>{try{await fetch(route("customer.reschedule.payment-failed"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})}catch(s){console.error("Payment cancellation handling failed:",s)}},xe=()=>new Promise((s,i)=>{if(window.Razorpay){s();return}const l=document.createElement("script");l.src="https://checkout.razorpay.com/v1/checkout.js",l.onload=()=>s(),l.onerror=()=>i(new Error("Failed to load Razorpay script")),document.head.appendChild(l)}),Q=()=>{z.resetFields(),F(null),$(null),M([]),t()},ye=s=>{try{if(!s)return"Invalid Time";let i=s;if(s&&typeof s=="object"&&s.format?i=s.format("HH:mm"):typeof s=="object"&&s.start&&(i=s.start),!i||typeof i!="string")return"Invalid Time";const l=i.match(/^(\d{1,2}):(\d{2})$/);if(!l)return"Invalid Time";const a=parseInt(l[1],10),d=parseInt(l[2],10);if(a<0||a>23||d<0||d>59)return"Invalid Time";const u=a>=12?"PM":"AM";return`${a===0?12:a>12?a-12:a}:${d.toString().padStart(2,"0")} ${u}`}catch(i){return console.error("Error formatting time:",i),"Invalid Time"}},je=()=>{W(E.subtract(1,"month"))},ge=()=>{W(E.add(1,"month"))},ve=s=>{const i=x(),l=Y?.[0];if(!l)return!1;const a=l.min_advance_hours,d=l.max_advance_days,u=l.working_days,w=i.add(a,"hour"),y=i.add(d,"day"),m=s.isSame(i,"day"),H=m||s.isAfter(w)&&(s.isBefore(y)||s.isSame(y,"day")),B=s.day(),N=B===0?7:B,ee=u.includes(N),te=H&&ee;return(s.isSame(i,"day")||s.format("YYYY-MM-DD")==="2025-08-18")&&console.log("RescheduleModal - Date selectability check:",{date:s.format("YYYY-MM-DD"),isToday:m,isWithinRange:H,isWorkingDay:ee,isSelectable:te,minAdvanceHours:a,maxAdvanceDays:d,workingDays:u,adjustedDayOfWeek:N,minDate:w.format("YYYY-MM-DD"),maxDate:y.format("YYYY-MM-DD"),scheduleSettings:Y,defaultSchedule:l}),te},_e=s=>{const i=s.startOf("month"),l=s.endOf("month"),a=i.day(),d=[],u=s.subtract(1,"month"),w=u.daysInMonth();for(let m=a-1;m>=0;m--)d.push(u.date(w-m));for(let m=1;m<=l.date();m++)d.push(s.date(m));const y=42-d.length;for(let m=1;m<=y;m++)d.push(s.add(1,"month").date(m));return d},Z=()=>{if(!o?.reschedule||o.reschedule.window_hours===0&&o.reschedule.max_attempts===0||o.reschedule.max_attempts>0&&r.reschedule_attempts>=o.reschedule.max_attempts)return!1;const s=x(),i=x(r.appointment_time);if(i.isBefore(s))return!1;const l=i.diff(s,"hour",!0);return!(o.reschedule.window_hours>0&&l<o.reschedule.window_hours)},b=r?.reschedule_attempts||0,k=o?.reschedule?.max_attempts||0;return o?.reschedule?.advance_notice_hours,e.jsx(Ce,{title:"Reschedule Booking",open:A,onCancel:Q,footer:null,width:800,centered:!0,children:e.jsxs("div",{style:{maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs(g,{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[e.jsx(Be,{style:{color:"#1890ff",marginRight:8}}),e.jsx(j,{strong:!0,children:"Current Booking"})]}),e.jsxs(L,{gutter:16,children:[e.jsxs(h,{span:8,children:[e.jsx(j,{type:"secondary",children:"Date:"}),e.jsx("br",{}),e.jsx(j,{strong:!0,children:x(r?.appointment_time).format("MMMM D, YYYY")})]}),e.jsxs(h,{span:8,children:[e.jsx(j,{type:"secondary",children:"Time:"}),e.jsx("br",{}),e.jsx(j,{strong:!0,children:x(r?.appointment_time).format("h:mm A")})]}),e.jsxs(h,{span:8,children:[e.jsx(j,{type:"secondary",children:"Service:"}),e.jsx("br",{}),e.jsx(j,{strong:!0,children:r?.service?.name})]})]})]}),K?e.jsxs(g,{style:{marginBottom:16},children:[e.jsx(se,{size:"small"})," Loading policy information..."]}):o?e.jsx(g,{style:{marginBottom:16},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs(j,{strong:!0,children:["Policy: ",o.name]}),e.jsx("br",{}),e.jsxs(j,{type:"secondary",children:[o.reschedule?.window_hours||0,"h window • Max"," ",o.reschedule?.max_attempts||0," ","attempts"]}),o.reschedule?.fee>0&&e.jsx("div",{style:{marginTop:8},children:e.jsxs(P,{color:"orange",children:["Reschedule Fee: ₹",o.reschedule.fee]})})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(j,{type:"secondary",children:"Attempts:"}),e.jsx("br",{}),e.jsxs(j,{strong:!0,style:{color:"#1890ff"},children:[b,"/",k]})]})]})}):null,!Z()&&o&&e.jsx(re,{message:"Rescheduling Not Allowed",description:e.jsxs("div",{children:[o.reschedule?.window_hours===0&&o.reschedule?.max_attempts===0&&e.jsx("p",{children:"Rescheduling is disabled for this booking."}),o.reschedule?.max_attempts>0&&r?.reschedule_attempts>=o.reschedule?.max_attempts&&e.jsxs("p",{children:["You have already used all your reschedule attempts (",b,"/",k,")."]}),x(r?.appointment_time).isBefore(x())&&e.jsx("p",{children:"Cannot reschedule appointments in the past."}),o.reschedule?.window_hours>0&&x(r?.appointment_time).diff(x(),"hour",!0)<o.reschedule?.window_hours&&e.jsxs("p",{children:["Your appointment is within the reschedule window (",o.reschedule?.window_hours," ","hours)."]})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),Z()&&e.jsxs(e.Fragment,{children:[o?.reschedule?.fee>0&&e.jsx(re,{message:"Reschedule Fee Required",description:`A reschedule fee of ₹${o.reschedule.fee} will be charged to complete the rescheduling process.`,type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsxs(g,{style:{marginBottom:16},children:[e.jsxs(ae,{level:4,style:{marginBottom:16},children:[e.jsx(me,{style:{marginRight:8}}),"Select New Date"]}),e.jsxs("div",{style:{border:"1px solid #f0f0f0",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",background:"white"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f0f0f0",background:"#fafafa",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(_,{size:"small",onClick:je,style:{border:"none",boxShadow:"none"},children:"‹"}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"600",minWidth:"120px",textAlign:"center"},children:E.format("MMMM YYYY")}),e.jsx(_,{size:"small",onClick:ge,style:{border:"none",boxShadow:"none"},children:"›"})]}),e.jsxs("div",{style:{padding:"16px"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px",marginBottom:"8px"},children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(s=>e.jsx("div",{style:{textAlign:"center",fontWeight:"600",color:"#666",padding:"8px 4px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:s},s))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px"},children:_e(E).map((s,i)=>{const l=x(),a=s.isBefore(l,"day"),d=s.isSame(l,"day"),u=S&&S.isSame(s,"day"),w=s.month()===E.month(),y=ve(s),m={height:"48px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",cursor:y&&!a?"pointer":"default",transition:"all 0.2s ease",fontSize:"14px",fontWeight:"500",opacity:w?1:.3};let H="transparent",B="#333",N="1px solid transparent";return a?B="#999":u?(H="#e6f7ff",B="#1890ff",N="2px solid #1890ff"):d&&!S?(H="#1890ff",B="white",N="none"):y?B="#333":B="#ccc",e.jsx("div",{style:{...m,backgroundColor:H,color:B,border:N},onClick:()=>{y&&!a&&D(s)},children:s.date()},i)})})]})]})]}),S&&e.jsxs(g,{children:[e.jsxs(ae,{level:4,style:{marginBottom:16},children:[e.jsx(Ie,{style:{marginRight:8}}),"Available Time Slots",r.gender_preference&&r.gender_preference!=="no_preference"?e.jsxs(j,{type:"secondary",style:{fontSize:14,marginLeft:8},children:["(Filtered for"," ",r.gender_preference==="male"?"Male":"Female"," ","HospiPal)"]}):e.jsx(j,{type:"secondary",style:{fontSize:14,marginLeft:8},children:"(All available HospiPals)"})]}),G?e.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[e.jsx(se,{size:"large"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(j,{type:"secondary",children:"Loading available slots..."})})]}):U.length===0?e.jsx(ne,{description:"No available slots for this date",image:ne.PRESENTED_IMAGE_SIMPLE}):e.jsx(L,{gutter:[12,12],children:U.map((s,i)=>{const l=typeof s=="object"?s.start:s;if(!l||typeof l!="string")return null;const a=l.split(":");if(a.length!==2)return null;const d=parseInt(a[0],10),u=parseInt(a[1],10);if(d<0||d>23||u<0||u>59)return null;const w=x().hour(d).minute(u).second(0).millisecond(0),y=I&&I.format("HH:mm")===l,m=typeof s=="object"?s.available!==!1:!0;return e.jsx(h,{xs:12,sm:8,md:6,children:e.jsx(_,{size:"large",disabled:!m,style:{width:"100%",height:48,border:y?"2px solid #1890ff":m?"1px solid #d9d9d9":"1px solid #ffccc7",backgroundColor:y?"#e6f7ff":m?"white":"#fff2f0",opacity:m?1:.6},onClick:()=>m&&J(w),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[y&&e.jsx(Me,{style:{marginRight:8,color:"#1890ff"}}),ye(l)]}),!m&&e.jsx("div",{style:{fontSize:"10px",marginTop:"2px",color:"#ff4d4f",fontWeight:"normal"},children:"Unavailable"})]})})},i)}).filter(Boolean)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:16},children:[e.jsx(_,{onClick:Q,children:"Cancel"}),e.jsx(_,{type:"primary",onClick:ue,loading:G,disabled:!S||!I,children:o?.reschedule?.fee>0?`Reschedule & Pay ₹${o.reschedule.fee}`:"Reschedule Booking"})]})]})]})})}const{Title:oe,Text:n,Paragraph:He}=de,{Header:Ne,Content:We}=he;function Bt({auth:A,booking:t}){const[q,r]=R.useState(!1),[Y,z]=R.useState(!1);console.log("BookingDetail component - Schedule settings:",{scheduleSettings:t?.schedule_settings,scheduleSettingsLength:t?.schedule_settings?.length,firstSchedule:t?.schedule_settings?.[0]}),console.log("BookingDetail component - Booking data:",{bookingId:t?.id,serviceName:t?.service?.name,pricingTierId:t?.pricing_tier_id,pricingTier:t?.pricingTier,pricingTierName:t?.pricingTier?.name,servicePrice:t?.service?.price,pricingTierPrice:t?.pricingTier?.price,pricingTierPriceParsed:parseFloat(t?.pricingTier?.price),totalAmount:t?.total_amount});const S=c=>{r(!1),window.location.reload()},F=()=>{r(!1)},I=c=>{z(!1),v.success("Booking cancelled successfully"),window.location.reload()},$=()=>{z(!1)};if(!A||!A.user)return e.jsxs("div",{style:{padding:"24px",textAlign:"center"},children:[e.jsx(oe,{level:2,children:"Access Denied"}),e.jsx(n,{children:"Please log in to view booking details."}),e.jsx("br",{}),e.jsx(_,{type:"primary",onClick:()=>O.visit(route("welcome")),style:{marginTop:16},children:"Go to Home"})]});const U=c=>{switch(c){case"confirmed":return"success";case"pending":return"warning";case"completed":return"processing";case"cancelled":return"error";case"no_show":return"default";default:return"default"}},M=c=>{switch(c){case"confirmed":return e.jsx(ce,{});case"pending":return e.jsx(ie,{});case"completed":return e.jsx(ce,{});case"cancelled":return e.jsx(le,{});case"no_show":return e.jsx(le,{});default:return e.jsx(ie,{})}},G=c=>{switch(c){case"paid":return"success";case"pending":return"warning";case"failed":return"error";case"refunded":return"default";default:return"default"}},T=c=>x(c).format("MMM DD, YYYY h:mm A"),K=c=>{if(c<60)return`${c} min`;{const p=Math.floor(c/60),f=c%60;return f>0?`${p}h ${f}m`:`${p}h`}},C=c=>`₹${parseFloat(c).toFixed(2)}`,E=c=>c?c.split(" ").map(p=>p[0]).join("").toUpperCase().slice(0,2):"CU",W=()=>{O.post(route("logout"),{},{onSuccess:()=>{window.location.reload()}})},o=()=>{window.print()},X=[{key:"services",icon:e.jsx(Ee,{}),label:"Services",onClick:()=>O.visit(route("booking.select-service"))},{key:"bookings",icon:e.jsx(me,{}),label:"Your Bookings",onClick:()=>O.visit(route("customer.bookings"))}];return e.jsxs(he,{style:{minHeight:"100vh"},children:[e.jsx(we,{title:`Booking #${t.id} - HospiPal`}),e.jsxs(Ne,{style:{background:"#fff",padding:"0 16px",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",height:"auto",minHeight:64,maxWidth:"100vw",width:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",flexShrink:0,minWidth:0},children:e.jsx(Se,{variant:"primary",color:"color",background:"white",size:"medium"})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,justifyContent:"flex-end",minWidth:0,overflow:"hidden"},children:[e.jsx(Re,{mode:"horizontal",items:X,selectedKeys:["bookings"],style:{border:"none",background:"transparent",fontSize:"14px",minWidth:0,flexShrink:1,maxWidth:"100%"}}),e.jsxs(V,{size:"small",style:{flexShrink:0},children:[e.jsx(Pe,{style:{backgroundColor:"#1890ff",cursor:"pointer"},onClick:()=>v.info("Profile settings coming soon"),children:E(A.user?.name)}),e.jsx(_,{type:"text",icon:e.jsx(Ae,{}),onClick:W,size:"small",children:e.jsx("span",{className:"hidden-xs",children:"Logout"})})]})]})]}),e.jsx(We,{style:{padding:"16px"},children:e.jsxs("div",{style:{maxWidth:1200,margin:"0 auto"},children:[e.jsx("div",{className:"mobile-top-spacing"}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(_,{icon:e.jsx(Ye,{}),onClick:()=>O.visit(route("customer.bookings")),style:{marginBottom:16},children:"Back to Bookings"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16},children:[e.jsxs("div",{children:[e.jsxs(oe,{level:2,style:{marginBottom:8},children:["Booking #",t.id]}),e.jsxs(n,{type:"secondary",children:[t.service?.name,t?.pricingTier&&e.jsx(P,{color:"blue",style:{marginLeft:8,fontSize:10},children:t.pricingTier.name})]})]}),e.jsx(V,{children:e.jsx(_,{icon:e.jsx(ze,{}),onClick:o,children:e.jsx("span",{className:"hidden-xs",children:"Print"})})})]})]}),e.jsxs(L,{gutter:[24,24],children:[e.jsxs(h,{xs:24,lg:16,children:[e.jsx(g,{title:"Booking Details",style:{marginBottom:24},children:e.jsxs(L,{gutter:[16,16],children:[e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Service"}),e.jsx("div",{children:e.jsxs(n,{children:[t.service?.name,t?.pricingTier&&e.jsx(P,{color:"blue",style:{marginLeft:8,fontSize:10},children:t.pricingTier.name})]})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Employee"}),e.jsx("div",{children:e.jsx(n,{children:t.employee?.name||"Auto-assigned"})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Date & Time"}),e.jsx("div",{children:e.jsx(n,{children:T(t.appointment_time)})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Duration"}),e.jsx("div",{children:e.jsx(n,{children:K(t.duration)})})]})}),t.gender_preference&&t.gender_preference!=="no_preference"&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"HospiPal Preference"}),e.jsx("div",{children:e.jsxs(V,{children:[e.jsxs(n,{children:[t.gender_preference==="male"?"Male":"Female"," ","HospiPal"]}),t.gender_preference_fee>0&&e.jsxs(P,{color:"blue",children:["+₹",t.gender_preference_fee]})]})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Status"}),e.jsx("div",{children:e.jsx(P,{color:U(t.status),icon:M(t.status),children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Payment Status"}),e.jsx("div",{children:e.jsx(P,{color:G(t.payment_status),children:t.payment_status.charAt(0).toUpperCase()+t.payment_status.slice(1)})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Reschedule Attempts"}),e.jsx("div",{children:e.jsxs(n,{children:[t.reschedule_attempts||0," ","attempts"]})})]})}),t.rescheduled_at&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Last Rescheduled"}),e.jsx("div",{children:e.jsx(n,{children:T(t.rescheduled_at)})})]})})]})}),t.extras&&t.extras.length>0&&e.jsx(g,{title:"Additional Services",style:{marginBottom:24},children:e.jsx(L,{gutter:[16,16],children:t.extras.map(c=>{const p=c.pivot?.quantity||1,f=parseFloat(c.pivot?.price||c.price)*p,D=c.duration_relation?(c.duration_relation.hours*60+c.duration_relation.minutes)*p:(c.total_duration||0)*p;return e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",border:"1px solid #f0f0f0",borderRadius:"8px"},children:[e.jsxs("div",{children:[e.jsxs(n,{strong:!0,children:[c.name,p>1&&e.jsxs(n,{type:"secondary",style:{fontSize:12,marginLeft:8},children:["×"," ",p]})]}),e.jsx("br",{}),e.jsx(n,{type:"secondary",style:{fontSize:"12px"},children:K(D)})]}),e.jsx(n,{children:C(f)})]})},c.id)})})}),(()=>{const c=t.form_responses;if(c&&c.length>0){const p=c.filter(f=>f.form_field&&!f.form_field.is_primary);return p.length>0?e.jsx(g,{title:"Additional Information",style:{marginBottom:24},children:e.jsx(L,{gutter:[16,16],children:p.map(f=>{const D=f.form_field,J=f.formatted_value||f.response_value;return e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs(n,{strong:!0,children:[D?.label||D?.name||"Unknown Field",":"]}),e.jsx("div",{children:e.jsx(n,{children:J||"Not provided"})})]})},f.id)})})}):e.jsx(g,{title:"Additional Information",style:{marginBottom:24},children:e.jsx(n,{type:"secondary",children:"No additional information found."})})}else return e.jsx(g,{title:"Additional Information",style:{marginBottom:24},children:e.jsx(n,{type:"secondary",children:"No form responses found."})})})(),t.notes&&e.jsx(g,{title:"Notes",style:{marginBottom:24},children:e.jsx(He,{children:t.notes})}),(t.reschedule_attempts>0||t.reschedule_payment_amount>0)&&e.jsx(g,{title:"Reschedule Information",style:{marginBottom:24},children:e.jsxs(L,{gutter:[16,16],children:[t.reschedule_attempts>0&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Reschedule Attempts"}),e.jsx("div",{children:e.jsxs(n,{children:[t.reschedule_attempts," ","time(s)"]})})]})}),t.rescheduled_at&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Last Rescheduled"}),e.jsx("div",{children:e.jsx(n,{children:T(t.rescheduled_at)})})]})}),t.reschedule_payment_amount>0&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Reschedule Fee Paid"}),e.jsx("div",{children:e.jsxs(n,{style:{color:"#52c41a",fontWeight:"bold"},children:["₹",t.reschedule_payment_amount]})})]})}),t.reschedule_payment_id&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Payment ID"}),e.jsx("div",{children:e.jsx(n,{code:!0,children:t.reschedule_payment_id})})]})}),t.reschedule_payment_date&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Payment Date"}),e.jsx("div",{children:e.jsx(n,{children:T(t.reschedule_payment_date)})})]})})]})})]}),e.jsxs(h,{xs:24,lg:8,children:[e.jsxs(g,{title:"Payment Details",style:{marginBottom:24},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(n,{children:["Service",t?.pricingTier&&e.jsx(P,{color:"blue",style:{marginLeft:8,fontSize:10},children:t.pricingTier.name})]}),e.jsx(n,{children:C(parseFloat(t?.pricingTier?.price)||parseFloat(t.service?.price)||0)})]}),t.extras&&t.extras.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(n,{children:"Extras"}),e.jsx(n,{children:C(t.extras.reduce((c,p)=>{const f=p.pivot?.quantity||1,D=parseFloat(p.pivot?.price||p.price||0);return c+D*f},0))})]}),t.distance_charges>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,color:"#1890ff"},children:[e.jsxs(n,{children:["Extra Distance Charges",e.jsx(P,{color:"blue",style:{marginLeft:8,fontSize:10},children:"Travel Buddy"})]}),e.jsx(n,{children:C(t.distance_charges)})]}),t.discount_amount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,color:"#52c41a"},children:[e.jsx(n,{children:"Discount"}),e.jsxs(n,{children:["-",C(t.discount_amount)]})]}),e.jsx($e,{style:{margin:"12px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"16px",fontWeight:"bold"},children:[e.jsx(n,{strong:!0,children:"Total"}),e.jsx(n,{strong:!0,children:C(t.total_amount)})]})]}),t.payment_method&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{type:"secondary",children:"Payment Method"}),e.jsx("div",{children:e.jsx(n,{children:t.payment_method})})]}),t.transaction_id&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{type:"secondary",children:"Transaction ID"}),e.jsx("div",{children:e.jsx(n,{code:!0,children:t.transaction_id})})]})]}),e.jsx(g,{title:"Actions",children:e.jsxs(V,{direction:"vertical",style:{width:"100%"},children:[(t.status==="pending"||t.status==="confirmed")&&e.jsx(_,{type:"primary",block:!0,danger:!0,onClick:()=>z(!0),children:"Cancel Booking"}),t.status==="confirmed"&&e.jsx(_,{type:"primary",block:!0,onClick:()=>r(!0),children:"Reschedule"}),t.invoice&&e.jsx(_,{icon:e.jsx(Fe,{}),block:!0,onClick:()=>window.open(`/customer/invoices/${t.invoice.id}/download`,"_blank"),children:"Download Invoice"}),e.jsx(_,{block:!0,onClick:()=>v.info("Contact support functionality coming soon"),children:"Contact Support"})]})})]})]})]})}),e.jsx(Le,{visible:q,onCancel:F,onSuccess:S,booking:t,scheduleSettings:t.schedule_settings||[]}),e.jsx(De,{visible:Y,onCancel:$,onSuccess:I,booking:t})]})}export{Bt as default};
