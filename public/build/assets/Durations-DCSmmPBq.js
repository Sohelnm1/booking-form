import{r as d,j as e,H as M,a as p}from"./app-CuTyM8qs.js";import{A as O}from"./AdminLayout-DxZj7TE_.js";import{F as o}from"./index-CntA_Z3_.js";import{C as z,B as h,S as L}from"./Logo-DB_VWhtc.js";import{T as N}from"./AntdIcon-BWI9q6gw.js";import{R as P}from"./PlusOutlined-CTPxMA3q.js";import{F as q}from"./Table-4kFSLiu0.js";import{M as F}from"./index-BmxFTo2U.js";import{R as y,C as m}from"./row-CWvsuTqW.js";import{I as _}from"./index-BJjxZA3h.js";import{T as b}from"./index-1gUs91BJ.js";import{S as H}from"./index-BctRl2EA.js";import{T as I}from"./index-RHGTR9Hu.js";import{R as B}from"./EyeOutlined-ZY0jRne9.js";import{R as J}from"./EditOutlined-CNXcJxkr.js";import{R as K}from"./DeleteOutlined-CYjp1E0b.js";/* empty css            */import"./index-DPvNFwos.js";import"./GiftOutlined-6S8Hjigb.js";import"./index-Dxhw4rI7.js";import"./move-BX-mCe9T.js";import"./index-BlGZQQRe.js";import"./CalendarOutlined-D8g-vkNY.js";import"./CalendarOutlined-DKq2sctu.js";import"./FileTextOutlined-BRxWPuCR.js";import"./UserOutlined-0tYNQjqZ.js";import"./ClockCircleOutlined-D0KWJ-QF.js";import"./ClockCircleOutlined-CELcQ7Uv.js";import"./useForm-C90a_f_Q.js";import"./CheckCircleFilled-C3pB09d-.js";import"./InfoCircleFilled-cdlFFNUN.js";import"./addEventListener-AN7s1qs7.js";import"./index-Bge_c090.js";import"./index-BUZKeI3G.js";import"./DownOutlined-AY4XX3Dn.js";import"./Input-q0YWenEe.js";import"./index-BaG1LYaN.js";import"./Pagination-OFeQ4t8h.js";import"./index-BpdwzNf1.js";import"./extendsObject-78o_rR5W.js";import"./index-B0MsyL9Y.js";import"./useClosable-CPKIXEqQ.js";import"./EyeOutlined-DZcnRuE4.js";import"./EyeOutlined-Bmd706kk.js";const{Title:Q,Text:U}=N;function Le({auth:k,durations:D,errors:l}){const[x,a]=d.useState(!1),[i,f]=d.useState(null),[S,n]=d.useState(!1),[v,j]=d.useState(null),[r]=o.useForm(),T=D||[];d.useEffect(()=>{l&&Object.keys(l).length>0?(console.log("Validation errors received:",l),Object.keys(l).forEach(t=>{r.setFields([{name:t,errors:[l[t]]}])}),a(!0)):r.setFields([])},[l,r]),d.useEffect(()=>{if(x)if(i){const t={name:i.name,hours:i.hours||0,minutes:i.minutes||0,label:i.label||i.Label,is_active:i.is_active,sort_order:i.sort_order||0};r.setFields([]),r.setFieldsValue(t),console.log("Form values set in useEffect:",t),setTimeout(()=>{const s=r.getFieldsValue();console.log("Form values after setting:",s)},100)}else r.setFieldsValue({hours:0,minutes:0,is_active:!0,sort_order:0})},[x,i,r]);const w=[{title:"Name",dataIndex:"name",key:"name",render:(t,s)=>e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:t}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:s.label})]})})},{title:"Duration",dataIndex:"minutes",key:"duration",render:(t,s)=>{const c=s.hours||0,g=s.minutes||0;let u="";return c>0&&g>0?u=`${c}h ${g}m`:c>0?u=`${c}h`:u=`${g}m`,e.jsx(I,{color:"blue",children:u})}},{title:"Status",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(I,{color:t?"green":"red",children:t?"Active":"Inactive"})},{title:"Sort Order",dataIndex:"sort_order",key:"sort_order",render:t=>t||0},{title:"Actions",key:"actions",render:(t,s)=>e.jsxs(L,{children:[e.jsx(h,{type:"text",icon:e.jsx(B,{}),size:"small",onClick:()=>V(s)}),e.jsx(h,{type:"text",icon:e.jsx(J,{}),size:"small",onClick:()=>E(s)}),e.jsx(h,{type:"text",icon:e.jsx(K,{}),size:"small",danger:!0,loading:v===s.id,disabled:v===s.id,onClick:()=>R(s)})]})}],C=()=>{f(null),r.resetFields(),r.setFields([]),r.setFieldsValue({hours:0,minutes:0,is_active:!0,sort_order:0}),a(!0)},E=t=>{f(t),r.setFields([]),r.resetFields();const s={name:t.name,hours:t.hours||0,minutes:t.minutes||0,label:t.label||t.Label,is_active:t.is_active,sort_order:t.sort_order||0};r.setFieldsValue(s),console.log("Form values set:",s),a(!0)},V=t=>{p.visit(route("admin.durations.show",t.id))},R=t=>{F.confirm({title:"Delete Duration",content:`Are you sure you want to delete "${t.name}"?`,okText:"Yes",okType:"danger",cancelText:"No",onOk:()=>{j(t.id),p.post(route("admin.durations.delete",t.id),{},{onSuccess:()=>{j(null)},onError:()=>{j(null)}})}})},$=()=>{r.validateFields().then(t=>{n(!0),console.log("Form values after validation:",t),console.log("Editing duration:",i);const s={name:t.name,hours:t.hours,minutes:t.minutes,label:t.label,is_active:t.is_active?1:0,sort_order:t.sort_order||0};console.log("Submit data:",s),i?p.put(route("admin.durations.update",i.id),s,{onSuccess:()=>{a(!1),n(!1)},onError:()=>{n(!1)}}):p.post(route("admin.durations.store"),s,{onSuccess:()=>{a(!1),n(!1)},onError:()=>{n(!1)}})}).catch(t=>{console.error("Form validation failed:",t),n(!1)})},A=()=>{a(!1),f(null),r.resetFields(),r.setFields([])};return e.jsxs(O,{auth:k,children:[e.jsx(M,{title:"Durations - Admin Dashboard"}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(z,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{children:[e.jsx(Q,{level:2,style:{margin:0},children:"Durations"}),e.jsx(U,{type:"secondary",children:"Manage service durations for your booking system"})]}),e.jsx(h,{type:"primary",icon:e.jsx(P,{}),onClick:C,children:"Add Duration"})]}),e.jsx(q,{columns:w,dataSource:T,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`${s[0]}-${s[1]} of ${t} durations`}})]}),e.jsx(F,{title:i?"Edit Duration":"Add Duration",open:x,onOk:$,onCancel:A,confirmLoading:S,width:600,okText:i?"Update":"Add",cancelText:"Cancel",children:e.jsxs(o,{form:r,layout:"vertical",style:{marginTop:"16px"},children:[e.jsxs(y,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"name",label:"Name*",rules:[{required:!0,message:"Please enter duration name"}],children:e.jsx(_,{placeholder:"e.g., 1 hour"})})}),e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"hours",label:"Hours*",rules:[{required:!0,message:"Please enter hours"},{type:"number",min:0,message:"Hours must be at least 0"}],children:e.jsx(b,{style:{width:"100%"},placeholder:"1",min:0})})})]}),e.jsxs(y,{gutter:16,children:[e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"minutes",label:"Minutes*",rules:[{required:!0,message:"Please enter minutes"},{type:"number",min:0,max:59,message:"Minutes must be between 0 and 59"}],children:e.jsx(b,{style:{width:"100%"},placeholder:"30",min:0,max:59})})}),e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"sort_order",label:"Sort Order",children:e.jsx(b,{style:{width:"100%"},placeholder:"0",min:0})})})]}),e.jsx(o.Item,{name:"label",label:"Display Label*",rules:[{required:!0,message:"Please enter display label"}],children:e.jsx(_,{placeholder:"e.g., 1 hour"})}),e.jsx(y,{gutter:16,children:e.jsx(m,{span:12,children:e.jsx(o.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:e.jsx(H,{})})})})]})})]})]})}export{Le as default};
