import{r as x,j as t,H as P,a as h}from"./app-GHJ6SJ9p.js";import{A as U}from"./AdminLayout-BAgcmyjt.js";import{F as l}from"./index-DQaT6v9B.js";import{T as N,B as f,C as z,a as E}from"./Logo-CgCrcYaU.js";import{R as G}from"./PlusOutlined-CtpEdgYh.js";import{F as Y}from"./Table-D-mWpawj.js";import{M as F}from"./index-BI7GSswp.js";import{R as I,C as p}from"./row-CgwhhCUf.js";import{I as R}from"./index-BKi5BDEi.js";import{T as A}from"./index-CvMK6DjP.js";import{S as w}from"./index-CnMyniK2.js";import{S as $}from"./index-CH9xnHPr.js";import{U as H,R as J}from"./InboxOutlined-B_zCb89L.js";import{s as d}from"./index-BceBb3gr.js";import{I as K}from"./index-DpVoXqfo.js";import{R as W}from"./ClockCircleOutlined-DL0l6okk.js";import{T as S}from"./index-Di36YMr6.js";import{S as X}from"./index-C4h3PxPQ.js";import{R as Z}from"./EyeOutlined-Dm-7CYKk.js";import{R as ee}from"./EditOutlined-WK11D0bY.js";import{P as te}from"./index-Cj0OVQgX.js";import{R as re}from"./DeleteOutlined-Czaf-bo4.js";/* empty css            */import"./index-C_hlbVzA.js";import"./index-CFCYulKb.js";import"./PurePanel-oknD4ArD.js";import"./move-BQEn0wCQ.js";import"./LogoutOutlined-Bdb2DG7j.js";import"./CalendarOutlined-DRjFhB-3.js";import"./DollarOutlined-DkHeabU4.js";import"./UserOutlined-CB-PlqxZ.js";import"./SettingOutlined-B_syKyCn.js";import"./FileTextOutlined-DYWq0JzC.js";import"./GiftOutlined-C9tE1WQH.js";import"./useForm-c8FVYlit.js";import"./CheckCircleFilled-C6274V1h.js";import"./InfoCircleFilled-BgQ81YM8.js";import"./pickAttrs-BVXv29NF.js";import"./addEventListener-DIGLTZCa.js";import"./DownOutlined-CnWx9RdQ.js";import"./index-Ckzs-oZH.js";import"./index-DSrkMEKC.js";import"./index-DIcGKw6c.js";import"./extendsObject-78o_rR5W.js";import"./index-BHN9A3hJ.js";import"./Input-Ba6sZIOH.js";import"./useClosable-C7FjKwvd.js";import"./EyeOutlined-BUY3z7ff.js";import"./EyeOutlined-Bmd706kk.js";import"./DownloadOutlined-DTidZHln.js";import"./progress-BOjXP-pI.js";const{Title:ie,Text:c}=N,{TextArea:ae}=R,{Option:D}=w;function it({auth:C,extras:g,services:T,durations:_,errors:se}){const[j,m]=x.useState(!1);console.log("Admin Extras component - Extras data:",g),g.forEach((e,r)=>{console.log(`Admin Extra ${r+1}:`,{id:e.id,name:e.name,duration_id:e.duration_id,durationRelation:e.durationRelation,hasDurationRelation:!!e.durationRelation,durationLabel:e.durationRelation?.label})});const[a,b]=x.useState(null),[s,u]=x.useState(!1),[M,y]=x.useState(!1),[n]=l.useForm();x.useEffect(()=>{if(j)if(a){const e={name:a.name||"",description:a.description||"",price:parseFloat(a.price)||0,duration_id:a.duration_id||null,max_quantity:a.max_quantity||5,sort_order:a.sort_order||0,is_active:a.is_active!==void 0?a.is_active:!0,services:a.services?.map(r=>r.id)||[]};setTimeout(()=>{n.setFieldsValue(e)},100)}else setTimeout(()=>{n.setFieldsValue({is_active:!0,duration_id:null,max_quantity:5,sort_order:0,description:"",services:[]})},100)},[j,a,n]);const B=()=>{b(null),u(!1),m(!0)},Q=e=>{b(e),u(!1),m(!0)},q=e=>{b(e),u(!0),m(!0)},V=(e,r)=>{if(r===null||r<0){d.error("Sort order must be a positive number");return}h.put(route("admin.extras.update-sort-order",e),{sort_order:r},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{d.success("Sort order updated successfully")},onError:i=>{d.error(i.error||"Failed to update sort order")}})},L=e=>{F.confirm({title:"Delete Extra",content:`Are you sure you want to delete "${e.name}"? This action cannot be undone.`,okText:"Delete",okType:"danger",cancelText:"Cancel",onOk(){d.loading({content:"Deleting extra...",key:"deleteExtra"}),h.post(route("admin.extras.delete",e.id),{onSuccess:()=>{d.success({content:"Extra deleted successfully",key:"deleteExtra",duration:3})},onError:()=>{d.error({content:"Failed to delete extra",key:"deleteExtra",duration:5})}})}})},k=()=>{n.validateFields().then(e=>{y(!0);const r=new FormData;Object.keys(e).forEach(i=>{if(i==="image"&&e[i]?.fileList?.[0]?.originFileObj)r.append("image",e[i].fileList[0].originFileObj);else if(i==="price"){const o=parseFloat(e[i])||0;r.append(i,o)}else if(i==="duration_id"){const o=e[i]||null;r.append(i,o)}else if(i==="is_active")r.append(i,e[i]?"1":"0");else if(i==="services")e[i]&&e[i].length>0&&e[i].forEach(o=>{r.append("services[]",o)});else if(i==="sort_order"){const o=e[i]!==null&&e[i]!==void 0?e[i]:0;r.append(i,o)}else r.append(i,e[i]||"")}),a?(r.append("_method","PUT"),h.post(route("admin.extras.update",a.id),r,{onSuccess:()=>{d.success("Extra updated successfully"),m(!1),n.resetFields()},onError:i=>{i&&Object.keys(i).forEach(o=>{n.setFields([{name:o,errors:[i[o]]}])}),d.error("Failed to update extra")},onFinish:()=>{y(!1)}})):h.post(route("admin.extras.store"),r,{onSuccess:()=>{d.success("Extra created successfully"),m(!1),n.resetFields()},onError:i=>{i&&Object.keys(i).forEach(o=>{n.setFields([{name:o,errors:[i[o]]}])}),d.error("Failed to create extra")},onFinish:()=>{y(!1)}})}).catch(e=>{console.error("Form validation failed:",e),d.error("Please check the form and try again")})},v=()=>{m(!1),u(!1),n.resetFields()},O=[{title:"Image",dataIndex:"image",key:"image",render:(e,r)=>t.jsx(K,{width:40,height:40,src:e||`https://placehold.co/40x40/1890ff/ffffff?text=${r.name?.charAt(0)?.toUpperCase()||"E"}`,alt:r.name,style:{borderRadius:4},fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3Ik1RnG4W+FgYxN"})},{title:"Name",dataIndex:"name",key:"name",render:e=>t.jsx(c,{strong:!0,children:e})},{title:"Description",dataIndex:"description",key:"description",render:e=>t.jsx(c,{type:"secondary",style:{fontSize:"12px"},children:e||"No description"})},{title:"Price",dataIndex:"price",key:"price",render:e=>t.jsxs(c,{strong:!0,style:{color:"#52c41a"},children:["₹",e]})},{title:"Duration",dataIndex:"duration",key:"duration",render:(e,r)=>t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[t.jsx(W,{style:{color:"#1890ff"}}),t.jsx(c,{children:r.durationRelation?r.durationRelation.label:"No additional time"})]})},{title:"Available For",dataIndex:"services",key:"services",render:e=>t.jsxs("div",{children:[e&&e.length>0?e.slice(0,2).map(r=>t.jsx(S,{color:"blue",style:{marginBottom:4},children:r.name},r.id)):t.jsx(S,{color:"orange",children:"All Services"}),e&&e.length>2&&t.jsxs(c,{type:"secondary",style:{fontSize:"11px"},children:["+",e.length-2," more"]})]})},{title:"Sort Order",dataIndex:"sort_order",key:"sort_order",render:(e,r)=>t.jsx(A,{min:0,max:999,value:e,onChange:i=>V(r.id,i),style:{width:80},size:"small"})},{title:"Status",dataIndex:"is_active",key:"is_active",render:e=>t.jsx(S,{color:e?"green":"red",children:e?"Active":"Inactive"})},{title:"Actions",key:"actions",render:(e,r)=>t.jsxs(X,{children:[t.jsx(E,{title:"View Extra",children:t.jsx(f,{icon:t.jsx(Z,{}),size:"small",onClick:()=>q(r)})}),t.jsx(E,{title:"Edit Extra",children:t.jsx(f,{type:"primary",icon:t.jsx(ee,{}),size:"small",onClick:()=>Q(r)})}),t.jsx(E,{title:"Delete Extra",children:t.jsx(te,{title:"Delete this extra?",description:"This action cannot be undone.",onConfirm:()=>L(r),okText:"Yes",cancelText:"No",children:t.jsx(f,{danger:!0,icon:t.jsx(re,{}),size:"small"})})})]})}];return t.jsxs(U,{auth:C,children:[t.jsx(P,{title:"Extras Management"}),t.jsxs("div",{children:[t.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx(ie,{level:2,style:{marginBottom:4},children:"Extras Management"}),t.jsx(c,{type:"secondary",children:"Manage additional services and add-ons"})]}),t.jsx(f,{type:"primary",icon:t.jsx(G,{}),onClick:B,children:"Add Extra"})]}),t.jsx(z,{children:t.jsx(Y,{columns:O,dataSource:g,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,r)=>`${r[0]}-${r[1]} of ${e} extras`}})}),t.jsx(F,{title:s?`View Extra: ${a?.name}`:a?"Edit Extra":"Add Extra",open:j,onOk:s?v:k,onCancel:v,confirmLoading:M,width:600,okText:s?"Close":"Save",cancelText:"Cancel",children:t.jsxs(l,{form:n,layout:"vertical",children:[t.jsxs(I,{gutter:16,children:[t.jsx(p,{span:12,children:t.jsx(l.Item,{name:"name",label:"Extra name*",rules:s?[]:[{required:!0,message:"Please enter extra name",whitespace:!0}],children:t.jsx(R,{placeholder:"Enter name",disabled:s})})}),t.jsx(p,{span:12,children:t.jsx(l.Item,{name:"price",label:"Price*",rules:s?[]:[{required:!0,message:"Please enter price"},{type:"number",min:0,message:"Price must be a positive number"}],children:t.jsx(A,{style:{width:"100%"},placeholder:"0.00",min:0,step:.01,disabled:s,formatter:e=>`₹ ${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/₹\s?|(,*)/g,"")})})})]}),t.jsx(l.Item,{name:"description",label:"Description",children:t.jsx(ae,{rows:3,placeholder:"Describe this extra service...",disabled:s})}),t.jsxs(I,{gutter:16,children:[t.jsx(p,{span:12,children:t.jsx(l.Item,{name:"duration_id",label:"Additional Duration",children:t.jsx(w,{placeholder:"Select duration (optional)",allowClear:!0,style:{width:"100%"},disabled:s,children:_?.map(e=>t.jsx(D,{value:e.id,children:e.label},e.id))})})}),t.jsx(p,{span:12,children:t.jsx(l.Item,{name:"max_quantity",label:"Max Quantity",rules:[{required:!0,message:"Please enter maximum quantity"},{type:"number",min:1,max:20,message:"Value must be between 1 and 20"}],children:t.jsx(A,{min:1,max:20,style:{width:"100%"},placeholder:"Enter max quantity",disabled:s})})})]}),t.jsxs(I,{gutter:16,children:[t.jsx(p,{span:12,children:t.jsx(l.Item,{name:"sort_order",label:"Sort Order",rules:[{type:"number",min:0,message:"Sort order must be a positive number"}],children:t.jsx(A,{min:0,max:999,style:{width:"100%"},placeholder:"0",disabled:s,onChange:e=>{const r=e??0;n.setFieldsValue({sort_order:r})}})})}),t.jsx(p,{span:12,children:t.jsx(l.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:t.jsx($,{disabled:s})})})]}),t.jsx(l.Item,{name:"services",label:"Available for Services",children:t.jsx(w,{mode:"multiple",placeholder:"Select services (leave empty for all services)",allowClear:!0,style:{width:"100%"},disabled:s,children:T.map(e=>t.jsx(D,{value:e.id,children:e.name},e.id))})}),t.jsx(c,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:"Select specific services where this extra will be available. Leave empty to make it available for all services."}),t.jsx(l.Item,{name:"image",label:"Extra image",children:t.jsxs(H.Dragger,{name:"file",multiple:!1,beforeUpload:()=>!1,showUploadList:!0,accept:"image/*",maxCount:1,fileList:[],disabled:s,children:[t.jsx("p",{className:"ant-upload-drag-icon",children:t.jsx(J,{})}),t.jsx("p",{className:"ant-upload-text",children:s?"Image preview":"Drag and drop or choose from files"})]})})]})})]})]})}export{it as default};
