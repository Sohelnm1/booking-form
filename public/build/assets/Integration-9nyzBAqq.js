import{r as p,j as e,H as z}from"./app-CpyWOzlR.js";import{A as E,d as h}from"./AdminLayout-DhTZ9E0i.js";import{F as t}from"./index-TowZue-t.js";import{T as M,C as q,S as y,B as j}from"./Logo-DlV9EjkA.js";import{A as _}from"./index-DExneSth.js";import{R as O,C as B}from"./row-BCNuNlOc.js";import{T as G}from"./index-VKOySCYS.js";import{R as N}from"./EditOutlined-DdhGILZ0.js";import{S as f}from"./index-DuNimlWK.js";import{M as $}from"./index-BXH8evxi.js";import{I as a}from"./index-DiFP8FL3.js";import{S as l}from"./index-D6kpFrHg.js";import{R as K}from"./SaveOutlined-BASAPyau.js";import{R as L}from"./CloseCircleOutlined-D1sGHqdr.js";import{R as D}from"./CheckCircleOutlined-DFoLw2ww.js";import{s as i}from"./index-CubTjXZi.js";/* empty css            */import"./UserOutlined-CQl7blLa.js";import"./index-CaMoadTO.js";import"./move-Cd4z_A2Z.js";import"./DollarOutlined-awUvz-28.js";import"./PlusOutlined-DyNRnyDo.js";import"./ClockCircleOutlined-CTUj-8w6.js";import"./FileTextOutlined-Bkwr4M8g.js";import"./GiftOutlined-Va2OfBZk.js";import"./useForm-Bfjg84hl.js";import"./CheckCircleFilled-0UDZWC-6.js";import"./InfoCircleFilled-Crc2fNZY.js";import"./useClosable-sr3WhesA.js";import"./extendsObject-78o_rR5W.js";import"./Input-D1Nf4gPX.js";import"./EyeOutlined-CMA5CKZW.js";import"./EyeOutlined-Bmd706kk.js";import"./index-DFmFtDlo.js";import"./DownOutlined-DdYbbGax.js";const{Title:J,Text:o,Paragraph:U}=M,{TextArea:Ae}=a;function Ce({auth:I,integrations:P=[]}){const[b,u]=p.useState(!1),[c,w]=p.useState(null),[g,m]=p.useState(!1),[d]=t.useForm(),k=s=>{switch(s){case"active":return"green";case"inactive":return"red";case"pending":return"orange";default:return"default"}},S=s=>{switch(s){case"active":return e.jsx(D,{style:{color:"#52c41a"}});case"inactive":return e.jsx(L,{style:{color:"#ff4d4f"}});case"pending":return e.jsx(h,{style:{color:"#faad14"}});default:return e.jsx(h,{})}},v=s=>{w(s);const r={integration_id:s.id,name:s.name,description:s.description,is_enabled:s.is_enabled};s.settings&&Object.keys(s.settings).forEach(n=>{r[n]=s.settings[n]}),d.setFieldsValue(r),u(!0)},A=async()=>{try{m(!0);const s=await d.validateFields(),r={},n=s.integration_id;switch(n){case"razorpay":r.razorpay_key=s.razorpay_key||"",r.razorpay_secret=s.razorpay_secret||"",r.currency=s.currency||"INR";break;case"google_maps":r.google_maps_api_key=s.google_maps_api_key||"",r.google_maps_enabled_services=s.google_maps_enabled_services||"places,geocoding,maps";break;case"sms":r.twilio_sid=s.twilio_sid||"",r.twilio_token=s.twilio_token||"",r.twilio_phone=s.twilio_phone||"";break;case"email":r.sendgrid_key=s.sendgrid_key||"",r.sendgrid_from_email=s.sendgrid_from_email||"",r.sendgrid_from_name=s.sendgrid_from_name||"";break}const x=await fetch(route("admin.integration.update"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({integration_id:n,settings:r})}),F=await x.json();x.ok?(i.success("Integration settings updated successfully"),u(!1),d.resetFields(),window.location.reload()):i.error(F.error||"Failed to update integration settings")}catch(s){console.error("Error updating integration:",s),i.error("Failed to update integration settings")}finally{m(!1)}},C=()=>{u(!1),d.resetFields()},T=s=>{i.success(`${s.name} ${s.is_enabled?"disabled":"enabled"} successfully`)},R=async s=>{try{m(!0);const r=await fetch(route("admin.integration.test"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({integration_id:s.id})}),n=await r.json();r.ok?i.success(n.success||"Connection test successful"):i.error(n.error||"Connection test failed")}catch(r){console.error("Error testing connection:",r),i.error("Failed to test connection")}finally{m(!1)}};return e.jsxs(E,{auth:I,children:[e.jsx(z,{title:"Integration Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(J,{level:2,style:{marginBottom:8},children:"Integration Management"}),e.jsx(o,{type:"secondary",children:"Manage third-party integrations and API connections"})]}),e.jsx(_,{message:"Integration Status",description:"All integrations are working properly. Last health check: 2 minutes ago",type:"success",showIcon:!0,style:{marginBottom:24}}),e.jsx(O,{gutter:[24,24],children:P.map(s=>e.jsx(B,{xs:24,md:12,lg:8,children:e.jsxs(q,{title:e.jsxs(y,{children:[S(s.status),s.name]}),extra:e.jsx(f,{checked:s.is_enabled,onChange:()=>T(s),size:"small"}),actions:[e.jsx(j,{type:"text",icon:e.jsx(N,{}),onClick:()=>v(s),children:"Configure"}),e.jsx(j,{type:"text",icon:e.jsx(h,{}),onClick:()=>R(s),loading:g,children:"Test"})],children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(U,{type:"secondary",children:s.description})}),e.jsxs(y,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Status: "}),e.jsx(G,{color:k(s.status),children:s.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"API Key: "}),e.jsx(o,{code:!0,children:s.api_key})]}),s.id==="razorpay"&&s.settings?.currency&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Currency: "}),e.jsx(o,{code:!0,children:s.settings.currency})]}),s.id==="sms"&&s.settings?.twilio_phone&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Phone: "}),e.jsx(o,{code:!0,children:s.settings.twilio_phone})]}),s.id==="email"&&s.settings?.sendgrid_from_email&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"From Email: "}),e.jsx(o,{code:!0,style:{fontSize:"12px"},children:s.settings.sendgrid_from_email})]}),s.last_sync&&e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:"Last Sync: "}),e.jsx(o,{type:"secondary",children:s.last_sync})]})]})]})},s.id))}),e.jsx($,{title:`Configure ${c?.name}`,open:b,onOk:A,onCancel:C,width:600,okText:"Save Changes",okIcon:e.jsx(K,{}),confirmLoading:g,children:e.jsxs(t,{form:d,layout:"vertical",children:[e.jsx(t.Item,{name:"integration_id",hidden:!0,children:e.jsx(a,{})}),c?.id==="razorpay"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"razorpay_key",label:"Razorpay API Key",rules:[{required:!0,message:"Please enter Razorpay API key"}],children:e.jsx(a.Password,{placeholder:"rzp_test_..."})}),e.jsx(t.Item,{name:"razorpay_secret",label:"Razorpay API Secret",rules:[{required:!0,message:"Please enter Razorpay API secret"}],children:e.jsx(a.Password,{placeholder:"Enter API secret"})}),e.jsx(t.Item,{name:"currency",label:"Currency",rules:[{required:!0,message:"Please select currency"}],children:e.jsxs(l,{placeholder:"Select currency",children:[e.jsx(l.Option,{value:"INR",children:"Indian Rupee (₹)"}),e.jsx(l.Option,{value:"USD",children:"US Dollar ($)"}),e.jsx(l.Option,{value:"EUR",children:"Euro (€)"}),e.jsx(l.Option,{value:"GBP",children:"British Pound (£)"})]})})]}),c?.id==="google_maps"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"google_maps_api_key",label:"Google Maps API Key",rules:[{required:!0,message:"Please enter Google Maps API key"}],children:e.jsx(a.Password,{placeholder:"AIza..."})}),e.jsx(t.Item,{name:"google_maps_enabled_services",label:"Enabled Services",rules:[{required:!0,message:"Please select enabled services"}],children:e.jsx(l,{mode:"multiple",placeholder:"Select enabled services",options:[{label:"Places API",value:"places"},{label:"Geocoding API",value:"geocoding"},{label:"Maps JavaScript API",value:"maps"}]})}),e.jsx(_,{message:"Google Maps API Setup",description:"Make sure to enable the following APIs in your Google Cloud Console: Places API, Geocoding API, and Maps JavaScript API. Also ensure your API key has the necessary permissions.",type:"info",showIcon:!0,style:{marginBottom:16}})]}),c?.id==="sms"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"twilio_sid",label:"Twilio Account SID",rules:[{required:!0,message:"Please enter Twilio Account SID"}],children:e.jsx(a,{placeholder:"AC..."})}),e.jsx(t.Item,{name:"twilio_token",label:"Twilio Auth Token",rules:[{required:!0,message:"Please enter Twilio Auth Token"}],children:e.jsx(a.Password,{placeholder:"Enter auth token"})}),e.jsx(t.Item,{name:"twilio_phone",label:"Twilio Phone Number",rules:[{required:!0,message:"Please enter Twilio phone number"}],children:e.jsx(a,{placeholder:"+1234567890"})})]}),c?.id==="email"&&e.jsxs(e.Fragment,{children:[e.jsx(t.Item,{name:"sendgrid_key",label:"SendGrid API Key",rules:[{required:!0,message:"Please enter SendGrid API key"}],children:e.jsx(a.Password,{placeholder:"SG..."})}),e.jsx(t.Item,{name:"sendgrid_from_email",label:"From Email",rules:[{required:!0,message:"Please enter from email"},{type:"email",message:"Please enter a valid email"}],children:e.jsx(a,{placeholder:"noreply@yourdomain.com"})}),e.jsx(t.Item,{name:"sendgrid_from_name",label:"From Name",rules:[{required:!0,message:"Please enter from name"}],children:e.jsx(a,{placeholder:"Your Business Name"})})]}),e.jsx(t.Item,{name:"is_enabled",label:"Enable Integration",valuePropName:"checked",children:e.jsx(f,{})})]})})]})]})}export{Ce as default};
