import{r as i,j as e,H as q}from"./app-B0cWkBWz.js";import{A as G}from"./AdminLayout-3nSVnXHo.js";import{R as U,u as W,t as X}from"./timezone-sIg7GIzv.js";import{d as h}from"./dayjs.min-DYLjuGX6.js";import{I as Z,C as m,T as ee,B as x}from"./Logo-BdBrmI7S.js";import{R as P}from"./DollarOutlined-rtvZr_8v.js";import{S as f}from"./index-Cy8ytTRt.js";import{R as B,C as c}from"./row-CarD1OOM.js";import{S as j}from"./index-BZiqB5j2.js";import{R as te}from"./ClockCircleOutlined-DAAxrAWg.js";import{R as se}from"./CheckCircleOutlined-1CqH6x3K.js";import{P as ne}from"./progress-Dg_tEXUU.js";import{I as re}from"./index-BDbgyLmG.js";import{R as le}from"./SearchOutlined-BanzBUU_.js";import{S as F}from"./index-BXrLq_WH.js";import{D as L}from"./index-BYyOwLI7.js";import{F as ae}from"./Table-CAzV_hOh.js";import{M as oe}from"./index-CHmL9A8j.js";import{D as l}from"./index-Ci_LLbFJ.js";import{D as ie}from"./index-Bvkzo-Jn.js";import{B as T}from"./index-DNXO1o8e.js";import{s as ce}from"./index-DBBHLkC6.js";import{R as de}from"./EyeOutlined-oy15B03z.js";/* empty css            */import"./index-DzU9cNkj.js";import"./index-i91aZJtO.js";import"./PurePanel-P76UYIOx.js";import"./move-DFJwRNbF.js";import"./LogoutOutlined-D3grUEh9.js";import"./CalendarOutlined-DRNv4K1_.js";import"./UserOutlined-C4AieXI6.js";import"./FileTextOutlined-CLpTPwBT.js";import"./GiftOutlined-BX8SOQIL.js";import"./SettingOutlined-WeUjFcSL.js";import"./index-j5DC1FYe.js";import"./useForm-DsnPK4Jj.js";import"./CheckCircleFilled-Bzti_DAd.js";import"./InfoCircleFilled-BG1v0Kdu.js";import"./index-DaZbv8VD.js";import"./pickAttrs-BYNbLnRC.js";import"./index-DeLtARYN.js";import"./Input-CnuedqSf.js";import"./EyeOutlined-BEq4RqmN.js";import"./EyeOutlined-Bmd706kk.js";import"./index-DRY20BuI.js";import"./addEventListener-B2mgVYNS.js";import"./index-BuHJ7Zwf.js";import"./index-BkYD9Wfd.js";import"./useClosable-C3NTBGzV.js";var ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};function R(){return R=Object.assign?Object.assign.bind():function(u){for(var d=1;d<arguments.length;d++){var a=arguments[d];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(u[o]=a[o])}return u},R.apply(this,arguments)}const me=(u,d)=>i.createElement(Z,R({},u,{ref:d,icon:ue})),fe=i.forwardRef(me);h.extend(W);h.extend(X);const{Title:pe,Text:r}=ee,{Option:p}=F,{Search:he}=re,{RangePicker:ut}=L;function mt({auth:u,refunds:d,analytics:a}){const[o,b]=i.useState(""),[_,C]=i.useState("all"),[y,z]=i.useState(null),[O,g]=i.useState(!1),[V,v]=i.useState(null),[$,w]=i.useState(!1),[n,I]=i.useState(null),Y=s=>{v(s),g(!0)},E=s=>{g(!1),v(null),ce.success("Refund processed successfully"),window.location.reload()},H=()=>{g(!1),v(null)},K=s=>{I(s),w(!0)},D=()=>{w(!1),I(null)},M=s=>{switch(s){case"pending":return"warning";case"processed":return"success";case"failed":return"error";case"not_applicable":return"default";default:return"default"}},k=s=>h(s).tz("Asia/Kolkata").format("MMM DD, YYYY"),S=s=>h(s).tz("Asia/Kolkata").format("MMM DD, YYYY h:mm A"),A=d.filter(s=>{const t=o===""||s.customer.name.toLowerCase().includes(o.toLowerCase())||s.customer.email.toLowerCase().includes(o.toLowerCase())||s.service.name.toLowerCase().includes(o.toLowerCase())||s.refund_transaction_id&&s.refund_transaction_id.toLowerCase().includes(o.toLowerCase()),J=_==="all"||s.refund_status===_,Q=!y||h(s.cancelled_at).tz("Asia/Kolkata").isSame(y,"day");return t&&J&&Q}),N=[{title:"Customer",key:"customer",render:(s,t)=>e.jsxs(f,{direction:"vertical",size:"small",children:[e.jsx(r,{strong:!0,children:t.customer.name}),e.jsx(r,{type:"secondary",style:{fontSize:"12px"},children:t.customer.email}),e.jsx(r,{type:"secondary",style:{fontSize:"12px"},children:t.customer.phone_number})]})},{title:"Service & Booking",key:"service",render:(s,t)=>e.jsxs(f,{direction:"vertical",size:"small",children:[e.jsxs("div",{children:[e.jsx(r,{strong:!0,children:t.service.name}),e.jsx("br",{}),e.jsx(r,{type:"secondary",style:{fontSize:"12px"},children:S(t.appointment_time)})]}),e.jsxs(r,{type:"secondary",style:{fontSize:"12px"},children:["Booking ID: #",t.id]})]})},{title:"Amounts",key:"amounts",render:(s,t)=>e.jsxs(f,{direction:"vertical",size:"small",children:[e.jsx("div",{children:e.jsxs(r,{type:"secondary",style:{fontSize:"12px"},children:["Original: ₹",t.total_amount]})}),t.refund_amount>0&&e.jsx("div",{children:e.jsxs(r,{strong:!0,style:{color:"#52c41a"},children:["Refund: ₹",t.refund_amount]})}),t.cancellation_fee_charged>0&&e.jsx("div",{children:e.jsxs(r,{type:"secondary",style:{fontSize:"12px",color:"#ff4d4f"},children:["Fee: ₹",t.cancellation_fee_charged]})})]})},{title:"Status & Timeline",key:"status",render:(s,t)=>e.jsxs(f,{direction:"vertical",size:"small",children:[e.jsx(T,{status:M(t.refund_status),text:t.refund_status_text||t.refund_status}),e.jsx("div",{children:e.jsxs(r,{type:"secondary",style:{fontSize:"12px"},children:["Cancelled: ",k(t.cancelled_at)]})}),t.refund_processed_at&&e.jsx("div",{children:e.jsxs(r,{type:"secondary",style:{fontSize:"12px"},children:["Processed:"," ",k(t.refund_processed_at)]})})]})},{title:"Actions",key:"actions",render:(s,t)=>e.jsxs(f,{direction:"vertical",size:"small",children:[e.jsx(x,{type:"primary",icon:e.jsx(de,{}),size:"small",onClick:()=>K(t),style:{width:"100%"},children:"View Details"}),t.refund_status==="pending"&&t.payment_status==="paid"&&e.jsx(x,{type:"default",style:{width:"100%",backgroundColor:"#52c41a",color:"white",borderColor:"#52c41a"},size:"small",onClick:()=>Y(t),children:"Process Refund"})]})}];return e.jsxs(G,{auth:u,children:[e.jsx(q,{title:"Refund Management"}),e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(m,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsxs(pe,{level:2,style:{margin:0},children:[e.jsx(P,{style:{marginRight:8}}),"Refund Management"]}),e.jsx(f,{children:e.jsxs(r,{type:"secondary",children:["Total: ",A.length," refunds"]})})]}),e.jsxs(B,{gutter:16,style:{marginBottom:24},children:[e.jsx(c,{span:6,children:e.jsx(m,{size:"small",children:e.jsx(j,{title:"Total Refunds",value:a.total_refunds,prefix:e.jsx(P,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(c,{span:6,children:e.jsx(m,{size:"small",children:e.jsx(j,{title:"Pending Refunds",value:a.pending_refunds,prefix:e.jsx(te,{}),valueStyle:{color:"#faad14"}})})}),e.jsx(c,{span:6,children:e.jsx(m,{size:"small",children:e.jsx(j,{title:"Processed Refunds",value:a.processed_refunds,prefix:e.jsx(se,{}),valueStyle:{color:"#52c41a"}})})}),e.jsx(c,{span:6,children:e.jsx(m,{size:"small",children:e.jsx(j,{title:"Total Refund Amount",value:a.total_refund_amount,prefix:"₹",valueStyle:{color:"#52c41a"}})})})]}),e.jsxs(m,{size:"small",style:{marginBottom:24},children:[e.jsx("div",{style:{marginBottom:8},children:e.jsx(r,{strong:!0,children:"Refund Processing Rate"})}),e.jsx(ne,{percent:a.processing_rate,status:"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}}),e.jsxs(r,{type:"secondary",style:{fontSize:"12px"},children:[a.processed_refunds," of"," ",a.total_refunds," refunds processed"]})]}),e.jsx("div",{style:{marginBottom:16},children:e.jsxs(B,{gutter:16,children:[e.jsx(c,{span:8,children:e.jsx(he,{placeholder:"Search by customer, service, or transaction ID",allowClear:!0,value:o,onChange:s=>b(s.target.value),prefix:e.jsx(le,{})})}),e.jsx(c,{span:4,children:e.jsxs(F,{placeholder:"Status",value:_,onChange:C,style:{width:"100%"},children:[e.jsx(p,{value:"all",children:"All Status"}),e.jsx(p,{value:"pending",children:"Pending"}),e.jsx(p,{value:"processed",children:"Processed"}),e.jsx(p,{value:"failed",children:"Failed"}),e.jsx(p,{value:"not_applicable",children:"Not Applicable"})]})}),e.jsx(c,{span:6,children:e.jsx(L,{placeholder:"Filter by date",value:y,onChange:z,style:{width:"100%"}})}),e.jsx(c,{span:6,children:e.jsx(x,{icon:e.jsx(fe,{}),onClick:()=>{b(""),C("all"),z(null)},children:"Clear Filters"})})]})}),e.jsx(ae,{columns:N,dataSource:A,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(s,t)=>`${t[0]}-${t[1]} of ${s} refunds`}})]}),e.jsx(U,{visible:O,onCancel:H,onSuccess:E,booking:V}),e.jsx(oe,{title:"Refund Details",open:$,onCancel:D,footer:[e.jsx(x,{onClick:D,children:"Close"},"close")],width:800,children:n&&e.jsxs("div",{children:[e.jsxs(l,{title:"Customer Information",bordered:!0,size:"small",children:[e.jsx(l.Item,{label:"Name",span:2,children:n.customer.name}),e.jsx(l.Item,{label:"Email",span:2,children:n.customer.email}),e.jsx(l.Item,{label:"Phone",span:2,children:n.customer.phone_number})]}),e.jsx(ie,{}),e.jsxs(l,{title:"Refund Information",bordered:!0,size:"small",children:[e.jsx(l.Item,{label:"Refund Status",children:e.jsx(T,{status:M(n.refund_status),text:n.refund_status_text||n.refund_status})}),e.jsx(l.Item,{label:"Original Amount",children:e.jsxs(r,{strong:!0,style:{color:"#1890ff"},children:["₹",n.total_amount]})}),n.refund_amount>0&&e.jsx(l.Item,{label:"Refund Amount",children:e.jsxs(r,{strong:!0,style:{color:"#52c41a"},children:["₹",n.refund_amount]})}),n.cancellation_fee_charged>0&&e.jsx(l.Item,{label:"Cancellation Fee",children:e.jsxs(r,{strong:!0,style:{color:"#ff4d4f"},children:["₹",n.cancellation_fee_charged]})}),n.refund_transaction_id&&e.jsx(l.Item,{label:"Transaction ID",children:e.jsx(r,{copyable:!0,children:n.refund_transaction_id})}),n.refund_method&&e.jsx(l.Item,{label:"Refund Method",children:n.refund_method}),n.refund_processed_at&&e.jsx(l.Item,{label:"Processed At",children:S(n.refund_processed_at)}),n.cancelled_at&&e.jsx(l.Item,{label:"Cancelled At",children:S(n.cancelled_at)}),n.refund_notes&&e.jsx(l.Item,{label:"Refund Notes",span:2,children:e.jsx(r,{children:n.refund_notes})}),n.cancellation_reason&&e.jsx(l.Item,{label:"Cancellation Reason",span:2,children:e.jsx(r,{children:n.cancellation_reason})})]})]})})]})]})}export{mt as default};
