import{r as T,j as e,a as k,H as ve}from"./app-D_WwDpKG.js";import{B as _e}from"./BookingHeader-Csyv6hWO.js";import{d as p}from"./dayjs.min-B1yo1AXa.js";import{F as we}from"./index-mg0XOpYU.js";import{s as _}from"./index-Cepcjp4d.js";import{M as Se}from"./index-MHOJXjg-.js";import{C as j,T as ce,B as w,S as G}from"./Logo-DoEVm1Ci.js";import{R as Re}from"./InfoCircleOutlined-DhVB_onP.js";import{R as z,C as h}from"./row-QC14cRcB.js";import{S as ee}from"./index-D234Jsj5.js";import{T as D}from"./index-DlhTNFEG.js";import{A as te}from"./index-QsU-oC4v.js";import{R as Te}from"./CalendarOutlined-DecCsG9F.js";import{R as Be}from"./ClockCircleOutlined-DRi-wOYo.js";import{E as se}from"./index-aFO5B6OM.js";import{R as Ce}from"./CheckOutlined-CLizLTr_.js";import{C as Me}from"./CancelModal-CBC2sdNP.js";import{R as De}from"./ArrowLeftOutlined-DwGuzIvY.js";import{R as Ie,a as Pe}from"./PrinterOutlined-C-GxtHFJ.js";import{D as Ae}from"./index-B8R4es11.js";import{R as re}from"./ExclamationCircleOutlined-DazK6nFt.js";import{R as ne}from"./CloseCircleOutlined-p2Xjf9Q_.js";import{R as ie}from"./CheckCircleOutlined-XUUYHdip.js";/* empty css            */import"./PhoneOutlined-sxpUNhGd.js";import"./index-DBq3_-rU.js";import"./Input-C-WN6v4F.js";import"./EyeOutlined-uIGZ6A-d.js";import"./EyeOutlined-Bmd706kk.js";import"./index-GjD0JYxA.js";import"./useClosable-BWN-VrAh.js";import"./extendsObject-78o_rR5W.js";import"./useForm-CnS16PtQ.js";import"./CheckCircleFilled-C9u4ZZ0R.js";import"./InfoCircleFilled-jSpWLfAl.js";import"./CalendarOutlined-DKq2sctu.js";import"./ClockCircleOutlined-CELcQ7Uv.js";import"./DownloadOutlined-DTidZHln.js";const{Title:le,Text:y}=ce;function Ye({visible:I,onCancel:s,onSuccess:N,booking:r,scheduleSettings:P=[]}){const[A]=we.useForm(),[S,Y]=T.useState(null),[C,R]=T.useState(null),[L,g]=T.useState([]),[W,$]=T.useState(!1),[q,O]=T.useState(!1),[F,c]=T.useState(p()),[l,f]=T.useState(null);console.log("RescheduleModal component - Schedule settings:",{scheduleSettings:P,scheduleSettingsLength:P?.length,firstSchedule:P?.[0]});const M=(r.pricingTier?.duration_minutes||r.service.duration)+(r.extras?r.extras.reduce((t,i)=>{if(i.durationRelation){const a=i.durationRelation.hours*60+i.durationRelation.minutes;return t+a}return t+(i.total_duration||0)},0):0);T.useEffect(()=>{if(I&&r){U();const t=p(r.appointment_time);Y(t),c(t),V(t)}},[I,r]);const U=async()=>{if(r){O(!0);try{const i=await(await fetch(route("customer.bookings.policy",r.id))).json();i.success?f(i.data.policy):console.error("Failed to fetch policy info:",i.message)}catch(t){console.error("Error fetching policy info:",t)}finally{O(!1)}}},V=async t=>{if(!(!t||!r)){$(!0);try{const i=new URLSearchParams({date:t.format("YYYY-MM-DD"),service_id:r.service_id,exclude_booking_id:r.id});r.pricingTier&&(i.append("pricing_tier_id",r.pricingTier.id),i.append("selected_duration",r.pricingTier.duration_minutes),i.append("selected_price",r.pricingTier.price)),r.extras&&r.extras.length>0&&r.extras.forEach(d=>{i.append("extras[]",d.id)}),r.gender_preference&&i.append("gender_preference",r.gender_preference),console.log("Reschedule modal - Request params:",i.toString()),console.log("Reschedule modal - Gender preference:",r.gender_preference),console.log("Reschedule modal - Gender preference being sent:",r.gender_preference||"not set"),console.log("Reschedule modal - Booking data:",{bookingId:r.id,serviceId:r.service_id,pricingTier:r.pricingTier,pricingTierId:r.pricingTier?.id,pricingTierDuration:r.pricingTier?.duration_minutes,serviceDuration:r.service.duration,totalDuration:M,extras:r.extras});const o=await(await fetch(`${route("booking.available-slots")}?${i.toString()}`)).json();if(console.log("Reschedule modal - API response:",o),o.slots){console.log("Reschedule modal - Available slots:",o.slots);const d=p(r.appointment_time),u=o.slots.filter(v=>!p(S).hour(parseInt(v.start.split(":")[0])).minute(parseInt(v.start.split(":")[1])).isSame(d,"minute"));console.log("Reschedule modal - Filtered slots (excluding current):",u),g(u||[])}else g([]),_.error(o.message||o.error||"Failed to fetch available slots")}catch(i){console.error("Error fetching available slots:",i),g([]),_.error("Failed to fetch available slots")}finally{$(!1)}}},oe=t=>{Y(t),R(null),V(t)},de=t=>{R(t)},me=async()=>{if(!S||!C){_.error("Please select both date and time");return}const t=p(S).hour(C.hour()).minute(C.minute()).second(0);$(!0);try{const a=await(await fetch(route("customer.bookings.reschedule",r.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({new_appointment_time:t.format("YYYY-MM-DD HH:mm:ss")})})).json();if(a.success)a.requires_payment?await he(a.data):(_.success("Booking rescheduled successfully!"),N(a.data),A.resetFields(),Y(null),R(null),g([]));else{const o=a.reason||a.message||"Failed to reschedule booking";_.error(o),console.error("Reschedule failed:",{message:a.message,reason:a.reason,details:a.details})}}catch(i){console.error("Error rescheduling booking:",i),_.error("Failed to reschedule booking")}finally{$(!1)}},he=async t=>{try{window.Razorpay||await pe();const i={key:t.key_id,amount:t.amount,currency:t.currency,name:"Booking Reschedule Fee",description:`Reschedule fee for booking #${r.id}`,order_id:t.order_id,handler:async function(o){try{const u=await(await fetch(route("customer.reschedule.payment-success"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({razorpay_payment_id:o.razorpay_payment_id,razorpay_order_id:o.razorpay_order_id,razorpay_signature:o.razorpay_signature})})).json();u.success?(_.success("Booking rescheduled successfully!"),N(u.data),A.resetFields(),Y(null),R(null),g([])):_.error(u.message||"Payment verification failed")}catch(d){console.error("Payment success handling failed:",d),_.error("Failed to verify payment")}},prefill:{name:r.customer?.name||"Customer",email:r.customer?.email||"",contact:r.customer?.phone_number||""},theme:{color:"#1890ff"},modal:{ondismiss:function(){ue()}}};new window.Razorpay(i).open()}catch(i){console.error("Payment setup failed:",i),_.error("Failed to setup payment")}},ue=async()=>{try{await fetch(route("customer.reschedule.payment-failed"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})}catch(t){console.error("Payment cancellation handling failed:",t)}},pe=()=>new Promise((t,i)=>{if(window.Razorpay){t();return}const a=document.createElement("script");a.src="https://checkout.razorpay.com/v1/checkout.js",a.onload=()=>t(),a.onerror=()=>i(new Error("Failed to load Razorpay script")),document.head.appendChild(a)}),K=()=>{A.resetFields(),Y(null),R(null),g([]),s()},fe=t=>{try{if(!t)return"Invalid Time";let i=t;if(t&&typeof t=="object"&&t.format?i=t.format("HH:mm"):typeof t=="object"&&t.start&&(i=t.start),!i||typeof i!="string")return"Invalid Time";const a=i.match(/^(\d{1,2}):(\d{2})$/);if(!a)return"Invalid Time";const o=parseInt(a[1],10),d=parseInt(a[2],10);if(o<0||o>23||d<0||d>59)return"Invalid Time";const u=o>=12?"PM":"AM";return`${o===0?12:o>12?o-12:o}:${d.toString().padStart(2,"0")} ${u}`}catch(i){return console.error("Error formatting time:",i),"Invalid Time"}},xe=()=>{c(F.subtract(1,"month"))},ye=()=>{c(F.add(1,"month"))},je=t=>{const i=p(),a=P?.[0];if(!a)return!1;const o=a.min_advance_hours,d=a.max_advance_days,u=a.working_days,v=i.add(o,"hour"),x=i.add(d,"day"),m=t.isSame(i,"day"),E=m||t.isAfter(v)&&(t.isBefore(x)||t.isSame(x,"day")),B=t.day(),H=B===0?7:B,Z=u.includes(H),b=E&&Z;return(t.isSame(i,"day")||t.format("YYYY-MM-DD")==="2025-08-18")&&console.log("RescheduleModal - Date selectability check:",{date:t.format("YYYY-MM-DD"),isToday:m,isWithinRange:E,isWorkingDay:Z,isSelectable:b,minAdvanceHours:o,maxAdvanceDays:d,workingDays:u,adjustedDayOfWeek:H,minDate:v.format("YYYY-MM-DD"),maxDate:x.format("YYYY-MM-DD"),scheduleSettings:P,defaultSchedule:a}),b},ge=t=>{const i=t.startOf("month"),a=t.endOf("month"),o=i.day(),d=[],u=t.subtract(1,"month"),v=u.daysInMonth();for(let m=o-1;m>=0;m--)d.push(u.date(v-m));for(let m=1;m<=a.date();m++)d.push(t.date(m));const x=42-d.length;for(let m=1;m<=x;m++)d.push(t.add(1,"month").date(m));return d},X=()=>{if(!l?.reschedule||l.reschedule.window_hours===0&&l.reschedule.max_attempts===0||l.reschedule.max_attempts>0&&r.reschedule_attempts>=l.reschedule.max_attempts)return!1;const t=p(),i=p(r.appointment_time);if(i.isBefore(t))return!1;const a=i.diff(t,"hour",!0);return!(l.reschedule.window_hours>0&&a<l.reschedule.window_hours)},J=r?.reschedule_attempts||0,Q=l?.reschedule?.max_attempts||0;return l?.reschedule?.advance_notice_hours,e.jsx(Se,{title:"Reschedule Booking",open:I,onCancel:K,footer:null,width:800,centered:!0,children:e.jsxs("div",{style:{maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs(j,{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:8},children:[e.jsx(Re,{style:{color:"#1890ff",marginRight:8}}),e.jsx(y,{strong:!0,children:"Current Booking"})]}),e.jsxs(z,{gutter:16,children:[e.jsxs(h,{span:8,children:[e.jsx(y,{type:"secondary",children:"Date:"}),e.jsx("br",{}),e.jsx(y,{strong:!0,children:p(r?.appointment_time).format("MMMM D, YYYY")})]}),e.jsxs(h,{span:8,children:[e.jsx(y,{type:"secondary",children:"Time:"}),e.jsx("br",{}),e.jsx(y,{strong:!0,children:p(r?.appointment_time).format("h:mm A")})]}),e.jsxs(h,{span:8,children:[e.jsx(y,{type:"secondary",children:"Service:"}),e.jsx("br",{}),e.jsx(y,{strong:!0,children:r?.service?.name})]})]})]}),q?e.jsxs(j,{style:{marginBottom:16},children:[e.jsx(ee,{size:"small"})," Loading policy information..."]}):l?e.jsx(j,{style:{marginBottom:16},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs(y,{strong:!0,children:["Policy: ",l.name]}),e.jsx("br",{}),e.jsxs(y,{type:"secondary",children:[l.reschedule?.window_hours||0,"h window • Max"," ",l.reschedule?.max_attempts||0," ","attempts"]}),l.reschedule?.fee>0&&e.jsx("div",{style:{marginTop:8},children:e.jsxs(D,{color:"orange",children:["Reschedule Fee: ₹",l.reschedule.fee]})})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(y,{type:"secondary",children:"Attempts:"}),e.jsx("br",{}),e.jsxs(y,{strong:!0,style:{color:"#1890ff"},children:[J,"/",Q]})]})]})}):null,!X()&&l&&e.jsx(te,{message:"Rescheduling Not Allowed",description:e.jsxs("div",{children:[l.reschedule?.window_hours===0&&l.reschedule?.max_attempts===0&&e.jsx("p",{children:"Rescheduling is disabled for this booking."}),l.reschedule?.max_attempts>0&&r?.reschedule_attempts>=l.reschedule?.max_attempts&&e.jsxs("p",{children:["You have already used all your reschedule attempts (",J,"/",Q,")."]}),p(r?.appointment_time).isBefore(p())&&e.jsx("p",{children:"Cannot reschedule appointments in the past."}),l.reschedule?.window_hours>0&&p(r?.appointment_time).diff(p(),"hour",!0)<l.reschedule?.window_hours&&e.jsxs("p",{children:["Your appointment is within the reschedule window (",l.reschedule?.window_hours," ","hours)."]})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),X()&&e.jsxs(e.Fragment,{children:[l?.reschedule?.fee>0&&e.jsx(te,{message:"Reschedule Fee Required",description:`A reschedule fee of ₹${l.reschedule.fee} will be charged to complete the rescheduling process.`,type:"warning",showIcon:!0,style:{marginBottom:16}}),e.jsxs(j,{style:{marginBottom:16},children:[e.jsxs(le,{level:4,style:{marginBottom:16},children:[e.jsx(Te,{style:{marginRight:8}}),"Select New Date"]}),e.jsxs("div",{style:{border:"1px solid #f0f0f0",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.06)",background:"white"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f0f0f0",background:"#fafafa",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(w,{size:"small",onClick:xe,style:{border:"none",boxShadow:"none"},children:"‹"}),e.jsx("span",{style:{fontSize:"16px",fontWeight:"600",minWidth:"120px",textAlign:"center"},children:F.format("MMMM YYYY")}),e.jsx(w,{size:"small",onClick:ye,style:{border:"none",boxShadow:"none"},children:"›"})]}),e.jsxs("div",{style:{padding:"16px"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px",marginBottom:"8px"},children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(t=>e.jsx("div",{style:{textAlign:"center",fontWeight:"600",color:"#666",padding:"8px 4px",fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px"},children:t},t))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px"},children:ge(F).map((t,i)=>{const a=p(),o=t.isBefore(a,"day"),d=t.isSame(a,"day"),u=S&&S.isSame(t,"day"),v=t.month()===F.month(),x=je(t),m={height:"48px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",cursor:x&&!o?"pointer":"default",transition:"all 0.2s ease",fontSize:"14px",fontWeight:"500",opacity:v?1:.3};let E="transparent",B="#333",H="1px solid transparent";return o?B="#999":u?(E="#e6f7ff",B="#1890ff",H="2px solid #1890ff"):d&&!S?(E="#1890ff",B="white",H="none"):x?B="#333":B="#ccc",e.jsx("div",{style:{...m,backgroundColor:E,color:B,border:H},onClick:()=>{x&&!o&&oe(t)},children:t.date()},i)})})]})]})]}),S&&e.jsxs(j,{children:[e.jsxs(le,{level:4,style:{marginBottom:16},children:[e.jsx(Be,{style:{marginRight:8}}),"Available Time Slots",r.gender_preference&&r.gender_preference!=="no_preference"?e.jsxs(y,{type:"secondary",style:{fontSize:14,marginLeft:8},children:["(Filtered for"," ",r.gender_preference==="male"?"Male":"Female"," ","HospiPal)"]}):e.jsx(y,{type:"secondary",style:{fontSize:14,marginLeft:8},children:"(All available HospiPals)"})]}),W?e.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[e.jsx(ee,{size:"large"}),e.jsx("div",{style:{marginTop:16},children:e.jsx(y,{type:"secondary",children:"Loading available slots..."})})]}):L.length===0?e.jsx(se,{description:"No available slots for this date",image:se.PRESENTED_IMAGE_SIMPLE}):e.jsx(z,{gutter:[12,12],children:L.map((t,i)=>{const a=typeof t=="object"?t.start:t;if(!a||typeof a!="string")return null;const o=a.split(":");if(o.length!==2)return null;const d=parseInt(o[0],10),u=parseInt(o[1],10);if(d<0||d>23||u<0||u>59)return null;const v=p().hour(d).minute(u).second(0).millisecond(0),x=C&&C.format("HH:mm")===a,m=typeof t=="object"?t.available!==!1:!0;return e.jsx(h,{xs:12,sm:8,md:6,children:e.jsx(w,{size:"large",disabled:!m,style:{width:"100%",height:48,border:x?"2px solid #1890ff":m?"1px solid #d9d9d9":"1px solid #ffccc7",backgroundColor:x?"#e6f7ff":m?"white":"#fff2f0",opacity:m?1:.6},onClick:()=>m&&de(v),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[x&&e.jsx(Ce,{style:{marginRight:8,color:"#1890ff"}}),fe(a)]}),!m&&e.jsx("div",{style:{fontSize:"10px",marginTop:"2px",color:"#ff4d4f",fontWeight:"normal"},children:"Unavailable"})]})})},i)}).filter(Boolean)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:16},children:[e.jsx(w,{onClick:K,children:"Cancel"}),e.jsx(w,{type:"primary",onClick:me,loading:W,disabled:!S||!C,children:l?.reschedule?.fee>0?`Reschedule & Pay ₹${l.reschedule.fee}`:"Reschedule Booking"})]})]})]})})}const{Title:ae,Text:n,Paragraph:Fe}=ce;function gt({auth:I,booking:s}){const[N,r]=T.useState(!1),[P,A]=T.useState(!1);if(!I||!I.user)return e.jsxs("div",{style:{padding:"24px",textAlign:"center"},children:[e.jsx(ae,{level:2,children:"Access Denied"}),e.jsx(n,{children:"Please log in to view booking details."}),e.jsx("br",{}),e.jsx(w,{type:"primary",onClick:()=>k.visit(route("welcome")),style:{marginTop:16},children:"Go to Home"})]});const S=c=>{switch(c){case"confirmed":return"success";case"pending":return"warning";case"completed":return"processing";case"cancelled":return"error";case"no_show":return"default";default:return"default"}},Y=c=>{switch(c){case"confirmed":return e.jsx(ie,{});case"pending":return e.jsx(re,{});case"completed":return e.jsx(ie,{});case"cancelled":return e.jsx(ne,{});case"no_show":return e.jsx(ne,{});default:return e.jsx(re,{})}},C=c=>{switch(c){case"paid":return"success";case"pending":return"warning";case"failed":return"error";case"refunded":return"default";default:return"default"}},R=c=>p(c).format("MMM DD, YYYY h:mm A"),L=c=>{if(c<60)return`${c} min`;{const l=Math.floor(c/60),f=c%60;return f>0?`${l}h ${f}m`:`${l}h`}},g=c=>`₹${parseFloat(c).toFixed(2)}`,W=c=>{r(!1),window.location.reload()},$=()=>{r(!1)},q=c=>{A(!1),_.success("Booking cancelled successfully"),window.location.reload()},O=()=>{A(!1)},F=()=>{window.print()};return e.jsxs("div",{children:[e.jsx(ve,{title:`Booking #${s.id} - HospiPal`}),e.jsx(_e,{auth:I}),e.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:"24px"},children:[e.jsx("div",{className:"mobile-top-spacing"}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(w,{icon:e.jsx(De,{}),onClick:()=>k.visit(route("customer.bookings")),style:{marginBottom:16},children:"Back to Bookings"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16},children:[e.jsxs("div",{children:[e.jsxs(ae,{level:2,style:{marginBottom:8},children:["Booking #",s.id]}),e.jsxs(n,{type:"secondary",children:[s.service?.name,s?.pricingTier&&e.jsx(D,{color:"blue",style:{marginLeft:8,fontSize:10},children:s.pricingTier.name})]})]}),e.jsx(G,{children:e.jsx(w,{icon:e.jsx(Ie,{}),onClick:F,children:e.jsx("span",{className:"hidden-xs",children:"Print"})})})]})]}),e.jsxs(z,{gutter:[24,24],children:[e.jsxs(h,{xs:24,lg:16,children:[e.jsx(j,{title:"Booking Details",style:{marginBottom:24},children:e.jsxs(z,{gutter:[16,16],children:[e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Service"}),e.jsx("div",{children:e.jsxs(n,{children:[s.service?.name,s?.pricingTier&&e.jsx(D,{color:"blue",style:{marginLeft:8,fontSize:10},children:s.pricingTier.name})]})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Employee"}),e.jsx("div",{children:e.jsx(n,{children:s.employee?.name||"Auto-assigned"})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Date & Time"}),e.jsx("div",{children:e.jsx(n,{children:R(s.appointment_time)})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Duration"}),e.jsx("div",{children:e.jsx(n,{children:L(s.duration)})})]})}),s.gender_preference&&s.gender_preference!=="no_preference"&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"HospiPal Preference"}),e.jsx("div",{children:e.jsxs(G,{children:[e.jsxs(n,{children:[s.gender_preference==="male"?"Male":"Female"," ","HospiPal"]}),s.gender_preference_fee>0&&e.jsxs(D,{color:"blue",children:["+₹",s.gender_preference_fee]})]})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Status"}),e.jsx("div",{children:e.jsx(D,{color:S(s.status),icon:Y(s.status),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Payment Status"}),e.jsx("div",{children:e.jsx(D,{color:C(s.payment_status),children:s.payment_status.charAt(0).toUpperCase()+s.payment_status.slice(1)})})]})}),e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Reschedule Attempts"}),e.jsx("div",{children:e.jsxs(n,{children:[s.reschedule_attempts||0," ","attempts"]})})]})}),s.rescheduled_at&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Last Rescheduled"}),e.jsx("div",{children:e.jsx(n,{children:R(s.rescheduled_at)})})]})})]})}),s.extras&&s.extras.length>0&&e.jsx(j,{title:"Additional Services",style:{marginBottom:24},children:e.jsx(z,{gutter:[16,16],children:s.extras.map(c=>{const l=c.pivot?.quantity||1,f=parseFloat(c.pivot?.price||c.price)*l,M=c.duration_relation?(c.duration_relation.hours*60+c.duration_relation.minutes)*l:(c.total_duration||0)*l;return e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",border:"1px solid #f0f0f0",borderRadius:"8px"},children:[e.jsxs("div",{children:[e.jsxs(n,{strong:!0,children:[c.name,l>1&&e.jsxs(n,{type:"secondary",style:{fontSize:12,marginLeft:8},children:["× ",l]})]}),e.jsx("br",{}),e.jsx(n,{type:"secondary",style:{fontSize:"12px"},children:L(M)})]}),e.jsx(n,{children:g(f)})]})},c.id)})})}),(()=>{const c=s.form_responses;if(c&&c.length>0){const l=c.filter(f=>f.form_field&&!f.form_field.is_primary);return l.length>0?e.jsx(j,{title:"Additional Information",style:{marginBottom:24},children:e.jsx(z,{gutter:[16,16],children:l.map(f=>{const M=f.form_field,U=f.formatted_value||f.response_value;return e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs(n,{strong:!0,children:[M?.label||M?.name||"Unknown Field",":"]}),e.jsx("div",{children:e.jsx(n,{children:U||"Not provided"})})]})},f.id)})})}):e.jsx(j,{title:"Additional Information",style:{marginBottom:24},children:e.jsx(n,{type:"secondary",children:"No additional information found."})})}else return e.jsx(j,{title:"Additional Information",style:{marginBottom:24},children:e.jsx(n,{type:"secondary",children:"No form responses found."})})})(),s.notes&&e.jsx(j,{title:"Notes",style:{marginBottom:24},children:e.jsx(Fe,{children:s.notes})}),(s.reschedule_attempts>0||s.reschedule_payment_amount>0)&&e.jsx(j,{title:"Reschedule Information",style:{marginBottom:24},children:e.jsxs(z,{gutter:[16,16],children:[s.reschedule_attempts>0&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Reschedule Attempts"}),e.jsx("div",{children:e.jsxs(n,{children:[s.reschedule_attempts," ","time(s)"]})})]})}),s.rescheduled_at&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Last Rescheduled"}),e.jsx("div",{children:e.jsx(n,{children:R(s.rescheduled_at)})})]})}),s.reschedule_payment_amount>0&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Reschedule Fee Paid"}),e.jsx("div",{children:e.jsxs(n,{style:{color:"#52c41a",fontWeight:"bold"},children:["₹",s.reschedule_payment_amount]})})]})}),s.reschedule_payment_id&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Payment ID"}),e.jsx("div",{children:e.jsx(n,{code:!0,children:s.reschedule_payment_id})})]})}),s.reschedule_payment_date&&e.jsx(h,{xs:24,sm:12,children:e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{strong:!0,children:"Payment Date"}),e.jsx("div",{children:e.jsx(n,{children:R(s.reschedule_payment_date)})})]})})]})})]}),e.jsxs(h,{xs:24,lg:8,children:[e.jsxs(j,{title:"Payment Details",style:{marginBottom:24},children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsxs(n,{children:["Service",s?.pricingTier&&e.jsx(D,{color:"blue",style:{marginLeft:8,fontSize:10},children:s.pricingTier.name})]}),e.jsx(n,{children:g(parseFloat(s?.pricingTier?.price)||parseFloat(s.service?.price)||0)})]}),s.extras&&s.extras.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx(n,{children:"Extras"}),e.jsx(n,{children:g(s.extras.reduce((c,l)=>{const f=l.pivot?.quantity||1,M=parseFloat(l.pivot?.price||l.price||0);return c+M*f},0))})]}),s.distance_charges>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,color:"#1890ff"},children:[e.jsxs(n,{children:["Extra Distance Charges",e.jsx(D,{color:"blue",style:{marginLeft:8,fontSize:10},children:"Travel Buddy"})]}),e.jsx(n,{children:g(s.distance_charges)})]}),s.discount_amount>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,color:"#52c41a"},children:[e.jsx(n,{children:"Discount"}),e.jsxs(n,{children:["-",g(s.discount_amount)]})]}),e.jsx(Ae,{style:{margin:"12px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"16px",fontWeight:"bold"},children:[e.jsx(n,{strong:!0,children:"Total"}),e.jsx(n,{strong:!0,children:g(s.total_amount)})]})]}),s.payment_method&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{type:"secondary",children:"Payment Method"}),e.jsx("div",{children:e.jsx(n,{children:s.payment_method})})]}),s.transaction_id&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(n,{type:"secondary",children:"Transaction ID"}),e.jsx("div",{children:e.jsx(n,{code:!0,children:s.transaction_id})})]})]}),e.jsx(j,{title:"Actions",children:e.jsxs(G,{direction:"vertical",style:{width:"100%"},children:[(s.status==="pending"||s.status==="confirmed")&&e.jsx(w,{type:"primary",block:!0,danger:!0,onClick:()=>A(!0),children:"Cancel Booking"}),s.status==="confirmed"&&e.jsx(w,{type:"primary",block:!0,onClick:()=>r(!0),children:"Reschedule"}),s.invoice&&e.jsx(w,{icon:e.jsx(Pe,{}),block:!0,onClick:()=>window.open(`/customer/invoices/${s.invoice.id}/download`,"_blank"),children:"Download Invoice"}),e.jsx(w,{block:!0,onClick:()=>_.info("Contact support functionality coming soon"),children:"Contact Support"})]})})]})]}),e.jsx(Ye,{visible:N,onCancel:$,onSuccess:W,booking:s,scheduleSettings:s.schedule_settings||[]}),e.jsx(Me,{visible:P,onCancel:O,onSuccess:q,booking:s})]})]})}export{gt as default};
