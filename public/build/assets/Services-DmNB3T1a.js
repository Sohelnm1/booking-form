import{r as m,j as e,H,a as g}from"./app-CTnpJe6s.js";import{A as Y,R as _}from"./AdminLayout-CQY0PddB.js";import{F as c}from"./index-D_7Mj0Ta.js";import{T as N,B as h,C as J}from"./Logo-Biljuc-Y.js";import{F as K}from"./Table-BXyrPl2e.js";import{M as R}from"./index-D4ViXHP2.js";import{R as I,C as u}from"./row-DcqefiXp.js";import{I as D}from"./index-DMq3Xvyi.js";import{S as F}from"./index-ChBeB8qW.js";import{T as x}from"./index-AXm3g50X.js";import{T as W}from"./index-OGHt-QKK.js";import{U as X,R as Z}from"./InboxOutlined-BySeprjo.js";import{S as ee}from"./index-Cypur1WL.js";import{I as te}from"./index-DR0qZzNj.js";import{S as se}from"./CalendarOutlined-BM3-G7F1.js";import{R as ie}from"./EyeOutlined-C-ZMfjeD.js";import{R as oe}from"./EditOutlined-Bx_mX-hc.js";import{R as re}from"./DeleteOutlined-gv3QWYhn.js";import{s as d}from"./index-CtW8XKZp.js";/* empty css            */import"./index-Ca_16It4.js";import"./PurePanel-DoOMq_kn.js";import"./move-M8L2ISRZ.js";import"./LogoutOutlined-DMJJUOr0.js";import"./UserOutlined-D2rDMwbZ.js";import"./ClockCircleOutlined-CGmtAK_w.js";import"./FileTextOutlined-B0sPJ-VI.js";import"./GiftOutlined-BtTa7HJg.js";import"./SettingOutlined-099kgk59.js";import"./useForm-66eOu3XW.js";import"./CheckCircleFilled-D9BfS9XO.js";import"./InfoCircleFilled-Da70DYLE.js";import"./pickAttrs-BUARLshW.js";import"./addEventListener-Bw6NzHsG.js";import"./index-DfOgfXYp.js";import"./index-4iFzE4R6.js";import"./index-NkXij_5v.js";import"./useClosable-C0XzdfFj.js";import"./index-B4prJx6-.js";import"./Input-DfhxBwA6.js";import"./EyeOutlined-BLbdxot3.js";import"./DownloadOutlined-DTidZHln.js";import"./progress-HW_oSjcH.js";const{Title:le,Text:A}=N,{TextArea:ae}=D,{Option:B}=F;function We({auth:M,services:Q,categories:P,durations:k,errors:f,editService:j}){const[v,p]=m.useState(!1),[l,E]=m.useState(null),[r]=c.useForm(),[O,y]=m.useState(!1),[w,S]=m.useState(null),b=Q||[],U=P||[],C=k||[];m.useEffect(()=>{f&&Object.keys(f).length>0&&(Object.keys(f).forEach(t=>{r.setFields([{name:t,errors:[f[t]]}])}),p(!0))},[f,r]),m.useEffect(()=>{if(v)if(l){const t={name:l.name,description:l.description||"",price:parseFloat(l.price)||0,duration:parseInt(l.duration)||60,category:l.category||"Default",color:l.color||"#1890ff",is_active:l.is_active!==void 0?l.is_active:!0};setTimeout(()=>{r.setFieldsValue(t),console.log("Form values set via useEffect for editing:",t)},100)}else setTimeout(()=>{r.setFieldsValue({is_active:!0,color:"#1890ff",category:"Default",duration:60,description:""}),console.log("Default form values set via useEffect for adding")},100)},[v,l,r]),m.useEffect(()=>{if(j){const t=b.find(i=>i.id==j);t&&T(t)}},[j,b]);const V=[{title:"Image",dataIndex:"image",key:"image",render:(t,i)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(te,{width:40,height:40,src:t||`https://placehold.co/40x40/${i.color?.replace("#","")||"1890ff"}/ffffff?text=${i.name?.charAt(0)?.toUpperCase()||"S"}`,alt:i.name,style:{borderRadius:4},fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3Ik1RnG4W+FgYxN"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:i.name}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.category})]})]})},{title:"Category",dataIndex:"category",key:"category",render:t=>e.jsx(x,{color:"blue",children:t})},{title:"Price",dataIndex:"price",key:"price",render:t=>`â‚¹${t}`},{title:"Duration",dataIndex:"duration",key:"duration",render:t=>{const i=C.find(o=>o.value===t);return i?i.label:`${t} min`}},{title:"Employees",dataIndex:"employees",key:"employees",render:()=>e.jsx("div",{style:{opacity:.5},children:e.jsx(x,{color:"orange",size:"small",children:"Coming Soon"})})},{title:"Status",dataIndex:"is_active",key:"is_active",render:t=>e.jsx(x,{color:t?"green":"red",children:t?"Active":"Inactive"})},{title:"Actions",key:"actions",render:(t,i)=>e.jsxs(se,{children:[e.jsx(h,{type:"text",icon:e.jsx(ie,{}),size:"small",onClick:()=>q(i)}),e.jsx(h,{type:"text",icon:e.jsx(oe,{}),size:"small",onClick:()=>T(i)}),e.jsx(h,{type:"text",icon:e.jsx(re,{}),size:"small",danger:!0,loading:w===i.id,disabled:w===i.id,onClick:()=>z(i)})]})}],L=()=>{E(null),r.resetFields(),r.setFields([]),p(!0)},T=t=>{E(t),r.setFields([]),r.resetFields(),console.log("Service data for editing:",t),p(!0)},q=t=>{g.visit(route("admin.services.show",t.id))},z=t=>{R.confirm({title:"Delete Service",content:e.jsxs("div",{children:[e.jsxs("p",{children:["Are you sure you want to delete"," ",e.jsxs("strong",{children:['"',t.name,'"']}),"?"]}),e.jsxs("p",{style:{color:"#ff4d4f",fontSize:"14px",marginTop:8},children:[e.jsx("strong",{children:"Warning:"})," This action cannot be undone and will permanently remove:"]}),e.jsxs("ul",{style:{color:"#666",fontSize:"14px",marginTop:4},children:[e.jsx("li",{children:"The service and all its data"}),e.jsx("li",{children:"Any associated bookings (if they exist)"}),e.jsx("li",{children:"Service images and files"})]})]}),okText:"Delete Service",okType:"danger",cancelText:"Cancel",width:500,onOk(){S(t.id),d.loading({content:"Deleting service...",key:"deleteService"}),console.log("Attempting to delete service:",t.id),console.log("Delete route:",route("admin.services.delete",t.id)),g.post(route("admin.services.delete",t.id),{onSuccess:()=>{console.log("Service deleted successfully"),d.success({content:`Service "${t.name}" deleted successfully`,key:"deleteService",duration:3}),S(null),g.visit(route("admin.services"),{replace:!0,preserveScroll:!1})},onError:i=>{console.error("Delete service errors:",i),d.error({content:"Failed to delete service. Please try again.",key:"deleteService",duration:5}),S(null)},onFinish:()=>{console.log("Delete request finished")}})}})},$=()=>{const t=r.getFieldsValue();console.log("Current form values before validation:",t);const i=r.getFieldValue("description");console.log("Description field value:",i),r.validateFields().then(o=>{y(!0),console.log("Form validation passed, values:",o);const n=new FormData;console.log("Form values:",o),Object.keys(o).forEach(s=>{if(console.log(`Processing field ${s}:`,o[s]),s!=="employees")if(s==="image"&&o[s]?.fileList?.[0]?.originFileObj)n.append("image",o[s].fileList[0].originFileObj);else if(s==="color")n.append("color",o[s]||"#1890ff");else if(s==="price"){const a=parseFloat(o[s])||0;n.append(s,a),console.log("Price value:",a)}else if(s==="duration"){const a=parseInt(o[s])||0;n.append(s,a),console.log("Duration value:",a)}else s==="is_active"?(n.append(s,o[s]?"1":"0"),console.log("is_active value:",o[s]?"1":"0")):s==="description"?(n.append(s,o[s]||""),console.log("Description value:",o[s]||"")):(n.append(s,o[s]||""),console.log(`${s} value:`,o[s]||""))}),console.log("=== FormData being sent to backend ===");for(let[s,a]of n.entries())console.log(`${s}:`,a);console.log("=== End FormData ==="),l?(n.append("_method","PUT"),g.post(route("admin.services.update",l.id),n,{onSuccess:()=>{d.success("Service updated successfully"),p(!1),r.resetFields()},onError:s=>{console.error("Update service errors:",s),s&&Object.keys(s).forEach(a=>{r.setFields([{name:a,errors:[s[a]]}])}),d.error("Failed to update service")},onFinish:()=>{y(!1)}})):g.post(route("admin.services.store"),n,{onSuccess:()=>{d.success("Service created successfully"),p(!1),r.resetFields()},onError:s=>{console.error("Create service errors:",s),s&&Object.keys(s).forEach(a=>{r.setFields([{name:a,errors:[s[a]]}])}),d.error("Failed to create service")},onFinish:()=>{y(!1)}})}).catch(o=>{console.error("Form validation failed:",o),d.error("Please check the form and try again")})},G=()=>{p(!1),r.resetFields()};return e.jsxs(Y,{auth:M,children:[e.jsx(H,{title:"Services Management"}),e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx(le,{level:2,style:{marginBottom:8},children:"Services"}),e.jsx(A,{type:"secondary",children:"Create and manage your services for customer bookings"})]}),e.jsx(h,{type:"primary",icon:e.jsx(_,{}),size:"large",onClick:L,children:"Create Service"})]}),e.jsx(J,{children:e.jsx(K,{columns:V,dataSource:b,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,i)=>`${i[0]}-${i[1]} of ${t} services`}})}),e.jsx(R,{title:l?"Edit Service":"Create Service",open:v,onOk:$,onCancel:G,width:800,okText:l?"Update":"Add Service",confirmLoading:O,children:e.jsxs(c,{form:r,layout:"vertical",children:[e.jsxs(I,{gutter:16,children:[e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"name",label:"Service name*",rules:[{required:!0,message:"Please enter service name",whitespace:!0}],children:e.jsx(D,{placeholder:"Enter name"})})}),e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"color",label:"Color",children:e.jsx(D,{type:"color",style:{width:"100%",height:"40px"}})})})]}),e.jsxs(I,{gutter:16,children:[e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"category",label:"Category*",rules:[{required:!0,message:"Please select category"}],children:e.jsx(F,{placeholder:"Select category",children:U.map((t,i)=>e.jsx(B,{value:t,children:t},i))})})}),e.jsx(u,{span:12,children:e.jsx(c.Item,{label:"Employees",children:e.jsx("div",{style:{padding:"8px 12px",border:"1px solid #d9d9d9",borderRadius:"6px",backgroundColor:"#f5f5f5",color:"#999",cursor:"not-allowed"},children:e.jsxs(A,{type:"secondary",children:[e.jsx(x,{color:"orange",children:"Coming Soon"})," ","Employee assignment will be available soon"]})})})})]}),e.jsx(c.Item,{name:"description",label:"Description",children:e.jsx(ae,{rows:4,placeholder:"Insert text here ...",style:{minHeight:100}})}),e.jsx(A,{type:"secondary",style:{fontSize:"12px",marginTop:4,marginBottom:16},children:"Descriptions appear on your booking page."}),e.jsxs(I,{gutter:16,children:[e.jsxs(u,{span:12,children:[e.jsx(c.Item,{name:"duration",label:"Duration*",rules:[{required:!0,message:"Please select duration"}],children:e.jsx(F,{placeholder:"Select duration",children:C.map(t=>e.jsx(B,{value:t.value,children:t.label},t.value))})}),e.jsxs(A,{type:"secondary",style:{fontSize:"12px",marginTop:4},children:["If you need a different duration that isn't among the displayed ones, please visit our"," ",e.jsx("a",{href:"#",style:{color:"#1890ff"},children:"General Settings"})," ","and change Default Time Slot Step."]})]}),e.jsx(u,{span:12,children:e.jsx(c.Item,{name:"price",label:"Price*",rules:[{required:!0,message:"Please enter price"},{type:"number",min:0,message:"Price must be a positive number"}],children:e.jsx(W,{style:{width:"100%"},placeholder:"0.00",min:0,step:.01,formatter:t=>`â‚¹ ${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/â‚¹\s?|(,*)/g,"")})})})]}),e.jsx(c.Item,{name:"image",label:"Service image",children:e.jsxs(X.Dragger,{name:"file",multiple:!1,beforeUpload:()=>!1,showUploadList:!0,accept:"image/*",maxCount:1,fileList:[],children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(Z,{})}),e.jsx("p",{className:"ant-upload-text",children:"Drag and drop or choose from files"})]})}),e.jsx(c.Item,{name:"is_active",label:"Active",valuePropName:"checked",children:e.jsx(ee,{})})]})})]})]})}export{We as default};
